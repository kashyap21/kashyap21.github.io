if (self.CavalryLogger) { CavalryLogger.start_js(["yMgn4"]); }

__d("PhotoTags",["csx","Arbiter","CSS","DOM","Event","Parent","PhotosConst","ge"],(function(a,b,c,d,e,f,g){__p&&__p();function a(a,c,d){"use strict";this.tagTargets=a,this.tagBox=c,this.version=d||b("PhotosConst").VIEWER_PERMALINK,this.handlers=[],this.tagTargets.forEach(function(a){this.handlers.push(b("Event").listen(a,{mouseover:this.showTag.bind(this),mouseout:this.hideTags.bind(this)}))}.bind(this)),this.subscriptions=[],this.version==b("PhotosConst").VIEWER_SNOWLIFT&&this.subscriptions.push(b("Arbiter").subscribe("PhotoSnowlift.PAGE",this.hideTags.bind(this)))}a.prototype.showTag=function(event){"use strict";__p&&__p();var a=event.getTarget(),c=b("CSS").hasClass(a,"taggee"),d=b("CSS").matchesSelector(a,"._54ru"),e=null,f=null;if(c)e=a.getAttribute("data-tag"),f=a.getAttribute("data-tagtype");else if(d){c=b("Parent").byTag(a,"a");e=c&&c.getAttribute("data-tag")}e||(a=b("Parent").byClass(a,"taggee"),a&&(e=a.getAttribute("data-tag"),f=a.getAttribute("data-tagtype")));d=this.version==b("PhotosConst").VIEWER_PERMALINK?"perm:tag:"+e:"tag:"+e;c=d&&b("ge")(d);c&&(f==="product"?b("CSS").addClass(c,"hover"):b("CSS").addClass(c,"showTag"),b("CSS").addClass(this.tagBox,"showingTag"),b("Arbiter").inform("PhotoTags.SHOWTAG",e))};a.prototype.hideTags=function(){"use strict";b("CSS").removeClass(this.tagBox,"showingTag"),b("DOM").scry(this.tagBox,"div.showTag").forEach(function(a){b("CSS").removeClass(a,"showTag")}),b("DOM").scry(this.tagBox,"div.hover").forEach(function(a){b("CSS").removeClass(a,"hover")}),b("Arbiter").inform("PhotoTags.HIDETAG")};a.prototype.destroy=function(){"use strict";for(var a in this.handlers)this.handlers[a].remove();this.subscriptions.forEach(b("Arbiter").unsubscribe,b("Arbiter"))};e.exports=a}),null);