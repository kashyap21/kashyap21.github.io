if (self.CavalryLogger) { CavalryLogger.start_js(["CDUeY"]); }

__d("PagesPrivateReplyConstants",[],(function(a,b,c,d,e,f){e.exports={Status:{REPLYABLE:"replyable",ALREADY_REPLIED:"already_replied",RECIPIENT_FILTER:"recipient_filter",EXPIRED:"expired",NOT_USER_CREATED:"not_user_created",CANNOT_MESSAGE:"cannot_message",MESSAGING_DISABLED:"messaging_disabled"},Type:{COMMENT_PAGE_POST:"comment_page_post",COMMENT_WALL_POST:"comment_wall_post",COMMENT_REVIEW:"comment_review",REVIEW:"review",WALL_POST:"wall_post"}}}),null);
__d("BusinessActorUtils.brands",["UnicodeCJK"],(function(a,b,c,d,e,f){"use strict";a={getInitials:function(a,c){a=a.trim().charAt(0);c=c.trim().charAt(0);a=a+c;return b("UnicodeCJK").hasIdeograph(a)?c:a.toUpperCase()}};e.exports=a}),null);
__d("ConstituentBadgeEventEmitter",["EventEmitter"],(function(a,b,c,d,e,f){e.exports=new(b("EventEmitter"))()}),null);
__d("AuthorPinnedCommentLogger",["AuthorPinnedCommentEvent","AuthorPinnedCommentsTypedLogger"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a.prototype.logPinningCommentAttempt=function(a){this.$1(a,b("AuthorPinnedCommentEvent").PINNING_ATTEMPT)};a.prototype.logUnpinningCommentAttempt=function(a){this.$1(a,b("AuthorPinnedCommentEvent").UNPINNING_ATTEMPT)};a.prototype.logReplacingPinnedCommentAttempt=function(a){this.$1(a,b("AuthorPinnedCommentEvent").REPLACING_ATTEMPT)};a.prototype.logNuxDisplayed=function(a){this.$1(a,b("AuthorPinnedCommentEvent").NUX_DISPLAYED)};a.prototype.logNuxDismissed=function(a){this.$1(a,b("AuthorPinnedCommentEvent").NUX_DISMISSED)};a.prototype.logPinButtonShown=function(a){this.$1(a,b("AuthorPinnedCommentEvent").PIN_BUTTON_SHOWN)};a.prototype.logUnpinButtonShown=function(a){this.$1(a,b("AuthorPinnedCommentEvent").UNPIN_BUTTON_SHOWN)};a.prototype.$1=function(a,event){new(b("AuthorPinnedCommentsTypedLogger"))().setCommentID(a).setEvent(event).log()};function a(){}e.exports=new a()}),null);
__d("UFIAsyncWrapper",["React","UFIConfig"],(function(a,b,c,d,e,f){"use strict";__p&&__p();b("UFIConfig").reactFiberAsyncUFI?a=b("React").unstable_AsyncMode:a=function(){__p&&__p();var a;a=babelHelpers.inherits(c,b("React").Component);a&&a.prototype;c.prototype.render=function(){"use strict";return this.props.children};function c(){"use strict";a.apply(this,arguments)}return c}();e.exports=a}),null);
__d("UFICommentVPVs",["MarauderLogger"],(function(a,b,c,d,e,f){"use strict";var g=new Map();function a(a,c){b("MarauderLogger").log("comment_vpv",undefined,null,"comment",c),g.has(a)||g.set(a,new Set()),g.get(a).add(c)}function c(a,b){return g.has(a)?g.get(a).has(b):!1}d={logVPV:a,hasLoggedVPV:c};e.exports=d}),null);
__d("UFIDispatcher",["ReactDispatcher_DEPRECATED","UFISharedDispatcher"],(function(a,b,c,d,e,f){"use strict";var g,h;g=babelHelpers.inherits(a,b("ReactDispatcher_DEPRECATED"));h=g&&g.prototype;a.prototype.dispatch=function(a){h.dispatch.call(this,a),b("UFISharedDispatcher").dispatch(a)};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("UFIAddCommentAction",["CommentPrivacyValue","UFIAddCommentActionType","requireWeak"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g={logPost:function(a,b){return undefined}};b("requireWeak")("PrivateCommentsLogger",function(a){g=a});a={cancel:function(a){return{type:b("UFIAddCommentActionType").CANCEL,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier}},changeContent:function(a,c,d){return{type:b("UFIAddCommentActionType").CHANGE_CONTENT,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,text:c,replyFBID:d}},retrySubmit:function(a,c){return{type:b("UFIAddCommentActionType").RETRY_SUBMIT,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,comment:c}},submitEdit:function(a,c,d,e){return{type:b("UFIAddCommentActionType").SUBMIT_EDIT,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,comment:c,commentData:d,target:e}},submitNew:function(a,c,d,e){g.logPost(c.privacy_value===b("CommentPrivacyValue").OWNER_OR_COMMENTER,a.ftentidentifier);return{type:b("UFIAddCommentActionType").SUBMIT_NEW,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,comment:c,target:d,replyCommentID:e,timestamp:Date.now()}}};e.exports=a}),null);
__d("UFIInstanceAction",["UFIInstanceActionType"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={changeOrderingMode:function(a,c){return{type:b("UFIInstanceActionType").CHANGE_ORDER_MODE,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,mode:c}},toggleComments:function(a){return{type:b("UFIInstanceActionType").TOGGLE_COMMENTS,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier}},changeCommentListVisibility:function(a,c){return{type:b("UFIInstanceActionType").CHANGE_VISIBILITY,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,visibility:c}},init:function(a,c){return{type:b("UFIInstanceActionType").INIT,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,payload:c}},didRequestVODComments:function(a){return{type:b("UFIInstanceActionType").REQUESTED_VOD_COMMENTS,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier}},didReceiveVODComments:function(a){return{type:b("UFIInstanceActionType").RECEIVED_VOD_COMMENTS,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier}},remove:function(a){return{type:b("UFIInstanceActionType").REMOVE,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier}},toggleCommercialBreak:function(a,c){return{type:b("UFIInstanceActionType").TOGGLE_COMMERCIAL_BREAK,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,inCommercial:c}},translateAll:function(a){return{type:b("UFIInstanceActionType").TRANSLATE_ALL,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier}},playLiveVODHighlights:function(a,c){return{type:b("UFIInstanceActionType").PLAY_LIVE_VOD_HIGHLIGHTS,instanceID:a.instanceid,ftentidentifier:a.ftentidentifier,playingLiveVODHighlights:c}},foundVideoPlayerController:function(a,b){return{ftentidentifier:a.ftentidentifier,instanceID:a.instanceid,videoPlayerController:b,type:"found_video_player_controller"}}};e.exports=a}),null);
__d("UFINewCommentNotifier",["Arbiter","UFIFeedbackTargets","UFIUIEvents","UFIUserActions"],(function(a,b,c,d,e,f){"use strict";a={onNewComment:function(a,c,d,e,f,g){b("UFIUserActions").addComment(c.ftentidentifier,d.visibleValue,d.encodedValue,{source:c.source,ufiinstanceid:c.instanceid,target:e,replyid:f,rootid:c.rootid,attachedphoto:d.attachedPhoto,attachedvideo:d.attachedVideo,attachedfile:d.attachedFile,attachedsticker:d.attachedSticker,feedcontext:c.feedcontext,timestamp:g,feedbackReferrer:c.feedbackReferrer,isMarkdown:d.isMarkdown,fluentContentToken:c.fluentContentToken,isLiveVOD:c.isLiveVOD,islivestreaming:c.islivestreaming,liveVideoQuickCommentQuality:d.liveVideoQuickCommentQuality,photoTextTagID:c.photoTextTagID,isPhotoTag:c.isPhotoTag,photoFBID:c.photoFBID,photoTagX:c.photoTagX,photoTagY:c.photoTagY,privacyValue:d.privacy_value,section:d.section,attachedshareurl:d.attachedShareURL,isBroadcasterUFI:c.isBroadcasterUFI,enableVODCommentTimestamps:c.enableVODCommentTimestamps,trackingID:d.trackingID,delightRanges:d.delightRanges}),b("UFIFeedbackTargets").getFeedbackTarget(c.ftentidentifier,function(f){a&&b("Arbiter").inform(b("UFIUIEvents").Comment,{ft_id:f.entidentifier,target:e,form:a,isinverted:f.isranked||c.islivestreaming||c.isLivingRoom,isPhotoTag:c.isPhotoTag,photoTextTagID:c.photoTextTagID,photoTagX:c.photoTagX,photoTagY:c.photoTagY,commentString:d.visibleValue})})}};e.exports=a}),null);
__d("UFICommercialBreakAdapter",["SubscriptionsHandler","UFIInstanceAction","UFISharedDispatcher","gkx"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(a,c){var d=c.getOption("VideoWithCommercialBreak","controller"),e=new(b("SubscriptionsHandler"))();if(b("gkx")("AT40M32z8lGGJCQ8BdpTKBKW7c04XyOQ5frn2-EF3H5yLFnMqCUjJXNKrWFmzea4OX3v4yubJZaoRWQAybsxXQJO"))return e;d&&d.getIsCommercialBreakOngoing()&&b("UFISharedDispatcher").dispatch(b("UFIInstanceAction").toggleCommercialBreak(a,!0));e.addSubscriptions(c.addListener("commercialBreak/hideUFI",function(){return b("UFISharedDispatcher").dispatch(b("UFIInstanceAction").toggleCommercialBreak(a,!0))}),c.addListener("commercialBreak/showUFI",function(){return b("UFISharedDispatcher").dispatch(b("UFIInstanceAction").toggleCommercialBreak(a,!1))}));return e}var h=new Map();e.exports={start:function(a,b){var c=a.instanceid;if(h.get(c))return;h.set(c,g(a,b))},stop:function(a){var b=h.get(a);if(!b)return;b.release();h["delete"](a)}}}),null);
__d("UFIDomRootAdapter",["csx","DOMQuery","FeedbackSourceType","Parent","UFIRootRegistry"],(function(a,b,c,d,e,f,g){__p&&__p();function a(a,b){"use strict";this.$2=null,this.$3=null,this.$5=null,this.$4=a,this.$1=b}a.prototype.getParentForm=function(){"use strict";if(!this.$2){var a=b("Parent").byTag(this.$4,"form");this.$2=a instanceof HTMLElement?a:null}return this.$2};a.prototype.getHeadRoot=function(){"use strict";if(!this.$3){var a=b("UFIRootRegistry").isSnowliftNode(this.$1.rootid);a=a&&this.$1.source!==b("FeedbackSourceType").LIVE_VIDEO_STORIES?"^.fbPhotosSnowliftFeedback ._37uu":"^form ._37uu";a=b("DOMQuery").scry(this.$4,a);this.$3=a&&a[0]||null}return this.$3};a.prototype.getSnowliftActionRoot=function(){"use strict";if(!this.$5){var a=b("DOMQuery").scry(this.$4,"^.snowliftPayloadRoot ._29qf ._37uu");this.$5=a&&a[0]||null}return this.$5};e.exports=a}),null);
__d("UFIPlayLiveVODHighlightsAdapter",["SubscriptionsHandler","UFIInstanceAction","UFISharedDispatcher"],(function(a,b,c,d,e,f){"use strict";__p&&__p();function g(a,c){c&&c.isPlayingVODHighlights()&&b("UFISharedDispatcher").dispatch(b("UFIInstanceAction").playLiveVODHighlights(a,!0));var d=new(b("SubscriptionsHandler"))();d.addSubscriptions(c.addListener("playLiveVODHighlights/hideUFI",function(){return b("UFISharedDispatcher").dispatch(b("UFIInstanceAction").playLiveVODHighlights(a,!0))}),c.addListener("playLiveVODHighlights/showUFI",function(){return b("UFISharedDispatcher").dispatch(b("UFIInstanceAction").playLiveVODHighlights(a,!1))}));return d}var h=new Map();e.exports={start:function(a,b){var c=a.instanceid;if(h.get(c))return;h.set(c,g(a,b))},stop:function(a){var b=h.get(a);if(!b)return;b.release();h["delete"](a)}}}),null);
__d("CommentPrivacyUtils",["PrivateConversationsTreatment"],(function(a,b,c,d,e,f){"use strict";function g(a,c){return a.friendConversationsParams&&a.friendConversationsParams.viewerID===c?b("PrivateConversationsTreatment").FRIEND_CONVERSATIONS:b("PrivateConversationsTreatment").NONE}function a(a,c){return g(a,c)!==b("PrivateConversationsTreatment").NONE}e.exports={getTreatment:g,hasPrivateConversationsTreatment:a}}),null);
__d("UFICommentVPVDLoggingConfig",[],(function(a,b,c,d,e,f){"use strict";e.exports={idleTimeout:3e4,minDurationToLog:100,minVisibleSize:200}}),null);
__d("onCommentIsVisible",["cx","Arbiter","Parent","SubscriptionsHandler","UFICommentVPVDLoggingConfig","getFBAlphaConsoleSize","intersectionObserverEntryIsIntersecting","killswitch","observeIntersection","onViewportChanged"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=[0,.05,.1,.15,.2,.25,.3,.35,.4,.45,.5,.55,.6,.65,.7,.75,.8,.85,.9,.95,1],i={height:0};function a(a,c,d){__p&&__p();var e;function f(a){return c(a)}function g(a){e!==a&&(e=a,d(a))}function j(a){if(b("intersectionObserverEntryIsIntersecting")(a)===!1)d(!1);else{var c=a.boundingClientRect,e=a.intersectionRect,f=a.rootBounds;c=c||i;e=e||i;f=f||i;e.height>=b("UFICommentVPVDLoggingConfig").minVisibleSize||e.height>=f.height/2||e.height===c.height||a.intersectionRatio>.95&&a.intersectionRatio<=1?d(!0):d(!1)}}function k(a){return b("Parent").byClass(a,"uiScrollableAreaWrap")}if(b("killswitch")("LOG_COMMENT_VPVD_USING_INTERSECTION_OBSERVER"))return b("onViewportChanged")(g,f);else{var l=function(){var c=n==null?"-44px 0px -"+b("getFBAlphaConsoleSize")().height+"px 0px":undefined;o&&o.remove();o=b("observeIntersection")(a,j,{root:n,rootMargin:c,threshold:h});m.addSubscriptions(o)},m=new(b("SubscriptionsHandler"))(),n=k(a),o=null;b("Arbiter").subscribe(["PhotoSnowlift.DATA_CHANGE","PhotoSnowlift.GO"],function(){var b=k(a);b&&b!==n&&(n=b,l())});l();var p=!1;return{remove:function(){if(p)return;p=!0;m.release()}}}}e.exports=a}),null);
__d("UFIBusinessActorIcon.react",["cx","AppUserRoleConstants.brands","BusinessActorUtils.brands","React","getObjectValues","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=b("React").PropTypes;h=babelHelpers.inherits(a,b("React").Component);h&&h.prototype;a.prototype.render=function(){var a=b("BusinessActorUtils.brands").getInitials(this.props.firstName,this.props.lastName),c=this.props.businessRole===b("AppUserRoleConstants.brands").ADMIN;return b("React").createElement("div",{className:b("joinClasses")(this.props.classNames,"_1rpl")},b("React").createElement("div",{className:b("joinClasses")(this.props.textClassNames,c?"_1rpm":null)},a))};function a(){h.apply(this,arguments)}a.propTypes={firstName:c.string.isRequired,lastName:c.string.isRequired,classNames:c.string,textClassNames:c.string,businessRole:c.oneOf(b("getObjectValues")(b("AppUserRoleConstants.brands")))};e.exports=a}),null);
__d("UFIActorIconContainer.react",["cx","Image.react","React","ShortProfiles","UFIBusinessActorIcon.react","XUISpinner.react","joinClasses"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("React").createElement(b("XUISpinner.react"),{size:"large"});c=babelHelpers.inherits(a,b("React").Component);h=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.state={actor:null},b}a.prototype.componentDidMount=function(){this.$1()};a.prototype.componentDidUpdate=function(a){this.props.actorID!==a.actorID&&this.$1()};a.prototype.$1=function(){b("ShortProfiles").get(this.props.actorID,function(a){return this.setState({actor:a})}.bind(this))};a.prototype.render=function(){var a=this.state.actor;if(!a)return this.props.tinyIcon?b("React").createElement(b("XUISpinner.react"),{size:"small"}):i;var c;this.props.tinyIcon?c=b("joinClasses")("img UFIActorImage _3tm9",this.props.className):this.props.smallIcon?c=b("joinClasses")("img UFIActorImage _3qxe",this.props.className):c=b("joinClasses")("img UFIActorImage _54ru",this.props.className);return a.isBusinessPersona?b("React").createElement(b("UFIBusinessActorIcon.react"),{classNames:c,firstName:a.firstName,lastName:a.lastName,textClassNames:"UFIBusinessActorIconText"}):b("React").createElement(b("Image.react"),{alt:a.name,className:c,src:a.thumbSrc})};e.exports=a}),null);
__d("UFIAttachMediaSection.react",["cx","fbt","Bootloader","Focus","React","UFICommentFileInputAcceptValues","XUIError.react","gkx"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);i=d&&d.prototype;function a(){__p&&__p();var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=i.constructor).call.apply(a,[this].concat(e)),this.state={bootloaded:!1,hasUploadFailure:!1},this.$1=null,this.$2=null,this.$3=function(){this.setState({hasUploadFailure:!1})}.bind(this),this.$4=function(){this.setState({hasUploadFailure:!1})}.bind(this),this.$5=function(){this.setState({hasUploadFailure:!0})}.bind(this),this.$6=function(event){this.props.onClick&&this.props.onClick();if(this.state.bootloaded)return;b("Bootloader").loadModules(["UFIUploader"],function(a){this.$1=new a(this.refs.inputContainer,this.refs.inputControl,this.refs.input,this.props.getPhotoUploadData,this.props.getFileUploadData,this.props.prepareForAttachedPhotoPreview,this.props.prepareForAttachedVideoPreview,this.props.prepareForAttachedFilePreview,this.props.onPhotoUploadComplete,this.props.onVideoEncodeUpdate,this.props.onVideoUploadUpdate,this.props.onVideoUploadComplete,this.props.onFileUploadComplete,this.props.setFileInput,this.props.viewerActorID,this.$3,this.$4,this.$5)}.bind(this),"UFIAttachMediaSection.react");this.setState({bootloaded:!0})}.bind(this),c}a.prototype.componentDidMount=function(){var a=this.refs,c=a.input;a=a.inputControl;c&&a&&(this.$2=b("Focus").relocate(c,a))};a.prototype.componentWillUnmount=function(){this.$1&&this.$1.destroy(),this.$2&&(this.$2.remove(),this.$2=null)};a.prototype.render=function(){var a=b("gkx")("AT7t_EqG8ZLxpo8JnmIsX9tz87lbcgP_f3ZGsMEN1fYhO-5QeMxvdM9TZ9dQThWIcZOOGIdb7m-FtmQxL2OcvA8h")&&this.props.allowFileAttachments,c=a?h._("Attach a File"):this.props.allowVideoAttachments?h._("Attach a Photo or Video"):h._("Attach a Photo"),d=a?h._("There was a problem attaching the file, please try again"):h._("There was a problem attaching the file, please try again"),e=this.state.hasUploadFailure;a=b("React").createElement("div",{className:"_r1a UFIPhotoAttachLinkWrapper _m"+(this.props.attachment?" _5t1p":""),"data-hover":e?null:"tooltip","data-tooltip-alignh":e?null:"center","data-tooltip-content":e?null:c,onClick:this.$6,ref:"inputContainer",role:"presentation"},b("React").createElement("span",{className:a?"UFICommentFileIcon":"UFICommentPhotoIcon",ref:"inputControl"},b("React").createElement("input",{accept:a?b("UFICommentFileInputAcceptValues").files:this.props.allowVideoAttachments?b("UFICommentFileInputAcceptValues").both:b("UFICommentFileInputAcceptValues").photos,"aria-label":c,className:"_n",name:"file",ref:"input",title:c,type:"file",key:"0"})));return b("React").createElement(b("XUIError.react"),{xuiError:e?d:null,xuiErrorPosition:"above",xuiErrorAlignh:"center"},a)};a.propTypes={getPhotoUploadData:c.func.isRequired,getFileUploadData:c.func,prepareForAttachedPhotoPreview:c.func.isRequired,prepareForAttachedVideoPreview:c.func,prepareForAttachedFilePreview:c.func,onPhotoUploadComplete:c.func.isRequired,onVideoUploadComplete:c.func,onVideoUploadUpdate:c.func,onVideoEncodeUpdate:c.func,onFileUploadComplete:c.func,onClick:c.func,setFileInput:c.func.isRequired,targetId:c.string,allowVideoAttachments:c.bool,allowFileAttachments:c.bool,attachment:c.object,viewerActorID:c.string.isRequired};e.exports=a}),null);
__d("UFIStickerButton.react",["cx","fbt","Arbiter","Bootloader","FocusRelocator.react","Link.react","React","StickerInterfaces","getObjectValues"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();a=b("React").PropTypes;c=b("React").createClass({displayName:"UFIStickerButton",_clickGuard:!1,_updateListener:null,_linkRef:null,propTypes:{allowCustomStickers:a.bool,customStickerOwnerID:a.string,onStickerFlyoutShow:a.func,onStickerSelected:a.func.isRequired,onEmoticonSelected:a.func,showTooltip:a.bool,stickerInterface:a.oneOf(b("getObjectValues")(b("StickerInterfaces"))),tabIndex:a.number},getDefaultProps:function(){return{allowCustomStickers:!1,customStickerOwnerID:"",showTooltip:!0,stickerInterface:b("StickerInterfaces").COMMENTS}},getInitialState:function(){return{renderFlyout:null,flyoutShown:!1}},componentDidMount:function(){this._updateListener=b("Arbiter").subscribe("page_transition",function(){return this._hideFlyout()}.bind(this))},componentWillUnmount:function(){this._updateListener&&this._updateListener.unsubscribe()},render:function(){var a=h._("Post a sticker");return b("React").createElement(b("FocusRelocator.react"),{from:this._linkRef,to:this.refs.icon},b("React").createElement(b("Link.react"),{"aria-label":a,className:"_r1a UFICommentStickerButton","data-hover":"tooltip","data-tooltip-alignh":"center","data-tooltip-content":this.props.showTooltip?a:null,linkRef:this._setRef,onClick:this._onLinkClicked,onMouseDown:this._prepareForClick,role:"button",tabIndex:this.props.tabIndex},b("React").createElement("div",{ref:"icon",className:"UFICommentStickerIcon"+(this.state.flyoutShown?" UFICommentStickerIconActive":"")}),this.props.children,this.state.renderFlyout?this.state.renderFlyout():null))},_hideFlyout:function(){this.setState({flyoutShown:!1})},_prepareForClick:function(){this._clickGuard=this.state.flyoutShown},_onLinkClicked:function(a){__p&&__p();a.preventDefault();if(this.state.renderFlyout!==null){this._clickGuard||(this.props.onStickerFlyoutShow&&this.props.onStickerFlyoutShow(),this.setState({flyoutShown:!0}));return}b("Bootloader").loadModules(["ContextualLayerAutoFlip","LayerTabIsolation","StickersFlyout.react","XUIContextualDialog.react"],function(a,c,d,e){this.setState({flyoutShown:!0,renderFlyout:function(){return b("React").createElement(e,{alignment:"right",behaviors:{ContextualLayerAutoFlip:a,LayerTabIsolation:c},className:"_5e-r",contextRef:function(){return this._linkRef}.bind(this),onBlur:this._hideFlyout,onToggle:function(a){!a&&this.state.flyoutShown&&this._hideFlyout()}.bind(this),position:"above",shown:this.state.flyoutShown,hasActionableContext:!0,width:this.props.allowCustomStickers?213:278},b("React").createElement("div",null,b("React").createElement(d,{allowCustomStickers:this.props.allowCustomStickers,customStickerOwnerID:this.props.customStickerOwnerID,onEscKeyDown:this._hideFlyout,onStickerSelect:this._onStickerSelected,onEmoticonSelect:this._onEmoticonSelected,stickerInterface:this.props.stickerInterface,shown:this.state.flyoutShown})))}.bind(this)}),this.props.onStickerFlyoutShow&&this.props.onStickerFlyoutShow()}.bind(this),"UFIStickerButton.react")},_onStickerSelected:function(a,event,b){this.props.onStickerSelected(a,event,b),this._hideFlyout()},_onEmoticonSelected:function(a){this.props.onEmoticonSelected&&this.props.onEmoticonSelected(a),this._hideFlyout()},_setRef:function(a){this._linkRef=a}});e.exports=c}),null);
__d("UFIAddComment.react",["cx","fbt","invariant","AccessibilityConfig","ActorURI","Arbiter","AsyncRequest","Badge.react","BootloadedComponent.react","Bootloader","ClipboardPhotoUploader","CommentPrivacyUtils","CommentPrivacyValue","ConstituentBadgeEventEmitter","ConversationGuideRenderLocation","ConversationGuideSuggestionType","EmojiInputButton.react","Event","FeedbackSourceType","JSResource","Keys","Link.react","LitestandStoryInsertionStatus","MentionsInputUtils","MercuryIDs","Placeholder.react","PrivateCommentsConfig","PrivateConversationsTreatment","React","ReactDOM","Run","SearchableEntry","SubscriptionsHandler","SutroStoryHeaderUFIGatingConfig","TextWithEntities.react","TrackingNodes","UFIActorIconContainer.react","UFIAddCommentAction","UFIAttachMediaSection.react","UFIBotsButton","UFICommercialBreakStore","UFICommonInteractionEvents","UFICommonInteractionLogger","UFIComposerIsTypingStore","UFIConfig","UFIGifButton.react","UFIGroupedInputTabs","UFIImageBlock.react","UFIMarkdownButton.react","UFINavigationCheck","UFIODSLogger","UFIPlayLiveVODHighlightsStore","UFISharedDispatcher","UFIStickerButton.react","UFIThreadedFacecastCommentsStore","UFIVersion","WebFunnelLogger","WritingAssistanceTypedLogger","XBasicFBNuxDismissController","XBasicFBNuxGenShouldShowController","XBasicFBNuxViewController","XConstituentBadgeV2OptInDialogController","XFeedNUXSaveSeenStateController","XUFICommentGIFPreprocessController","XUFICommentMarkdownPreviewController","XUISpinner.react","XUIText.react","getActiveElement","ifRequired","joinClasses","lazyLoadComponent","promiseDone","requireCond","requireWeak","textProbablyWritingMarkdown","throttle","uuid","cr:659094"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k=b("UFIBotsButton").module,l=b("UFIGroupedInputTabs").InputTitleEnum,m=b("UFIGroupedInputTabs").setLastUsedTab,n=b("cr:659094").v,o={startFunnel:function(a){return undefined},logViewerInteracted:function(a){return undefined},logToggle:function(a,b){return undefined}};b("requireWeak")("PrivateCommentsLogger",function(a){o=a});var p=null,q=a.URL||a.webkitURL||{};c=b("React").PropTypes;var r=h._("Write a comment..."),s=h._("Write a reply..."),t="fcg fss UFICommentTip",u=h._("Write something..."),v=19,w="/ajax/ufi/upload/",x="/ajax/ufi/sticker_preview/",y=1e3,z="comment_content_change",A=Object.freeze({UPLOAD:"uploading",ENCODE:"encoding"}),B=5572,C=/@\[([0-9;]+):((?:[^\\\]]|\\.)*)\]/g,D=b("lazyLoadComponent")(b("JSResource")("UFICommentPivotBlock.react").__setRef("UFIAddComment.react")),E=b("lazyLoadComponent")(b("JSResource")("UFICommentPivotFailedDialog.react").__setRef("UFIAddComment.react")),F=!1,G=!1,H=!1;d=babelHelpers.inherits(I,b("React").Component);j=d&&d.prototype;I.renderEditCommentBox=function(a,c,d){__p&&__p();a=babelHelpers["extends"]({},a);delete a.addcommentautoflip;delete a.collapseaddcomment;delete a.hideActorPhoto;delete a.issnowlift;delete a.loggedOutLinkConfig;delete a.monitorHeight;delete a.sht;delete a.viewoptionstypeobjects;delete a.viewoptionstypeobjectsorder;return b("React").createElement(I,{key:"editing_comment"+c.id,viewerActorID:d.actorforpost,targetID:d.ownerid,groupID:d.grouporeventid,mentionsDataSource:d.mentionsdatasource,contextArgs:a,isEditing:!0,editingComment:c,allowVideoAttachments:d.allowvideoattachments,allowPhotoAttachments:d.allowphotoattachments,allowFileAttachments:d.allowfileattachments,allowStickerAttachments:d.allowstickerattachments,allowGifAttachments:d.allowgifattachments,allowTogglePrivateComments:!1,privateCommentTarget:d.actorname,allowCommentMarkdown:d.iscommentmarkdowneligible,showconstituentbadgev2optin:d.showconstituentbadgev2optin,constituentBanner:d.constituentbanneruri})};function I(c){__p&&__p();j.constructor.call(this,c);this.$4=!1;this.$20=function(event){this.props.isEditing&&b("Event").getKeyCode(event.nativeEvent)===b("Keys").ESC&&this.context.dispatch(b("UFIAddCommentAction").cancel(this.props.contextArgs));this.$1&&!this.$5&&(b("Run").onBeforeUnload(this.$21),this.$5=!0);var a=b("getActiveElement")();a&&b("Event").getKeyCode(event.nativeEvent)===b("Keys").ESC&&a.blur()}.bind(this);this.$22=function(a){this.$2&&!this.$4&&(new(b("WebFunnelLogger"))("GUFIComposerWebFunnelDefinition").setSessionKey(this.$2).setAction("first_input").log(),this.$4=!0),b("UFISharedDispatcher").dispatch(b("UFIAddCommentAction").changeContent(this.props.contextArgs,a,this.$23())),b("Arbiter").inform(z,{fbid:this.$23(),text:a,instanceid:this.props.contextArgs.instanceid,ftentidentifier:this.props.contextArgs.ftentidentifier}),this.props.allowCommentMarkdown&&this.state.commentMarkdownEnabled&&this.$24(a),this.props.allowCommentFixSuggestions&&(this.$25(a),this.state.commentSuggestionsShowing&&!this.state.hasStaleSuggestions&&this.setState({hasStaleSuggestions:!0})),this.props.contextArgs.messengerCommentPivotsParams&&this.props.contextArgs.messengerCommentPivotsParams.enabled&&this.$26(a),this.state.groupedInputNUXShown&&this.$27()}.bind(this);this.$24=function(a){a=b("XUFICommentMarkdownPreviewController").getURIBuilder().setString("comment_body",a).getURI();new(b("AsyncRequest"))(a).setHandler(this.$31).send()}.bind(this);this.$31=function(a){if(!a)return;this.setState({commentMarkdownPreviewContent:a.payload?a.payload.markup:null})}.bind(this);this.$21=function(){if(a.PageTransitions&&!b("UFINavigationCheck").isLeaving(a.PageTransitions))return;if(this.refs&&this.refs.mentionsinput&&this.refs.mentionsinput.hasEnteredText())return h._("You haven't finished your comment yet. Do you want to leave without finishing?")}.bind(this);this.$33=function(){this.setState({markdownNUXVisible:!1,gifsInCommentsNUXVisible:!1,groupedInputNUXShown:!1,privateCommentNUXVisible:!1});setTimeout(function(){this.$1&&this.setState({isFocused:!1})}.bind(this),100);if(this.refs.mentionsinput&&this.refs.mentionsinput.hasEnteredText())return;this.setState({isCommenting:!1})}.bind(this);this.$34=function(event){var a=new(b("ClipboardPhotoUploader"))(w,this.$35());this.$36();this.$6=[a.subscribe("upload_start",this.$37),a.subscribe("upload_error",this.$38),a.subscribe("upload_success",function(a,b){this.$39(b)}.bind(this))];a.handlePaste(event)}.bind(this);this.$43=function(a,event){var b=this.props.isEditing||this.state.hasAttachment,c=a.encodedValue&&a.encodedValue.trim(),d=this.state.isLoadingPhoto||this.$44()||this.state.isLoadingFile;if(d||!b&&!c)return!1;else if(!b&&this.state.showMessengerPivot&&this.state.shouldSendAsMessage){d=a.encodedValue=a.encodedValue?a.encodedValue.trim():"";return this.$45(d)}else return this.$46(a,event)}.bind(this);this.$50=function(){this.$40()}.bind(this);this.focus=function(){__p&&__p();this.$40();var a={isCommenting:!0,isFocused:!0},c=this.props.contextArgs.loggedOutLinkConfig;c&&c.showAddComment&&b("Bootloader").loadModules(["AsyncDialog"],function(a){a.bootstrap(c.addCommentAjaxifyURI,null,"dialog")},"UFIAddComment.react");this.refs.groupedInputButton&&b("Bootloader").loadModules(["SimpleNUXMessage","SimpleNUXMessageTypes"],function(a,b){a.hasUserSeenMessage(b.MERGE_INPUT_COMPOSER_NUX)||(this.setState({groupedInputNUXShown:!0}),a.markMessageSeenByUser(b.MERGE_INPUT_COMPOSER_NUX))}.bind(this),"UFIAddComment.react");if(this.props.allowGifAttachments&&b("UFIConfig").shouldShowGIFsInCommentsNux&&!F){F=!0;var d=b("XFeedNUXSaveSeenStateController").getURIBuilder().setString("key","gif_comments").setBool("seen",!0).getURI();new(b("AsyncRequest"))(d).send();a.gifsInCommentsNUXVisible=!0}if(this.props.allowCommentMarkdown&&b("UFIConfig").shouldShowMarkdownCommentNUX&&!b("UFIConfig").shouldShowGIFsInCommentsNux&&!G){G=!0;d=b("XFeedNUXSaveSeenStateController").getURIBuilder().setString("key","markdown_comments").setBool("seen",!0).getURI();new(b("AsyncRequest"))(d).send();a.markdownNUXVisible=!0}if(this.props.allowTogglePrivateComments&&!(this.state.gifsInCommentsNUXVisible||a.gifsInCommentsNUXVisible)&&!(this.state.markdownNUXVisible||a.markdownNUXVisible)&&!H){H=!0;d=b("XBasicFBNuxGenShouldShowController").getURIBuilder().setInt("nux_id",B).getURI();new(b("AsyncRequest"))().setURI(d).setMethod("GET").setReadOnly(!0).setHandler(function(a){a=a.getPayload();if(a&&a.should_show_nux){a=b("XBasicFBNuxViewController").getURIBuilder().setInt("nux_id",B).getURI();new(b("AsyncRequest"))().setURI(a).send();this.setState({privateCommentNUXVisible:!0})}}.bind(this)).send()}if(this.state.showConstituentBadgeV2OptIn){d=b("XConstituentBadgeV2OptInDialogController").getURIBuilder().setString("ft_id",this.props.commentsTargetID).getURI();new(b("AsyncRequest"))().setURI(d).send()}this.setState(a);this.markViewerHasInteracted();this.props.onFocus&&this.props.onFocus();b("Arbiter").inform("UFIAddComment/focus",{instanceid:this.props.contextArgs.instanceid,ftentidentifier:this.props.contextArgs.ftentidentifier,isTopLevelComposer:this.props.isTopLevelComposer})}.bind(this);this.$60=function(a,b){this.setState({fileInput:a,fileUploader:b})}.bind(this);this.$61=function(a){p=a,this.setState({commentPrivacy:a}),setTimeout(function(){return this.refs.mentionsinput.focus()}.bind(this),100)}.bind(this);this.handleMessengerPivotClick=function(){this.setState(function(a){this.$29(a.shouldSendAsMessage?"pivot disabled":"pivot enabled");return{shouldSendAsMessage:!a.shouldSendAsMessage}}.bind(this)),this.refs.mentionsinput.focus()}.bind(this);this.$62=function(a){m(l.EMOJI),this.refs.mentionsinput.insertEmoji(a)}.bind(this);this.$63=function(a){m(l.STICKER),this.$68(a),this.$67(!1)}.bind(this);this.$66=function(a,event){m(l.STICKER),this.onStickerSelected(a,event),this.$67(!1)}.bind(this);this.$64=function(a){m(l.GIF),this.onGifSelected(a),this.$67(!1)}.bind(this);this.$67=function(a){a!==this.state.flyoutShown&&this.setState({flyoutShown:a})}.bind(this);this.$69=function(){this.state.customStickerNUXShown&&this.$52()}.bind(this);this.$65=function(){this.state.flyoutShown||this.markViewerHasInteracted(),this.state.groupedInputNUXShown&&this.$27(),this.state.customStickerNUXShown&&this.$52()}.bind(this);this.$35=function(){var a=this.props.viewerActorID,c={profile_id:a,target_id:this.props.targetID,source:v};c[b("ActorURI").PARAMETER_ACTOR]=a;return c}.bind(this);this.$39=function(a){if(!this.state.isLoadingPhoto)return;a=a.getPayload();a&&a.fbid?this.setState({attachedPhoto:a,isLoadingPhoto:!1}):this.$38(null)}.bind(this);this.$70=function(){var a=this.props.viewerActorID,c={profile_id:a,target_id:this.props.targetID};c[b("ActorURI").PARAMETER_ACTOR]=a;return c}.bind(this);this.$73=function(a){if(!this.state.isLoadingFile)return;a=a.getPayload();a&&a.fbid?this.setState({attachedFile:a,isLoadingFile:!1}):this.$38(null)}.bind(this);this.$75=function(a,b){if(!this.state.attachedVideo||this.state.videoStatus!==A.ENCODE)return;if(b.obj.progress<this.state.videoProgress)return;b.obj.fbid=b.obj.videoID;if(this.state.attachedVideo.fbid&&this.state.attachedVideo.fbid!==b.obj.fbid)return;this.setState({attachedVideo:b.obj,videoProgress:b.obj.progress,videoStatus:A.ENCODE});this.$88(b.obj.stage)&&this.$89()}.bind(this);this.$76=function(a){this.setState({videoProgress:a})}.bind(this);this.$74=function(a){if(this.state.videoStatus!==A.UPLOAD)return;a&&a.video_id&&this.setState({videoProgress:0,attachedVideo:a,videoStatus:A.ENCODE})}.bind(this);this.$38=function(event){b("Arbiter").inform("video_upload_cancel",{}),this.state.fileInput&&this.state.fileInput.clear(),this.setState({attachedPhoto:null,attachedVideo:null,attachedFile:null,attachedGIF:null,attachedStars:null,videoStatus:null,videoFileURL:null,isLoadingPhoto:!1,videoProgress:0,isVideoFileTranscodedGIF:!1,hasAttachment:!1})}.bind(this);this.$37=function(){this.setState({attachedPhoto:null,isLoadingPhoto:!0})}.bind(this);this.$72=function(){this.setState({attachedFile:null,isLoadingFile:!0})}.bind(this);this.$71=function(){var a,b=this.state.fileInput?this.state.fileInput.input:null;b=b?b.files[0]:null;b&&q.createObjectURL&&(a=q.createObjectURL(b));this.setState({attachedVideo:null,videoStatus:A.UPLOAD,videoFileURL:a,videoProgress:0,isVideoFileTranscodedGIF:Boolean(b&&b.type==="image/gif")})}.bind(this);this.$90=function(a){if(!this.state.isLoadingPhoto)return;a=a.getPayload();a&&a.fbid?this.setState({attachedSticker:a,isLoadingPhoto:!1}):(b("Bootloader").loadModules(["Dialog"],function(a){var b=h._("Sticker Failed"),c=h._("There was a problem attaching the sticker.");new a().setTitle(b).setBody(c).setButtons(a.OK).show()},"UFIAddComment.react"),this.$78(null))}.bind(this);this.$78=function(event){this.setState({attachedSticker:null,isLoadingPhoto:!1,hasAttachment:!1})}.bind(this);this.$77=function(event){b("Bootloader").loadModules(["FunnelLogger"],function(a){a.appendAction("FLEXIBLE_STARS_WWW_FUNNEL","dismissed_star_attachment"),a.endFunnel("FLEXIBLE_STARS_WWW_FUNNEL")},"UFIAddComment.react"),this.$38(event)}.bind(this);this.onStickerSelected=function(a,event){if(this.props.isEditing||this.refs.mentionsinput.hasEnteredText()){this.$87(a);return}this.sendSticker(a,event)}.bind(this);this.onStarsSelected=function(a){this.setState({attachedStars:{fbid:a.id,metadata:a,type:"SEND_STARS"}})}.bind(this);this.$68=function(a){__p&&__p();b("Bootloader").loadModules(["EmoticonsList","EmoticonUtils","TextAreaControl","SelectionPosition"],function(c,d,e,f){__p&&__p();c=c.symbols[a];if(!c)return;if(this.props.contextArgs.mentionsinput){this.refs.mentionsinput.insertEmoticon(c);return}this.$15||(this.$15=new f(b("ReactDOM").findDOMNode(this.refs.mentionsinput.refs.textarea)));f=this.refs.mentionsinput.refs.getTextFieldDOM();e=e.getInstance(f);f=e.getValue();this.$15||i(0,undefined);d=d.insertEmoticon(c,f,this.$15.getPos());e.setValue(d.result);this.$15||i(0,undefined);this.$15.setPos(d.start,d.end)}.bind(this),"UFIAddComment.react")}.bind(this);this.$52=function(){this.setState({customStickerNUXShown:!1})}.bind(this);this.$55=function(){this.setState({markdownNUXVisible:!1})}.bind(this);this.$27=function(){this.setState({groupedInputNUXShown:!1})}.bind(this);this.$59=function(){var a=b("XBasicFBNuxDismissController").getURIBuilder().setInt("nux_id",B).getURI();new(b("AsyncRequest"))().setURI(a).send();this.setState({privateCommentNUXVisible:!1})}.bind(this);this.onGifSelected=function(a){if(this.props.isEditing||this.refs.mentionsinput.hasEnteredText()){this.setState({attachedGIF:a});this.preprocessGIF(a);return}this.sendGIF(a)}.bind(this);this.$79=function(a,b){this.setState(function(c){c[a]=b;return{mentionsData:c}},function(){this.props.contextArgs.messengerCommentPivotsParams&&this.props.contextArgs.messengerCommentPivotsParams.enabled&&this.$28()}.bind(this))}.bind(this);this.$1=!1;var d=this.props.editingComment,e=d.attachment,f=e?e.type:null,g=f==="photo"?e:null;this.state={attachedPhoto:d.photo_comment||g,attachedVideo:d.video_comment||null,attachedFile:d.file_comment||null,attachedSticker:f=="sticker"?e:null,attachedGIF:f=="gif"?e:null,attachedStars:f=="SEND_STARS"?e:null,commentMarkdownPreviewContent:d.body?d.body.markup||null:null,commentMarkdownEnabled:d.body?d.body.markdown_enabled||!1:!1,currentThreadedFacecastCommentID:b("UFIThreadedFacecastCommentsStore").getCommentID(c.contextArgs.instanceid),addCommentNUXShown:this.props.contextArgs.permalinkAddCommentNuxShown||!1,commentPrivacy:d.privacy_value||this.props.replyCommentPrivacy||b("CommentPrivacyValue").DEFAULT_PRIVACY,showConstituentBadgeV2OptIn:Boolean(this.props.showConstituentBadgeV2OptIn),constituentBannerState:String(this.props.constituentBanner),customStickerNUXShown:!1,commentSuggestionsShowing:!1,videoStatus:null,videoFileURL:null,videoProgress:0,isVideoFileTranscodedGIF:!1,fileInput:null,fileUploader:null,flyoutShown:!1,isCommenting:!1,isLoadingPhoto:!1,isLoadingFile:!1,isFocused:Boolean(this.props.isEditing),gifsInCommentsNUXVisible:!1,groupedInputNUXShown:!1,markdownNUXVisible:!1,privateCommentNUXVisible:!1,hasPotentialSuggestions:!1,hasStaleSuggestions:!1,isInitialSuggestionCheck:!0,inCommercialBreak:!1,isPlayingLiveVODHighlights:!1,showFailedMessageDialog:!1,showMessengerPivot:!1,shouldSendAsMessage:!1,isSendingMessage:!1,hasAttachment:!1,mentionsData:{},currentMentionIds:[],currentMentionOffsets:[],videoTrimParams:null};g=this.state.attachedPhoto||this.state.attachedVideo||this.state.attachedFile||this.state.attachedGIF||this.state.attachedSticker||this.state.attachedStars;this.state.hasAttachment=!!g;this.$18()&&(p=p===null?this.$19():p,this.state.commentPrivacy=p);b("Run").onLoad(function(){b("Bootloader").loadModules(["UFIAddCommentLiveTypingController"],function(){},"UFIAddComment.react")})}I.prototype.$26=function(a){this.setState(function(){var b=this.parseTextForMentions(a).map(function(a){return a.uid}),c=this.parseTextForMentions(a).map(function(a){return a.offset});return{currentMentionIds:b,currentMentionOffsets:c}}.bind(this),function(){this.$28()}.bind(this))};I.prototype.$28=function(){__p&&__p();if(this.props.contextArgs.shareLinkConfig&&!this.$23()&&!this.props.isEditing){var a=this.state.currentMentionIds.length>=1,b=this.state.currentMentionOffsets.findIndex(function(a){return a===0})!==-1;if((!a||!b)&&this.state.showMessengerPivot)this.$29("pivot hidden"),this.setState({showMessengerPivot:!1});else if(a&&b){var c=!0;a=!1;b=this.state.currentMentionIds.length;for(var d=0;d<b;d++){var e=this.state.currentMentionIds[d];if(!this.state.mentionsData[e]){a=!0;break}else if(this.state.mentionsData[e]!=="user"){c=!1;break}}a||this.setState(function(a){if(c!==a.showMessengerPivot){this.$30();this.$29(a.showMessengerPivot?"pivot hidden":"pivot shown");return{showMessengerPivot:!a.showMessengerPivot}}return{}}.bind(this))}}};I.prototype.$32=function(a){__p&&__p();if(!this.$16||this.$16.length===a.length)return!1;var b,c;this.$16.length>a.length?(b=this.$16,c=a):(b=a,c=this.$16);a=null;var d=0;while(a===null&&d<c.length)c[d]!==b[d]&&(a=b[d]),d++;if(a===null)a=b[b.length-1];else{c=b[d];if(!/[a-zA-Z\-\']/.test(c))return!1}return!/[a-zA-Z\-\']/.test(a)};I.prototype.$25=function(a){__p&&__p();if(!this.$32(a)){this.$16=a;return}this.$16=a;var c=a.match(/[a-zA-z\-\']+/g);if(!c)return;var d=b("AccessibilityConfig").svTypicalDyslexiaMisspellings,e=!1;a=a.toUpperCase()===a;for(var c=c,f=Array.isArray(c),g=0,c=f?c:c[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var h;if(f){if(g>=c.length)break;h=c[g++]}else{g=c.next();if(g.done)break;h=g.value}h=h;if(a||h.toUpperCase()!==h){h=h.toLowerCase();d.includes(h)&&(e=!0)}}if(this.state.hasPotentialSuggestions===e)return;this.setState({hasPotentialSuggestions:e});e&&new(b("WritingAssistanceTypedLogger"))().setAction("badge_shown").setValue("true").log()};I.prototype.$40=function(){this.$2||(this.$2=this.props.viewerActorID+"_"+Date.now(),new(b("WebFunnelLogger"))("GUFIComposerWebFunnelDefinition").setSessionKey(this.$2).setAction("focus").setFunnelTags(["depth_"+(this.$23()?"1":"0")]).markStart().log())};I.prototype.$41=function(){this.$2&&(new(b("WebFunnelLogger"))("GUFIComposerWebFunnelDefinition").setSessionKey(this.$2).setAction("commit").markEnd().log(),delete this.$2,this.$4=!1)};I.prototype.$30=function(){this.$3||(this.$3=""+Date.now(),new(b("WebFunnelLogger"))("UFIMessengerPivotsWebFunnelDefinition").setSessionKey(this.$3).setAction("Start").markStart().log())};I.prototype.$42=function(){this.$3&&(new(b("WebFunnelLogger"))("UFIMessengerPivotsWebFunnelDefinition").setSessionKey(this.$3).setAction("Commit").markEnd().log(),this.$3=null)};I.prototype.$29=function(a){this.$3&&new(b("WebFunnelLogger"))("UFIMessengerPivotsWebFunnelDefinition").setSessionKey(this.$3).setAction(a).log()};I.prototype.$46=function(a,event){__p&&__p();this.setState({showMessengerPivot:!1});this.$29("comment posted");this.$42();a.encodedValue=a.encodedValue?a.encodedValue.trim():"";this.state.commentMarkdownEnabled?(a.isMarkdown=!0,this.setState({commentMarkdownEnabled:!1,commentMarkdownPreviewContent:null})):this.props.allowCommentMarkdown&&!a.isMarkdown&&(a.isMarkdown=b("textProbablyWritingMarkdown")(a.encodedValue));this.state.commentPrivacy&&(a.privacy_value=this.state.commentPrivacy);this.state.hasAttachment?(a.attachedPhoto=this.state.attachedPhoto,a.attachedVideo=this.state.attachedVideo,a.attachedFile=this.state.attachedFile,a.attachedSticker=this.state.attachedSticker,a.attachedStars=this.state.attachedStars,this.state.attachedGIF&&(this.state.attachedGIF.source?a.attachedShareURL=this.state.attachedGIF.source.url:this.state.attachedGIF.originalImageUrl&&(a.attachedShareURL=this.state.attachedGIF.originalImageUrl)),this.setState({isLoadingPhoto:!1,isLoadingFile:!1,attachedPhoto:null,attachedVideo:null,attachedFile:null,attachedSticker:null,attachedGIF:null,attachedStars:null,hasAttachment:!1})):(a.attachedPhoto=null,a.attachedVideo=null,a.attachedFile=null,a.attachedSticker=null,a.attachedGIF=null,a.attachedShareURL=null,a.attachedStars=null);if(this.props.isEditing)this.context.dispatch(b("UFIAddCommentAction").submitEdit(this.props.contextArgs,this.props.editingComment,a,event.target));else if(this.state.attachedStars)this.$47(a);else{var c=b("UFICommonInteractionLogger").makeTrackingID();b("UFICommonInteractionLogger").startInteraction(b("UFICommonInteractionEvents").UFI_OPTIMISTIC_COMMENT,c+b("UFICommonInteractionEvents").UFI_OPTIMISTIC_COMMENT);b("UFICommonInteractionLogger").startInteraction(b("UFICommonInteractionEvents").UFI_PERSISTED_COMMENT,c+b("UFICommonInteractionEvents").UFI_PERSISTED_COMMENT);a.trackingID=c;this.context.dispatch(b("UFIAddCommentAction").submitNew(this.props.contextArgs,a,event.target,this.$23()))}this.$41();this.$48();return!0};I.prototype.$47=function(a){var c,d=(c=this.state.attachedStars)==null?void 0:c.metadata,e=this.props.targetID;d&&e&&b("Bootloader").loadModules(["VideoStarsSpendMutationWebGraphQLMutation","WebGraphQL","FunnelLogger"],function(c,f,g){b("promiseDone")(f.exec(new c({input:{actor_id:this.props.viewerActorID,client_mutation_id:b("uuid")(),comment:a.encodedValue,payee_id:e,platform:"FB",spending_units:d.quantity,video_id:this.props.commentsTargetID,wallet_type:"FB_STARS"}}))),g.appendActionWithTag("FLEXIBLE_STARS_WWW_FUNNEL","sent_stars",d.quantity),g.endFunnel("FLEXIBLE_STARS_WWW_FUNNEL")}.bind(this),"UFIAddComment.react")};I.prototype.$45=function(a){__p&&__p();this.$41();this.$29("begin message send");this.setState({isSendingMessage:!0});var c=b("Bootloader").loadModules(["FantaTabActions","MercurySourceType","XMessengerPivotsController","UFICommentPivotFailedDialog.react"],function(d,e,f,c){__p&&__p();e=f.getURIBuilder().setString("comment_body",a).setFBID("ft_ent_identifier",this.props.contextArgs.ftentidentifier).getURI();new(b("AsyncRequest"))(e).setHandler(function(c){var e=[{startIndex:0,changeCount:a.length,changeValue:""}];this.refs.mentionsinput.replaceText("",e);this.setState({showMessengerPivot:!1,isSendingMessage:!1});e=c.payload;e.id&&(e.isGroup?d.openTab(b("MercuryIDs").getThreadIDFromThreadFBID(e.id.toString())):d.openTab(b("MercuryIDs").getThreadIDFromUserID(e.id.toString())));this.$29("send succeeded");this.$42()}.bind(this)).setErrorHandler(function(a){this.setState({isSendingMessage:!1,showFailedMessageDialog:!0}),this.$29("send failed")}.bind(this)).send()}.bind(this),"UFIAddComment.react");this.$7.addSubscriptions(c);this.refs.mentionsinput.focus();return!1};I.prototype.$44=function(){return this.state.videoStatus===A.UPLOAD||this.state.videoStatus===A.ENCODE&&this.state.videoProgress!==100};I.prototype.$36=function(){this.$6&&this.$6.forEach(function(a){a.unsubscribe()})};I.prototype.UNSAFE_componentWillMount=function(){__p&&__p();this.$5=!1,this.$9=b("LitestandStoryInsertionStatus").registerBlocker(function(){return this.state.isCommenting}.bind(this)),this.$7&&this.$7.release(),this.$7=new(b("SubscriptionsHandler"))(),this.$7.addSubscriptions(b("UFICommercialBreakStore").addListener(function(){this.setState({inCommercialBreak:b("UFICommercialBreakStore").getValueFor(this.props.contextArgs.instanceid)})}.bind(this)),b("UFIPlayLiveVODHighlightsStore").addListener(function(){this.setState({isPlayingLiveVODHighlights:b("UFIPlayLiveVODHighlightsStore").getValueFor(this.props.contextArgs.instanceid)})}.bind(this)),b("ConstituentBadgeEventEmitter").addListener("ConstituentBadgeV2OptInModal",function(a){if(!a){this.setState({showConstituentBadgeV2OptIn:!1});return}this.setState({constituentBannerState:a.turn_off?null:this.props.constituentBanner,showConstituentBadgeV2OptIn:!1})}.bind(this))),this.props.allowLiveVideoCommentReplyMode&&(this.props.contextArgs.islivestreaming||this.props.contextArgs.isLiveVOD)&&this.$7.addSubscriptions(b("UFIThreadedFacecastCommentsStore").addListener(function(){var a=this.state.currentThreadedFacecastCommentID,c=b("UFIThreadedFacecastCommentsStore").getCommentID(this.props.contextArgs.instanceid);this.setState({currentThreadedFacecastCommentID:c});c!==a&&this.focus()}.bind(this))),this.$8=null,b("UFIConfig").canPublishLive&&this.$7.addSubscriptions(b("UFIComposerIsTypingStore").addListener(function(){var a=b("UFIComposerIsTypingStore").getValueFor(this.props.contextArgs.ftentidentifier);if(a===null)return;b("Bootloader").loadModules(["UFIAddCommentLiveTypingController"],function(b){this.$8||(this.$8=new b(this.props.contextArgs.ftentidentifier,this.$23(),this.props.viewerActorID)),a?this.$8.attemptPublishStartEvent():this.$8.attemptPublishStopEvent()}.bind(this),"UFIAddComment.react")}.bind(this))),this.props.allowTogglePrivateComments&&(b("PrivateCommentsConfig").composer_lock_enabled||b("PrivateCommentsConfig").composer_unlocked_lock_enabled)&&this.$7.addSubscriptions(b("UFIComposerIsTypingStore").addListener(function(){var a=this.props.contextArgs.ftentidentifier;b("UFIComposerIsTypingStore").getValueFor(a)&&o.logViewerInteracted(a)}.bind(this)))};I.prototype.$49=function(){this.$8&&this.$8.destroy(),this.$8=null};I.prototype.UNSAFE_componentWillReceiveProps=function(a){var b=this.props.contextArgs.ftentidentifier,c=a.contextArgs.ftentidentifier;(c!==b||this.props.replyCommentID!==a.replyCommentID||this.props.viewerActorID!==a.viewerActorID)&&this.$49()};I.prototype.componentWillUnmount=function(){b("Bootloader").loadModules(["TextDelightInComposerLogger"],function(a){a.endFunnel(this.$23()||this.props.contextArgs.ftentidentifier)}.bind(this),"UFIAddComment.react"),this.$1=!1,this.$36(),this.$11&&b("Arbiter").unsubscribe(this.$11),this.$10&&b("Arbiter").unsubscribe(this.$10),this.$12&&b("Arbiter").unsubscribe(this.$12),this.$13&&b("Arbiter").unsubscribe(this.$13),this.$14&&b("Arbiter").unsubscribe(this.$14),this.$9&&this.$9.unsubscribe(),this.$9=null,this.$7&&this.$7.release(),this.$49()};I.prototype.$51=function(){if(!this.state.customStickerNUXShown)this.props.allowCustomStickerAttachments&&(this.refs.groupedInputButton||this.refs.sticker_button)&&b("Bootloader").loadModules(["SimpleNUXMessage","SimpleNUXMessageTypes"],function(a,b){a.hasUserSeenMessage(b.GAMES_STREAM_CUSTOM_STICKER)||(this.setState({customStickerNUXShown:!0}),a.markMessageSeenByUser(b.GAMES_STREAM_CUSTOM_STICKER))}.bind(this),"UFIAddComment.react");else{var a=this.refs.sticker_button?this.refs.sticker_button:this.refs.groupedInputButton;return b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("XUIAmbientNUX.react").__setRef("UFIAddComment.react"),bootloadPlaceholder:b("React").createElement("div",null),contextRef:function(){return a},shown:this.state.customStickerNUXShown,position:"above",width:"auto",alignment:"right",onCloseButtonClick:this.$52},h._("New! Send a custom sticker"))}return null};I.prototype.$53=function(){return this.state.gifsInCommentsNUXVisible&&this.refs.gif_button?b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("XUIAmbientNUX.react").__setRef("UFIAddComment.react"),bootloadPlaceholder:b("React").createElement("div",null),contextRef:function(){return this.refs.gif_button}.bind(this),shown:this.state.gifsInCommentsNUXVisible,position:"above",width:"auto",alignment:"right"},h._("You can now add GIFs to comments")):null};I.prototype.$54=function(){return this.state.markdownNUXVisible?b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("XUIAmbientNUX.react").__setRef("UFIAddComment.react"),bootloadPlaceholder:b("React").createElement("div",null),contextRef:function(){return this.refs.markdownButton}.bind(this),shown:this.state.markdownNUXVisible,position:"above",width:"auto",alignment:"right",onCloseButtonClick:this.$55},h._("[FB-Only] Markdown in Comments! Click to enable.")):null};I.prototype.$56=function(){return this.state.groupedInputNUXShown?b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("XUIAmbientNUX.react").__setRef("UFIAddComment.react"),bootloadPlaceholder:b("React").createElement("div",null),contextRef:function(){return this.refs.groupedInputButton}.bind(this),shown:this.state.groupedInputNUXShown,position:"above",width:"auto",alignment:"right",onCloseButtonClick:this.$27},h._("Post stickers, emojis and GIFs")):null};I.prototype.$57=function(){return this.state.addCommentNUXShown?b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("FBAmbientPulseNUX.react").__setRef("UFIAddComment.react"),bootloadPlaceholder:b("React").createElement("div",null),contextRef:function(){return this.refs.mentionsinput}.bind(this),dialogShown:!1,position:"left",shown:this.state.addCommentNUXShown}):null};I.prototype.$58=function(){return this.state.privateCommentNUXVisible?b("React").createElement(b("BootloadedComponent.react"),{alignment:"right",bootloadLoader:b("JSResource")("XUIAmbientNUX.react").__setRef("UFIAddComment.react"),bootloadPlaceholder:b("React").createElement("div",null),contextRef:function(){return this.refs.privacy_icon}.bind(this),onCloseButtonClick:this.$59,position:"above",shown:this.state.privateCommentNUXVisible,width:"auto"},b("React").createElement(b("XUIText.react"),{display:"block",weight:"bold"},h._("Comment Privately")),b("React").createElement(b("XUIText.react"),{display:"block"},h._("Add a comment that only {user} will see",[h._param("user",this.props.privateCommentTarget)]))):null};I.prototype.render=function(){__p&&__p();var a=this.props.contextArgs.loggedOutLinkConfig,c=!0;a&&a.showAddComment&&(c=!1);a=(!this.props.contextArgs.collapseaddcomment||this.state.isCommenting)&&c&&!this.props.contextArgs.hideActorPhoto;var d=null;this.props.subtitle?d=b("React").createElement("span",{className:t},this.props.subtitle):!this.state.isFocused&&this.props.isEditing?d=b("React").createElement("span",{className:t},h._("{cancel}",[h._param("cancel",b("React").createElement(b("Link.react"),{onClick:function(){return this.context.dispatch(b("UFIAddCommentAction").cancel(this.props.contextArgs))}.bind(this)},h._("Cancel")))])):this.props.isEditing?d=b("React").createElement("span",{className:t},h._("Press Esc to {cancel}.",[h._param("cancel",b("React").createElement(b("Link.react"),{onMouseDown:function(){return this.context.dispatch(b("UFIAddCommentAction").cancel(this.props.contextArgs))}.bind(this)},h._("cancel")))])):this.props.peopleOutsideCommunityInCommentNotice&&this.state.isFocused?d=b("React").createElement("div",{className:"fcg fsm _2pid"},b("React").createElement(b("Badge.react"),{key:"noncoworker",type:"work_non_coworker"}),b("React").createElement("span",{className:"_2pir _4zk5"},b("React").createElement(b("TextWithEntities.react"),{ranges:this.props.peopleOutsideCommunityInCommentNotice.ranges,text:this.props.peopleOutsideCommunityInCommentNotice.text}))):this.props.showSendOnEnterTip&&!this.props.contextArgs.isTahoeUFI&&(d=b("React").createElement("span",{className:t},h._("Press Enter to post.")));var f=null,g=null,i=null,j=null,l=null,m=this.state.attachedPhoto||this.state.attachedSticker||this.state.attachedVideo||this.state.attachedFile||this.state.attachedGIF||this.state.attachedStars,o=null,p=null,q=null,v=null,w=null,x=n?b("React").createElement(n,{ref:"groupedInputButton",allowCustomStickers:!!this.props.allowCustomStickerAttachments,allowGifAttachments:!!this.props.allowGifAttachments,allowStickerAttachments:!!this.props.allowStickerAttachments,customStickerOwnerID:this.props.targetID,flyoutShown:this.state.flyoutShown,onEmojiSelect:this.$62,onEmoticonSelect:this.$63,onGifSelect:this.$64,onLinkClick:this.$65,onStickerSelect:this.$66,toggleFlyout:this.$67}):null,y=n?null:b("React").createElement(b("EmojiInputButton.react"),{buttonClassName:"_r1a UFICommentEmojiButton",iconActiveClassName:"UFICommentEmojiIconActive",iconClassName:"UFICommentEmojiIcon",onClick:function(){return this.markViewerHasInteracted()}.bind(this),onSelect:function(a){this.refs.mentionsinput.insertEmoji(a)}.bind(this)});this.props.allowCommentMarkdown&&(j=b("React").createElement(b("UFIMarkdownButton.react"),{active:this.state.commentMarkdownEnabled,ref:"markdownButton",onClick:function(){var a=!this.state.commentMarkdownEnabled;this.setState({commentMarkdownEnabled:a});this.refs.mentionsinput&&a&&this.$24(this.refs.mentionsinput.getText())}.bind(this)}));!n&&this.props.allowStickerAttachments&&!m&&(g=b("React").createElement(b("UFIStickerButton.react"),{ref:"sticker_button",allowCustomStickers:this.props.allowCustomStickerAttachments,customStickerOwnerID:this.props.targetID,onStickerSelected:this.onStickerSelected,onEmoticonSelected:this.$68,onLinkClick:this.$69,onStickerFlyoutShow:function(){b("Arbiter").inform("comment_content_change",{addingAttachment:!0}),this.markViewerHasInteracted()}.bind(this)}));!n&&this.props.allowGifAttachments&&!m&&(i=b("React").createElement(b("UFIGifButton.react"),{ref:"gif_button",onGifSelected:this.onGifSelected,onGifFlyoutShow:function(){return this.markViewerHasInteracted()}.bind(this),defaultGifSelection:this.props.contextArgs.defaultGifQuery}));this.props.showAddMentionButton&&(l=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("UFIAddMentionsButton.react").__setRef("UFIAddComment.react"),bootloadPlaceholder:b("React").createElement("span",null),ftentidentifier:this.props.contextArgs.ftentidentifier,onMentionClicked:function(a){return this.insertMention(a)}.bind(this),onMentionFlyoutShow:function(){return this.markViewerHasInteracted()}.bind(this),callerID:"community_conversations"}));if(this.props.allowNativeTipJar&&this.props.tipJarModule){var z=this.props.tipJarModule;q=b("React").createElement(z,{showNux:!this.state.customStickerNUXShown,targetID:this.props.targetID,targetName:this.props.targetName,videoID:this.props.commentsTargetID})}if(this.props.allowFlexibleTipping&&this.props.flexibleStarsModule&&(!m||this.state.attachedStars)){z=this.props.flexibleStarsModule;v=b("React").createElement(z,{canShowNux:!this.state.customStickerNUXShown,onStarsSelected:this.onStarsSelected,targetID:this.props.targetID,targetName:this.props.targetName,videoID:this.props.commentsTargetID})}this.props.allowCommentFixSuggestions&&(w=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("UFIFixSuggestionsButton.react").__setRef("UFIAddComment.react"),bootloadPlaceholder:b("React").createElement("span",null),active:this.state.commentSuggestionsShowing,badged:this.state.hasPotentialSuggestions,ref:"fixSuggestionsButton",onClick:function(){var a=!this.state.commentSuggestionsShowing;this.setState({commentSuggestionsShowing:a});if(a){this.$17=this.refs.mentionsinput.getText();a=this.$17.length;new(b("WritingAssistanceTypedLogger"))().setAction("icon_clicked").setValue(this.state.hasPotentialSuggestions?"with_suggestions":"without_suggestions").addToExtraData("input_length",""+a).log();this.setState({hasPotentialSuggestions:!1,hasStaleSuggestions:!1,isInitialSuggestionCheck:!0})}}.bind(this)}));(this.props.allowPhotoAttachments||this.props.allowVideoAttachments||this.props.allowFileAttachments)&&(o=this.$34,f=b("React").createElement(b("UFIAttachMediaSection.react"),{ref:"media_section",getPhotoUploadData:this.$35,getFileUploadData:this.$70,prepareForAttachedPhotoPreview:this.$37,prepareForAttachedVideoPreview:this.$71,prepareForAttachedFilePreview:this.$72,allowVideoAttachments:this.props.allowVideoAttachments,allowFileAttachments:this.props.allowFileAttachments,onPhotoUploadComplete:this.$39,onFileUploadComplete:this.$73,onVideoUploadComplete:this.$74,onVideoEncodeUpdate:this.$75,onVideoUploadUpdate:this.$76,setFileInput:this.$60,targetId:this.props.targetID,onClick:function(){b("Arbiter").inform("comment_content_change",{addingAttachment:!0}),this.markViewerHasInteracted()}.bind(this),attachment:m,viewerActorID:this.props.viewerActorID}));z=b("TrackingNodes").getTrackingInfo(b("TrackingNodes").types.ADD_COMMENT_BOX);m="addComment_"+this.props.contextArgs.ftentidentifier;var B;this.$23()?B=this.props.contextArgs.replyPlaceholderText||s:this.props.contextArgs.placeholderText?B=this.props.contextArgs.placeholderText:this.props.contextArgs.isLivingRoom?B=u:B=r;var C=this.props.contextArgs.viewoptionstypeobjects,E=this.props.contextArgs.viewoptionstypeobjectsorder;this.props.attachedPhoto&&!this.props.subtitle&&(d=null);var F;(this.state.attachedPhoto||this.state.isLoadingPhoto||this.state.attachedVideo||this.state.videoStatus===A.UPLOAD||this.state.attachedFile||this.state.isLoadingFile||this.state.attachedSticker||this.state.attachedGIF||this.state.attachedStars)&&(F=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("UFIAttachedMediaPreview.react").__setRef("UFIAddComment.react"),bootloadPlaceholder:b("React").createElement("span",null),attachedPhoto:this.state.attachedPhoto,attachedVideo:this.state.attachedVideo,attachedFile:this.state.attachedFile,attachedSticker:this.state.attachedSticker,attachedGIF:this.state.attachedGIF,attachedStars:this.state.attachedStars,monitorHeight:this.props.contextArgs.monitorHeight,onRemoveAttachedMediaPreviewClicked:this.$38,onRemoveAttachedStarsPreview:this.$77,onRemoveAttachedStickerPreview:this.$78,subtitle:this.props.subtitle,isLoadingPhoto:this.state.isLoadingPhoto,isLoadingFile:this.state.isLoadingFile,videoFileURL:this.state.videoFileURL,videoStatus:this.state.videoStatus,videoTrimParams:this.state.videoTrimParams,videoProgress:this.state.videoProgress,isVideoFileTranscodedGIF:this.state.isVideoFileTranscodedGIF}));var G=this.props.contextArgs.mentionsinput,H=null,I=null,J=null;G&&(H=G.inputComponent,I=G.viewComponent,J=G.viewProps);G=this.props.editingComment.body;G=G?b("MentionsInputUtils").generateDataFromTextWithEntities(G):null;var K=null;this.props.allowCommentMarkdown&&this.state.commentMarkdownEnabled&&(K=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("UFICommentMarkdownPreview.react").__setRef("UFIAddComment.react"),bootloadPlaceholder:b("React").createElement("span",null),markup:this.state.commentMarkdownPreviewContent}));var L=null;this.props.allowCommentFixSuggestions&&this.state.commentSuggestionsShowing&&(L=b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("UFIFixSuggestionsDetails.react").__setRef("UFIAddComment.react"),bootloadPlaceholder:b("React").createElement(b("XUISpinner.react"),null),hasStaleSuggestions:this.state.hasStaleSuggestions,isInitialCheck:this.state.isInitialSuggestionCheck,onAccept:function(a,c){if(a){var d=this.refs.mentionsinput;d.replaceText(a,c)}this.setState({commentSuggestionsShowing:!1});new(b("WritingAssistanceTypedLogger"))().setAction("action_clicked").setValue("accept").log()}.bind(this),onCancel:function(){this.setState({commentSuggestionsShowing:!1}),new(b("WritingAssistanceTypedLogger"))().setAction("action_clicked").setValue("ignore").log()}.bind(this),onRefresh:function(){this.$17=this.refs.mentionsinput.getText(),this.setState({hasPotentialSuggestions:!1,hasStaleSuggestions:!1,isInitialSuggestionCheck:!1}),new(b("WritingAssistanceTypedLogger"))().setAction("action_clicked").setValue("refresh").log()}.bind(this),userText:this.$17}));H=H?b("React").createElement(H,{disableInitTextarea:!c,replyCommentID:this.$23(),initialData:G,placeholder:B,datasource:this.props.mentionsDataSource,ref:"mentionsinput",viewComponent:I,viewProps:J,viewOptionsTypeObjects:C,viewOptionsTypeObjectsOrder:E,hashtags:this.props.contextArgs.sht,autoflip:this.props.contextArgs.addcommentautoflip,monitorHeight:this.props.contextArgs.monitorHeight,onEnterSubmit:this.$43,onDummyFocus:this.$50,onFocus:this.focus,onBlur:this.$33,onContentChange:this.$22,onPaste:o,ftEntIdentifier:this.props.contextArgs.ftentidentifier,instanceID:this.props.contextArgs.instanceid,isBroadcasterUFI:this.props.contextArgs.isBroadcasterUFI,isTahoeUFI:this.props.contextArgs.isTahoeUFI,isLivingRoom:this.props.contextArgs.isLivingRoom,isStreamerHub:this.props.contextArgs.isStreamerHub,showMessengerPivot:this.state.showMessengerPivot&&!this.state.hasAttachment,updateMentionsData:this.$79}):null;c=this.state.showMessengerPivot&&!this.state.hasAttachment?b("React").createElement(b("Placeholder.react"),{fallback:b("React").createElement("div",{className:"_6fr-"})},b("React").createElement(D,{contextArgs:this.props.contextArgs,isActive:this.state.shouldSendAsMessage,isSending:this.state.isSendingMessage,onClick:this.handleMessengerPivotClick})):null;G=b("SutroStoryHeaderUFIGatingConfig").enabled_for_comment_composer_rounded_borders;B=b("SutroStoryHeaderUFIGatingConfig").enabled_for_comment_glyphs;I=k&&this.props.groupID?b("React").createElement(k,{groupID:this.props.groupID,onSelect:function(a){return this.insertMention(a)}.bind(this)}):null;J=b("React").createElement("div",{className:"UFICommentContainer"},b("React").createElement("div",{className:"_fmi"+(G?" _613v":"")+" UFIInputContainer"+(b("PrivateCommentsConfig").dark_composer_theme_enabled&&this.state.commentPrivacy===b("CommentPrivacyValue").OWNER_OR_COMMENTER?" UFIPrivateCommentDarkTheme":"")},c,H,b("React").createElement("div",{className:"_fmk"+(this.state.showMessengerPivot&&!this.state.hasAttachment?" _6fry":"")+" UFICommentAttachmentButtons _5op2"+(B?" _15i7":"")+(B?" _2kwm":"")},B?this.$80():null,w,I,l,y,j,f,i,g,x,p,q,v)),K,L,F,d);a&&(J=b("React").createElement(b("UFIImageBlock.react"),{className:"UFIMentionsInputWrap"+(this.props.allowStickerAttachments?" UFIStickersEnabledInput":"")+(this.props.allowCommentMarkdown?" UFIMarkdownEnabledInput":"")+(this.props.allowGifAttachments?" UFIGifEnabledInput":"")+(this.props.allowNativeTipJar?" UFITipJarEnabledInput":"")+(this.props.allowFlexibleTipping?" UFIFlexibleStarsEnabledInput":"")},b("React").createElement("div",{className:"UFIReplyActorPhotoWrapper"+(this.state.showMessengerPivot&&!this.state.hasAttachment?" _6fr_":""),onClick:this.focus,role:"presentation"},b("React").createElement(b("UFIActorIconContainer.react"),{actorID:this.props.viewerActorID})),J));C=b("React").createElement("div",{ref:function(a){return this.rootNode=a}.bind(this),id:m,className:b("joinClasses")("UFIRow _4oep UFIAddComment"+(this.props.allowPhotoAttachments?" UFIAddCommentWithPhotoAttacher":"")+(this.props.withoutSeparator?" UFIAddCommentWithoutSeparator":"")+(this.props.isFirstComponent?" _4204":"")+(this.props.isLastComponent?" _2o9m":"")+(this.$18()?" UFIAddCommentWithAudienceSelector":"")+(this.state.inCommercialBreak||this.state.isPlayingLiveVODHighlights?" hidden_elem":""),this.props.className),onKeyDown:this.$20,"data-ft":z},this.$81(),this.$82(),this.$83(),this.$84(),J,this.$85(),this.$53(),this.$54(),this.$56(),this.$51(),this.$57(),this.$86());E=b("ifRequired")("LiveVideoQuickComments.react",function(a){return a});o=this.props.contextArgs.liveVideoQuickCommentsConfig!=null&&E!=null?b("React").createElement(E,{contextArgs:this.props.contextArgs,videoID:this.props.contextArgs.liveVideoQuickCommentsConfig.videoID,modes:this.props.contextArgs.liveVideoQuickCommentsConfig.modes}):null;return o?b("React").createElement("div",null,o,C):C};I.prototype.componentDidUpdate=function(a,b){if(!b.attachedPhoto&&this.state.attachedPhoto||!b.attachedSticker&&this.state.attachedSticker||!b.attachedVideo&&this.state.attachedVideo||!b.attachedFile&&this.state.attachedFile||!b.attachedGIF&&this.state.attachedGIF||!b.attachedStars&&this.state.attachedStars||!b.isCommenting&&this.state.isCommenting){b=this.state.attachedPhoto||this.state.attachedVideo||this.state.attachedFile||this.state.attachedSticker||this.state.attachedGIF||this.state.attachedStars;this.setState({hasAttachment:!!b});this.refs.mentionsinput.focus()}a.viewerActorID!==this.props.viewerActorID&&(this.state.fileInput&&this.state.fileInput.clear(),this.state.fileUploader&&this.state.fileUploader.setData(this.$35()),this.$38())};I.prototype.componentDidMount=function(){__p&&__p();this.$1=!0;if(this.props.contextArgs.source===b("FeedbackSourceType").NEWS_FEED){var a=this.props.replyCommentID!=null;a?b("UFIODSLogger").bump("composer.newsfeed.replies.componentDidMount",b("UFIVersion").LEGACY):b("UFIODSLogger").bump("composer.newsfeed.toplevel.componentDidMount",b("UFIVersion").LEGACY)}this.$24=b("throttle")(this.$24,y,this);this.$12=b("Arbiter").subscribe("UFIComment/insertComposerPayload/"+this.props.contextArgs.ftentidentifier,function(a,b){if(!b||b.instanceid!==undefined&&b.instanceid!==this.props.contextArgs.instanceid||!this.props.isTopLevelComposer)return;this.focus();b.mention!==undefined&&this.insertMention(b.mention);b.emojitext!==undefined&&this.insertEmojiText(b.emojitext);b.stickerid!==undefined&&this.$87(b.stickerid)}.bind(this));this.$13=b("Arbiter").subscribe("UFIComment/"+this.props.contextArgs.ftentidentifier+"/selectGif",function(a,b){if(!b||this.$23())return;this.focus();this.setState({attachedGIF:b.gif});this.preprocessGIF(b.gif)}.bind(this));if(!this.props.allowPhotoAttachments&&!this.props.allowVideoAttachments&&!this.props.allowFileAttachments)return;this.$14=b("Arbiter").subscribe("UFIComment/"+this.props.contextArgs.ftentidentifier+"/attachCreatedGif",function(a,b){if(!b||this.$23())return;this.focus();this.setState({videoProgress:100,attachedVideo:{fbid:b.videoID},videoStatus:A.ENCODE,videoTrimParams:b.trimParams})}.bind(this));this.$23()===null&&(this.$10=b("Arbiter").subscribe("focusCommentField"+this.props.contextArgs.ftentidentifier,function(a){this.refs.mentionsinput.focus()}.bind(this)),this.props.contextArgs.issnowlift&&(this.$11=b("Arbiter").subscribe("newRemixedImage"+this.props.contextArgs.ftentidentifier,function(a,b){var event={clipboardData:{items:[b]}};this.$34(event)}.bind(this))))};I.prototype.$18=function(){return!!this.props.allowAudienceSelector&&b("CommentPrivacyUtils").getTreatment(this.props.contextArgs,this.props.viewerActorID)===b("PrivateConversationsTreatment").FRIEND_CONVERSATIONS};I.prototype.$19=function(){var a=this.props.contextArgs.friendConversationsParams||{},c=a.selectedCommentPrivacyValue,d=a.friendsOnlyPrivacyEnabled;a=a.friendsAndPagePrivacyEnabled;if(c===b("CommentPrivacyValue").DEFAULT_PRIVACY||c===b("CommentPrivacyValue").FRIENDS_ONLY||c===b("CommentPrivacyValue").FRIENDS_AND_POST_OWNER)return c;if(d)return b("CommentPrivacyValue").FRIENDS_ONLY;return a?b("CommentPrivacyValue").FRIENDS_AND_POST_OWNER:b("CommentPrivacyValue").DEFAULT_PRIVACY};I.prototype.$83=function(){return this.state.constituentBannerState&&!this.$23()?b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("UFICommentingAsConstituentHeader.react").__setRef("UFIAddComment.react"),bootloadPlaceholder:b("React").createElement("div",null),uri:this.props.constituentBanner}):null};I.prototype.$82=function(){return this.$18()?b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("UFICommentAudienceSelector.react").__setRef("UFIAddComment.react"),bootloadPlaceholder:b("React").createElement("div",null),contextArgs:this.props.contextArgs,onSelectionChanged:this.$61,selectedPrivacyValue:this.state.commentPrivacy}):null};I.prototype.$81=function(){var a=this.props,c=a.contextArgs,d=a.isTopLevelComposer;a=a.isLastComponent;var e=c.conversationGuideParams;if(!e)return null;var f=e.location;return d&&(!a&&f===b("ConversationGuideRenderLocation").ABOVE_OR_BELOW_COMPOSER||f===b("ConversationGuideRenderLocation").ABOVE_COMPOSER)?b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("UFIConversationGuideRow.react").__setRef("UFIAddComment.react"),position:"above",conversationGuideParams:e,contextArgs:c,ufiContextDispatch:this.context.dispatch,bootloadPlaceholder:b("React").createElement("span",null),isComposerFocused:this.state.isFocused}):null};I.prototype.$85=function(){var a=this.props,c=a.contextArgs,d=a.isTopLevelComposer;a=a.isLastComponent;var e=c.conversationGuideParams,f=c.ftentidentifier;c=c.instanceid;if(!e)return null;var g=e.location;return d&&(a&&g===b("ConversationGuideRenderLocation").ABOVE_OR_BELOW_COMPOSER||g===b("ConversationGuideRenderLocation").BELOW_COMPOSER)?b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("UFIConversationGuideRow.react").__setRef("UFIAddComment.react"),position:"below",conversationGuideParams:e,ftentidentifier:f,instanceid:c,bootloadPlaceholder:b("React").createElement("span",null),isComposerFocused:this.state.isFocused}):null};I.prototype.$80=function(){var a=this.props.isEditing&&this.props.editingComment.privacy_value===b("CommentPrivacyValue").OWNER_OR_COMMENTER,c=this.$23()&&this.props.replyCommentPrivacy===b("CommentPrivacyValue").OWNER_OR_COMMENTER,d=!a&&!c&&this.props.allowTogglePrivateComments;if(!a&&!c&&!this.props.allowTogglePrivateComments||!(d?b("PrivateCommentsConfig").composer_lock_enabled||b("PrivateCommentsConfig").composer_unlocked_lock_enabled:b("PrivateCommentsConfig").reply_composer_lock_enabled))return null;d?(b("Bootloader").loadModules(["PrivateCommentsLogger"],function(a){return a.startFunnel(this.props.contextArgs.ftentidentifier)}.bind(this),"UFIAddComment.react"),a=h._("Toggle Privacy")):c?a=h._("Only you and {user} will be able to see your reply",[h._param("user",this.props.privateCommentTarget)]):a=h._("Only you and {user} can see this",[h._param("user",this.props.privateCommentTarget)]);return b("React").createElement(b("Link.react"),{"aria-label":a,className:"_r1a UFICommentPrivacyButton","data-hover":"tooltip","data-tooltip-alignh":"center","data-tooltip-content":a,onClick:function(){this.markViewerHasInteracted(),d&&(o.logToggle(this.state.commentPrivacy===b("CommentPrivacyValue").DEFAULT_PRIVACY,this.props.contextArgs.ftentidentifier),this.setState(function(a){return{commentPrivacy:a.commentPrivacy===b("CommentPrivacyValue").OWNER_OR_COMMENTER?b("CommentPrivacyValue").DEFAULT_PRIVACY:b("CommentPrivacyValue").OWNER_OR_COMMENTER}}))}.bind(this),role:"button"},b("React").createElement("div",{ref:"privacy_icon",className:"UFICommentPrivacyIcon"+(b("PrivateCommentsConfig").composer_unlocked_lock_enabled?" UFICommentPrivacyIconVariant":"")+(!d||this.state.commentPrivacy===b("CommentPrivacyValue").OWNER_OR_COMMENTER?" UFICommentPrivacyIconActive":"")}),d?this.$58():null)};I.prototype.$84=function(){return this.props.isEditing||this.state.commentPrivacy!==b("CommentPrivacyValue").OWNER_OR_COMMENTER||!b("PrivateCommentsConfig").privacy_text_above_composer_enabled?null:this.$23()?b("React").createElement("div",{className:"_2tpi"},h._("Replying privately to {=[user]}",[h._param("=[user]",b("React").createElement("strong",null,h._("{user}",[h._param("user",this.props.privateCommentTarget)])))])):b("React").createElement("div",{className:"_2tpi"},h._("Only you and {=[user]} can see this",[h._param("=[user]",b("React").createElement("strong",null,h._("{user}",[h._param("user",this.props.privateCommentTarget)])))]))};I.prototype.$86=function(){return this.state.showFailedMessageDialog?b("React").createElement(b("Placeholder.react"),{fallback:b("React").createElement("div",null)},b("React").createElement(E,{contextArgs:this.props.contextArgs,onHide:function(){this.setState({showFailedMessageDialog:!1}),this.refs.mentionsinput.focus()}.bind(this),showFailedDialog:this.state.showFailedMessageDialog})):null};I.prototype.insertMention=function(a){this.refs.mentionsinput&&this.refs.mentionsinput.insertMention&&(this.refs.mentionsinput.insertMention(a),setTimeout(function(){return this.refs.mentionsinput.focus()}.bind(this)))};I.prototype.insertEmojiText=function(a){this.refs.mentionsinput.insertEmoticon(a)};I.prototype.$88=function(a){return a==="finish"};I.prototype.$89=function(){this.state.fileInput&&this.state.fileInput.clear()};I.prototype.$87=function(a){this.setState({attachedSticker:null,isLoadingPhoto:!0}),new(b("AsyncRequest"))(x).setData({sticker_id:a}).setErrorHandler(this.$78).setHandler(this.$90).send()};I.prototype.sendSticker=function(a,event){a={encodedValue:"",visibleValue:"",attachedPhoto:null,attachedSticker:{fbid:a},privacy_value:this.state.commentPrivacy};this.context.dispatch(b("UFIAddCommentAction").submitNew(this.props.contextArgs,a,event.target,this.$23()))};I.prototype.$91=function(){this.setState({gifsInCommentsNUXVisible:!1})};I.prototype.$48=function(){this.setState({addCommentNUXShown:!1})};I.prototype.preprocessGIF=function(a){var c=b("XUFICommentGIFPreprocessController").getURIBuilder().getURI();new(b("AsyncRequest"))(c).setData({gif_url:a.source.url}).send()};I.prototype.sendGIF=function(a){a={encodedValue:"",visibleValue:"",attachedShareURL:a.source.url,privacy_value:this.state.commentPrivacy};this.rootNode&&this.context.dispatch(b("UFIAddCommentAction").submitNew(this.props.contextArgs,a,this.rootNode,this.$23()))};I.prototype.parseTextForMentions=function(a){var b=[],c;while(c=C.exec(a)){c={uid:c[1],text:c[2],offset:c.index,length:c[2].length,weakreference:!1,entity:{uid:c[1],weakreference:!1}};b.push(c);C.lastIndex=c.offset+c.length}return b};I.prototype.markViewerHasInteracted=function(){this.props.markViewerHasInteracted&&this.props.markViewerHasInteracted()};I.prototype.$23=function(){return this.props.replyCommentID||this.state.currentThreadedFacecastCommentID};I.contextTypes={dispatch:c.func};e.exports=I}),null);
__d("UFIAddCommentLink.react",["cx","fbt","React","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;i=babelHelpers.inherits(a,b("React").Component);i&&i.prototype;a.prototype.render=function(){var a=b("joinClasses")("UFIRow UFIAddCommentLink"+(this.props.isFirstCommentComponent?" _48pi":"")+(this.props.isLastCommentComponent?" UFILastCommentComponent":"")+(this.props.isFirstComponent?" _4204":"")+(this.props.isLastComponent?" _2o9m":"")),c=h._("Write a comment...");return b("React").createElement("div",{className:a,"data-ft":this.props["data-ft"]},b("React").createElement("a",{className:"UFICommentLink",onClick:this.props.onClick,href:"#",role:"button"},c))};function a(){i.apply(this,arguments)}e.exports=a}),null);
__d("IdentityBadges.react",["cx","AsyncRequest","IdentityBadgeType","Image.react","Link.react","React","XIdentityBadgesInfomationDialogController"],(function(a,b,c,d,e,f,g){__p&&__p();var h,i=12;c=babelHelpers.inherits(a,b("React").Component);h=c&&c.prototype;function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.$1=function(){var a=b("XIdentityBadgesInfomationDialogController").getURIBuilder().setString("badges",JSON.stringify(this.props.badges)).getURI();a=new(b("AsyncRequest"))().setURI(a).setMethod("POST").setReadOnly(!0);a.send()}.bind(this),c}a.prototype.render=function(){"use strict";var a=this.props.badges;if(!Array.isArray(a)||a.length===0)return null;var c=a.find(function(a){return a.type===b("IdentityBadgeType").TOP_FAN});c=c||a[0];a=a.length===1?null:" +"+(a.length-1);return b("React").createElement(b("Link.react"),{onClick:this.$1},b("React").createElement("div",{className:"_3x69"},b("React").createElement(b("Image.react"),{className:"_3-8_",height:i,src:c.badge_asset}),b("React").createElement("span",{className:"_3x6z"},c.text,a)))};e.exports=a}),null);
__d("LiveVideoPinnedCommentUtils",["fbt","AsyncRequest","BanzaiODS","Bootloader","UFILivePinnedCommentStore","UFISharedDispatcher","UFIStoryAction","UFIVideoPlayerRegistry","XVideoBroadcastClearPinCommentEventAsyncController","XVideoBroadcastPinnedCommentsController","ifRequired"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();function h(){return b("ifRequired")("LiveVideoBroadcastBroadcastStore",function(a){return a.getCurrentBroadcastTime()})}a={toggleCommentPin:function(a){__p&&__p();var c=a.commentFBID,d=a.commentID,e=a.contextArgs;a=a.isPinned;var f=b("UFILivePinnedCommentStore").getPinnedCommentID(e.ftentidentifier);a?b("UFISharedDispatcher").dispatch(b("UFIStoryAction").unpinComment(e)):b("UFISharedDispatcher").dispatch(b("UFIStoryAction").pinComment(e,d));d=e.isBroadcasterUFI?h():b("UFIVideoPlayerRegistry").getAvailableVideoPlayerControllerTime(e.instanceid);if(d===null){b("BanzaiODS").bumpEntityKey("streaming_comments","pin_with_no_timestamp");return}var g=b("XVideoBroadcastPinnedCommentsController").getURIBuilder().getURI();new(b("AsyncRequest"))().setURI(g).setData({video_id:e.fluentContentToken,video_time_offset:d,comment_fbid:a?null:c}).setMethod("POST").setErrorHandler(function(a){f?b("UFISharedDispatcher").dispatch(b("UFIStoryAction").pinComment(e,f)):b("UFISharedDispatcher").dispatch(b("UFIStoryAction").unpinComment(e))}).send()},unpinVODComment:function(a,c,d){return b("Bootloader").loadModules(["SimpleXUIDialog"],function(e){e.showConfirm(g._("If you unpin this comment, you won't be able to pin it again."),g._("Unpin Comment"),function(e){if(!e)return;new(b("AsyncRequest"))().setURI(b("XVideoBroadcastClearPinCommentEventAsyncController").getURIBuilder().getURI()).setData({pin_event_id:c}).setMethod("POST").setHandler(function(c){a===b("UFILivePinnedCommentStore").getPinnedCommentID(d.ftentidentifier)&&b("UFISharedDispatcher").dispatch(b("UFIStoryAction").unpinComment(d))}).send()})},"LiveVideoPinnedCommentUtils")}};e.exports=a}),null);
__d("UFIAddReactionButton.react",["ix","cx","Image.react","React","asset"],(function(a,b,c,d,e,f,g,h){"use strict";var i;i=babelHelpers.inherits(a,b("React").PureComponent);i&&i.prototype;a.prototype.render=function(){return b("React").createElement("div",{className:"_6fy0"},b("React").createElement("span",{className:"_6fva"},"+"),b("React").createElement(b("Image.react"),{src:g("601195")}))};function a(){i.apply(this,arguments)}e.exports=a}),null);
__d("UFIThreadedFacecastCommentsUtils",["Bootloader","FeedbackSourceType","UFISharedDispatcher","UFIStoryAction","UFIVideoPlayerControllerStore"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={isEnabled:function(a){a=a.liveVideoThreadedCommentsConfig;return!!(a&&a.enable_replies)},onReplyClickCallback:function(a,c,d){__p&&__p();var e=c.source;if(e===b("FeedbackSourceType").TAHOE||e===b("FeedbackSourceType").LIVE_VIDEO_STORIES||e===b("FeedbackSourceType").LIVE_WWW_BROADCASTING)return function(){(d.isthreaded&&a.cancomment||!!a.parentcommentid)&&b("UFISharedDispatcher").dispatch(b("UFIStoryAction").showFacecastReplies(c,a.parentcommentid||a.id))};else{var f=b("UFIVideoPlayerControllerStore").getVideoPlayerController(c.instanceid);if(!f)return null;var g=f.getVideoURL();return g==null?null:function(){b("Bootloader").loadModules(["TahoeController","URI"],function(b,c){c=new c(g).setQueryData({comment_id:a.fbid,ref:"tahoe"});b.openFromVideoPlayer(f,c,null,null,"live_video_reply_click",f.getPlayerOrigin(),f.getPlayerSuborigin())},"UFIThreadedFacecastCommentsUtils")}}}};e.exports=a}),null);
__d("LitestandShareAttachment",["csx","cx","CSS","DOMQuery","LitestandEllipsis","SutroLinkAttachmentsGatingConfig","queryThenMutateDOM"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i=16,j=22,k=20,l=5,m=3,n=3,o=2,p=2,q=5,r=5,s="_5qqr",t="_6m2",u=20,v=20,w=2;function x(a){return b("CSS").matchesSelector(a,"._59ap")}function y(a){return b("CSS").matchesSelector(a,"._5ej3")}function z(a){return b("CSS").matchesSelector(a,"._pb2")}function A(a){return b("CSS").matchesSelector(a,"._1-9r")}function B(a){return b("CSS").matchesSelector(a,"._61bj")}function C(a,c){a=a.getElementsByTagName?b("DOMQuery").scry(a,c)[0]:null;return a?a:null}function D(a){return!!C(a,"^div._4rtc")}function E(a){return C(a,"._59tj")}function F(a){return C(a,"._6m6")}function G(a){return C(a,"._6m7")}function H(a){return C(a,"._6m3")}function I(a){__p&&__p();if(z(a))return p;else if(D(a))return o;else if(x(a))if(A(a))return w;else return m;else if(y(a))return n;else return l}function J(a,b,c){__p&&__p();var d=H(a);if(!b||!d||B(a))return 0;var e=E(a),f=x(a),g=z(a),h=Math.round(b.scrollHeight/K(a));if(x(a)&&A(a))if(h==w)return 0;else return Math.max(w-h,0);if(h>c&&!g)return 0;a=d.offsetHeight-q-b.offsetHeight-(e?e.offsetHeight:0)-(f?0:r)+1;return Math.floor(Math.max(a,0)/L())}function K(a){if(b("SutroLinkAttachmentsGatingConfig").enabled)return z(a)?v:j;else return z(a)?k:j}function L(){return b("SutroLinkAttachmentsGatingConfig").enabled?u:i}a={getSimpleCropClass:function(){return s},_truncateText:function(a,c){var d,e,f,g=I(a);b("queryThenMutateDOM")(function(){d=F(a),e=G(a),f=J(a,d,g)},function(){if(!a.offsetHeight){c&&b("CSS").addClass(a,s);return}!f?(e&&b("CSS").hide(e),d&&b("LitestandEllipsis").add(d,g*K(a))):e&&f&&(b("CSS").show(e),b("LitestandEllipsis").add(e,f*L()))})},getDetailsBreakingNewsPlaceholder:function(a){a=this.getDetailsFooterBrandName(a);if(!a)return null;var b=C(a.parentNode,"div._3vkw");b||(b=document.createElement("div"),b.className="clearfix _3vkw",a.parentNode.insertBefore(b,a));return b},getBreakingBanner:function(a){a=C(a,"div.___a");return a},getDetailsFooterBrandName:function(a){a=C(a,"div._59tj");return!a?null:C(a,"div._6lz")},getDetailsFooterForBreaking:function(a){return C(a,"div._59tj")},getTitleNode:function(a){return C(a,"div._6m6")},getContentNode:function(a){return C(a,"div._6m3")},init:function(a,c){__p&&__p();if(b("CSS").hasClass(a,s)){var d=!1;b("queryThenMutateDOM")(function(){a.offsetHeight&&(d=!0)},function(){d?(b("CSS").removeClass(a,s),this._truncateText(a,!0)):c||setTimeout(function(){return this.init(a,!0)}.bind(this),300)}.bind(this));return}else{var e=b("CSS").hasClass(a,t);this._truncateText(a,e)}},getNumDescriptionLines:function(a){return J(a,F(a),I(a))},getDescriptionLineHeight:function(){return L()}};e.exports=a}),null);
__d("HovercardLinkInterpolator",["cx","fbt","Badge.react","CommentMentionsGatingConfig","HovercardLink","Link.react","React","UFIActorIconContainer.react","URI","isFacebookURI","isRTL"],(function(a,b,c,d,e,f,g,h){__p&&__p();function a(a,c,d,e,f,g){__p&&__p();g===void 0&&(g=null);c=c.entity;d=d||(c.external?"_blank":null);var i=(c.external?"":"profileLink")+(c.weakreference?" weakReference":""),j=c.hashtag?a.substring(1):a;j=b("isRTL")(j)?"rtl":"ltr";var k=new(b("URI"))(c.url);b("isFacebookURI")(k)&&k.addQueryData({hc_location:f});var l=c.shimhash?c.shimhash:null,m=!c.external&&!c.hashtag&&!c.photo&&!c.note&&!c.statusupdate&&!c.video;m=m?{"data-hovercard":b("HovercardLink").constructEndpointWithGroupLocationAndExtraParams(c,e,c.hovercardlocation?c.hovercardlocation:f,null,g).toString()}:{};if(c.hashtag)e=b("React").createElement("a",babelHelpers["extends"]({},m,{className:"_58cn",dir:j,href:k.toString(),target:d}),b("React").createElement("span",{"aria-label":h._("hashtag"),className:"_58cl"},a.substring(0,1)),b("React").createElement("span",{className:"_58cm"},a.substring(1)));else if(c.type==="user"&&b("CommentMentionsGatingConfig").enabled_rich_comment_mentions)e=b("React").createElement("div",{className:"_35mm"},b("React").createElement(b("Link.react"),babelHelpers["extends"]({},m,{className:i,dir:j,href:{url:k.toString(),shimhash:l},target:d}),b("React").createElement("span",{className:"_35mo"},b("React").createElement("span",{className:"_35mp"},b("React").createElement(b("UFIActorIconContainer.react"),{actorID:c.id.toString(),tinyIcon:!0})),b("React").createElement("span",{className:"_35mq"},a))));else{f=[];c.weakreference&&f.push(b("React").createElement("i",{key:"weakreference",className:"UFIWeakReferenceIcon"}));f.push(a);c.workForeignEntity&&f.push(b("React").createElement(b("Badge.react"),{key:"noncoworker",type:"work_non_coworker"}));c.dialogurl?e=b("React").createElement(b("Link.react"),babelHelpers["extends"]({},m,{className:i,dir:j,ajaxify:c.dialogurl,rel:"dialog",href:{url:k.toString(),shimhash:l},target:d}),f):e=b("React").createElement(b("Link.react"),babelHelpers["extends"]({},m,{className:i,dir:j,href:{url:k.toString(),shimhash:l},target:d}),f)}return e}e.exports=a}),null);
__d("TextDelightRange.react",["cx","Bootloader","CommentPrivacyValue","PrivateCommentsConfig","React","SubscriptionsHandler","TextDelightSurface","createObjectFrom"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=babelHelpers.inherits(a,b("React").PureComponent);h=c&&c.prototype;function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=h.constructor).call.apply(a,[this].concat(e)),this.$2=!1,this.$3=new(b("SubscriptionsHandler"))(),c}a.prototype.componentDidMount=function(){this.$2=!0,this.props.campaignID&&b("Bootloader").loadModules(["TextDelightController"],function(a){if(this.$2===!1)return;this.$3.addSubscriptions(a.attachClickListener(this.$1,this.props.campaignID,b("TextDelightSurface").COMMENT))}.bind(this),"TextDelightRange.react")};a.prototype.componentWillUnmount=function(){this.$2=!1,this.$3.release()};a.prototype.render=function(){__p&&__p();var a=this.props.delightStyles.filter(function(a){a=a.style;return a!=null&&!(a==="color"&&this.props.commentPrivacy===b("CommentPrivacyValue").OWNER_OR_COMMENTER&&b("PrivateCommentsConfig").dark_comment_theme_enabled)}.bind(this));return b("React").createElement("span",{className:"_ezo _6rsx",style:b("createObjectFrom")(a.map(function(a){a=a.style;return a.replace(/-([a-z])/gi,function(a,b){return b.toUpperCase()})}),a.map(function(a){a=a.value;return a?a.replace("bold","600"):a})),ref:function(a){this.$1=a}.bind(this)},this.props.children)};e.exports=a}),null);
__d("UFICommentUtils",["HovercardLinkInterpolator","React","TextDelightRange.react","UFIConstants","UFIVideoPlayerRegistry","URI","URITruncator","VideoTimestampsClicksWWWTypedLogger","transformTextRanges"],(function(a,b,c,d,e,f){"use strict";__p&&__p();a={getCommentTextWithTruncatedURIs:function(a,c){b("UFIConstants").commentURLTruncationLength&&(a&&a.length>0&&(c=b("transformTextRanges")(c,a,function(a,c){c=c.entity&&(c.entity.external||c.entity.__typename==="ExternalUrl");return c?b("URITruncator")(a,b("UFIConstants").commentURLTruncationLength):a})));return c},getCommentBodyInterpolator:function(a,c,d,e,f){__p&&__p();return function(g,h){__p&&__p();if(h.videoTimestamp){if(e)return b("React").createElement("span",null,h.entity);var i=function(a){a.preventDefault();new(b("VideoTimestampsClicksWWWTypedLogger"))().setVideoTimestamp(h.integerTimestamp).setCommentID(d).setIsContentTimestamp(!1).log();c&&(b("UFIVideoPlayerRegistry").seekAvailableVideoPlayerController(c,h.integerTimestamp),b("UFIVideoPlayerRegistry").scrollToAvailableVideo(c));return!1};return b("React").createElement("a",{className:"TimestampLink",onClick:i,href:"#"},h.entity)}else if(h.sphericalViewport){i=function(a){a.preventDefault();c&&b("UFIVideoPlayerRegistry").setAvailableVideoPlayerControllerSphericalViewport(c,{yaw:h.yaw,pitch:h.pitch});return!1};return b("React").createElement("a",{onClick:i,href:"#"},h.entity)}else if(h.sphericalViewportAndTimestamp){i=function(a){a.preventDefault();c&&(b("UFIVideoPlayerRegistry").setAvailableVideoPlayerControllerSphericalViewport(c,{yaw:h.yaw,pitch:h.pitch}),b("UFIVideoPlayerRegistry").seekAvailableVideoPlayerController(c,h.integerTimestamp));return!1};return b("React").createElement("a",{onClick:i,href:"#"},h.entity)}else if(h.campaign)return b("React").createElement(b("TextDelightRange.react"),{campaignID:h.campaign.id,commentPrivacy:f||undefined,delightStyles:h.campaign.delight_styles},g);else return b("HovercardLinkInterpolator")(g,h,"_blank",a,"ufi")}},shallowCopyRanges:function(a){if(!a)return a;var b=[];a.forEach(function(a){b.push(babelHelpers["extends"]({},a))});return b},annotateProfileURIIfPublic:function(a,c){return!a?c:new(b("URI"))(c).addQueryData("rc","p").toString()},shouldShowTranslateAll:function(a,b,c,d){__p&&__p();if(!a)return!1;var e=0,f,g;for(var h=0;h<a.length;h++){f=a[h];f.istranslatable&&!f.translationdata&&!d[f.id]&&e++;if(e>1)return!0;if(c[f.id]){g=b?b[f.id]:[];for(var i=0;i<g.length;i++){f=g[i];f.istranslatable&&!f.translationdata&&!d[f.id]&&e++;if(e>1)return!0}}}return!1}};e.exports=a}),null);
__d("UFIActor.react",["cx","fbt","Badge.react","Focus","HovercardLink","Image.react","Locale","React","ReactDOM","UFICommentUtils","UserHovercardLocation"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;i=babelHelpers.inherits(a,b("React").Component);i&&i.prototype;a.prototype.componentDidMount=function(){this.props.focusOnMount&&b("Focus").setWithoutOutline(b("ReactDOM").findDOMNode(this.refs.authorName))};a.prototype.render=function(){__p&&__p();var a=this.props.author,c=b("Locale").isRTL()?"rtl":"ltr",d=(this.props.isAuthorWeakReference?"weakReference":"")+" UFICommentActorName",e=[];this.props.isAuthorWeakReference&&e.push(b("React").createElement("i",{className:"UFIWeakReferenceIcon",key:"icon"}));this.props.author.badgeSrc&&this.props.author.badgeSrc.length>0&&e.push(b("React").createElement("span",null,b("React").createElement(b("Badge.react"),{type:"subscription",size:"medium",key:"badge"})," "));a.persona?e.push(h._("{author} ({persona})",[h._param("author",a.firstName),h._param("persona",a.persona)])):this.props.useFirstName?e.push(a.firstName):this.props.author.isBusinessPersona&&this.props.author.assetRole?e.push(a.name+" "+h._("(")+this.props.author.assetRole+h._(")")):e.push(a.name);this.props.isAuthorNonCoworker?e.push(b("React").createElement(b("Badge.react"),{key:"noncoworker",type:"work_non_coworker"})):this.props.isAuthorBot&&e.push(b("React").createElement(b("Badge.react"),{key:"bot",type:"bot"}));var f=this.props.customGlyphTag;f&&f.glyph&&e.push(b("React").createElement(b("Image.react"),{className:f.classname,key:"customglyphtag",src:f.glyph,alt:f.description,title:f.description}));f=this.props.isAdminViewer?b("UserHovercardLocation").UFI_ADMIN:b("UserHovercardLocation").UFI;var g=Object.assign({},this.props);delete g.author;delete g.customGlyphTag;delete g.delimiter;delete g.dialogUrl;delete g.disableAuthorLink;delete g.focusOnMount;delete g.groupOrEventID;delete g.hovercardLocation;delete g.isAdminViewer;delete g.isAuthorBot;delete g.isAuthorNonCoworker;delete g.isAuthorWeakReference;delete g.isPublic;delete g.showHovercard;delete g.useFirstName;f=this.props.showHovercard?b("HovercardLink").constructEndpointWithGroupLocationAndExtraParams(a,this.props.groupOrEventID,this.props.hovercardLocation?this.props.hovercardLocation:f,this.props.isAuthorWeakReference,{is_public:this.props.isPublic}).toString():null;var i=a.uri&&!this.props.disableAuthorLink;a=i?b("UFICommentUtils").annotateProfileURIIfPublic(!!this.props.isPublic,a.uri):null;i=i?b("React").createElement("a",babelHelpers["extends"]({},g,{className:d,"data-hovercard":f,"data-ft":this.props["data-ft"],dir:c,href:a,ref:"authorName"}),e):b("React").createElement("span",{className:d,dir:c,ref:"authorName"},e);this.props.dialogUrl&&(i=b("React").createElement("a",babelHelpers["extends"]({},g,{className:d,"data-hovercard":f,"data-ft":this.props["data-ft"],dir:c,ajaxify:this.props.dialogUrl,rel:"dialog",href:a,ref:"authorName"}),e));return b("React").createElement("span",null,i,b("React").Children.map(this.props.children,function(a){return a?[a.key==="badge"||a.key==="constituentTitle"||a.key==="neighborBadge"||a.key==="moderatorBadge"||a.key==="friendsOnlyBadge"?"":this.props.delimiter,a]:null}.bind(this)))};function a(){i.apply(this,arguments)}a.defaultProps={delimiter:" \xb7 ",isAdminViewer:!1,isPublic:!1};e.exports=a}),null);
__d("UFICommentVPVDLogging",["csx","Banzai","Parent","UFICommentVPVDLoggingConfig","UFILiveStreamingViewerLoggerCommentLocation","UFIOrderingModeStore","UFIStopWatch","UFIStreamingCommentsMode","WebCommentViewOption"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();function a(a){__p&&__p();var c=a.renderedComment,d=c.comment,e=c.isLivePinnedComment;c=c.isInLiveVideoReplyMode;var f=a.contextArgs,g=a.node;a=a.stopWatch;if(a.state()===b("UFIStopWatch").COUNTING)return{state:"still visible - not logged",instanceid:f.instanceid,fbid:d.fbid,duration_ms:a.milliseconds()};var h=a.milliseconds();if(h>=0&&h<b("UFICommentVPVDLoggingConfig").minDurationToLog)return{state:"small duration - not logged",instanceid:f.instanceid,fbid:d.fbid,duration_ms:h};var i=null,j=null;if(g){g=b("Parent").byClass(g,"public/feedobject/root");if(g){var k=g.getAttribute("data-ft");k&&(i=JSON.parse(k));j=g.getAttribute("data-referrer")}}k=b("UFIOrderingModeStore").getState().get(f.instanceid);g=b("UFIStreamingCommentsMode").NONE;k===b("WebCommentViewOption").LIVE_STREAMING&&(f.islivestreaming?g=b("UFIStreamingCommentsMode").LIVE:f.isLiveVOD&&(g=b("UFIStreamingCommentsMode").ON_DEMAND));e={comment_fbid:d.fbid,comment_id:d.id,container_module:f.location,duration_ms:h,is_live_pinned_comment:e,is_on_sponsored_story:!!f.isSponsored,is_page_comment:!!f.isPage,is_reply:!!d.parentcommentid,mf_story_key:i?i.mf_story_key:null,order_mode:k,qid:i?i.qid:null,referrer_source:j,streaming_comments_mode:g,streaming_comment_location:c?b("UFILiveStreamingViewerLoggerCommentLocation").ACTIVE_REPLY_THREAD:b("UFILiveStreamingViewerLoggerCommentLocation").ACTIVE_MAIN_THREAD};a.reset();b("Banzai").post("comment_vpvd",e);return babelHelpers["extends"]({state:"logged",instanceid:f.instanceid,fbid:d.fbid,duration_ms:h},e)}e.exports={log:a}}),null);
__d("UFICommentVPVDState",["invariant","Arbiter","Parent","UFICommentVisibilityStore","UFICommentVPVDLogging","UFICommentVPVDLoggingConfig","UFIRootRegistry","UFIStopWatch","UFIVisibility","UserActivity","ViewportTrackingHelper","getActiveElement","gkx"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h=Object.freeze({INFOCUS:"INFOCUS",BLURRED_NEW:"BLURRED_NEW",BLURRED_INACTIVE:"BLURRED_INACTIVE",BLURRED_SNOWLIFT_OTHER:"BLURRED_SNOWLIFT_OTHER",BLURRED_UNDER_LAYER:"BLURRED_UNDER_LAYER",BLURRED_NO_NODE:"BLURRED_NO_NODE"}),i="changed",j=new(b("Arbiter"))(),k=null,l=!1,m=!1,n={};function o(a){if(!b("gkx")("AT7ImPMHuxZIJZ136ME7VyraMwtCKryQmyrFHtgzHkf8ddy4a6_xWA51xIkynmusmXrOGBFVkNSaxGsbLCgQTZHL"))return;!1;console.table&&console.table([{isFocusInLayer:l,isSnowliftOpen:m,userIsActive:b("UserActivity").isActive(b("UFICommentVPVDLoggingConfig").idleTimeout)}]);console.table&&console.table(Object.keys(n).map(function(a){a=n[a];return{instanceID:a.contextArgs.instanceid,fbid:a.renderedComment.comment.fbid,state:a.state,visibility:a.visibility,counting:a.stopWatch.state()}}))}function p(a){var b=Object.keys(a);if(!b.length)return;b.forEach(function(b){return r(a[b])});n=babelHelpers["extends"]({},n,a);j.inform(i)}function q(a,b){var c;p((c={},c[a]=b,c))}function r(a){a.visibility==b("UFIVisibility").VISIBLE&&a.state==h.INFOCUS?a.stopWatch.start():a.stopWatch.pause()}function s(a){__p&&__p();if(!b("UserActivity").isActive(b("UFICommentVPVDLoggingConfig").idleTimeout))return h.BLURRED_INACTIVE;if(l&&!m){if(!a.node)return h.BLURRED_NO_NODE;if(!k)return h.BLURRED_UNDER_LAYER;a.node||g(0,undefined);k||g(0,undefined);var c=b("ViewportTrackingHelper").isDescendantOf(a.node,k);return c?h.INFOCUS:h.BLURRED_UNDER_LAYER}if(m)if(b("UFIRootRegistry").isSnowliftNode(a.contextArgs.rootid))return h.INFOCUS;else return h.BLURRED_SNOWLIFT_OTHER;return h.INFOCUS}var t={subscribe:function(a){return j.subscribe(i,a)},unsubscribe:function(a){j.unsubscribe(a)},getState:function(){return n},getKey:function(a,b){return b.instanceid+"/"+a.comment.fbid+(a.isLivePinnedComment?"/P":"")+(a.isInLiveVideoReplyMode?"/R":"")},initComment:function(a,c,d){var e=t.getKey(a,c),f=n[e];if(!f&&!d)return;else if(!f){c={renderedComment:a,contextArgs:c,node:d,state:h.BLURRED_NEW,stopWatch:new(b("UFIStopWatch"))(),visibility:b("UFICommentVisibilityStore").getVisibility(b("UFICommentVisibilityStore").getState(),c,a)};c.state=s(c);q(e,c)}else!d?(f.stopWatch.pause(),q(e,babelHelpers["extends"]({},f,{state:h.BLURRED_NO_NODE}))):q(e,babelHelpers["extends"]({},f,{node:d,state:s(f)}))},updateAllStates:function(a){p(Object.keys(n).reduce(function(a,b){a[b]=babelHelpers["extends"]({},n[b],{state:s(n[b])});return a},{})),o(a)},cleanupUFIInstance:function(a){var c=[],d=b("gkx")("AT7ImPMHuxZIJZ136ME7VyraMwtCKryQmyrFHtgzHkf8ddy4a6_xWA51xIkynmusmXrOGBFVkNSaxGsbLCgQTZHL");Object.keys(n).filter(function(b){return n[b].contextArgs.instanceid==a}).forEach(function(a){n[a].stopWatch.pause();var e=b("UFICommentVPVDLogging").log(n[a]);d&&c.push(e);delete n[a]});d&&(!1,console.table&&console.table(c))},onCommentVisibilityChanged:function(){__p&&__p();var a=b("UFICommentVisibilityStore").getState();p(Object.keys(n).reduce(function(c,d){var e=n[d],f=e.renderedComment,g=e.contextArgs;e=e.visibility;g=b("UFICommentVisibilityStore").getVisibility(a,g,f);f=e!=g;if(!f)return c;c[d]=babelHelpers["extends"]({},n[d],{visibility:g});return c},{}));o("UFICommentVisibilityStore.changed")},onClickDocument:function(){var a=b("getActiveElement")();!a?(k=null,l=!1):(k=b("Parent").byClass(a,"uiContextualLayerParent"),l=!!k)},onSnowliftOpen:function(){m=!0},onSnowliftClose:function(){m=!1},debug:function(){o("debug")}};e.exports=t}),null);
__d("UFICommentVPVD",["Arbiter","Banzai","Event","UFICommentAction","UFICommentVisibilityStore","UFICommentVPVDLogging","UFICommentVPVDLoggingConfig","UFICommentVPVDState","UFIInstanceActionType","UFISharedDispatcher","UFIVisibility","UserActivityEmitter","gkx","setTimeoutAcrossTransitions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=!1,h=null,i="CommentVPVD: Logging subsystem shutting down - sending data to server",j="CommentVPVD: Visibility changed - sending data to server";function k(a){a===void 0&&(a=j);var c=b("UFICommentVPVDState").getState(),d=[],e=b("gkx")("AT7ImPMHuxZIJZ136ME7VyraMwtCKryQmyrFHtgzHkf8ddy4a6_xWA51xIkynmusmXrOGBFVkNSaxGsbLCgQTZHL");Object.keys(c).forEach(function(a){a=b("UFICommentVPVDLogging").log(c[a]);e&&d.push(a)});e&&(!1,console.table&&console.table(d))}function l(){if(h!==null)return;h=b("setTimeoutAcrossTransitions")(function(){h=null,k()},10)}a={init:function(){__p&&__p();if(g||!b("UFICommentVPVDState"))return;g=!0;b("Banzai").subscribe(b("Banzai").SHUTDOWN,function(){clearTimeout(h);h=null;var a=b("UFICommentVPVDState").getState();Object.keys(a).forEach(function(c){c=a[c];var d=c.contextArgs;c=c.renderedComment;b("UFISharedDispatcher").dispatch(b("UFICommentAction").changeVisibility(d,c,b("UFIVisibility").HIDDEN))});k(i)});b("UFISharedDispatcher").register(function(a){a.type==b("UFIInstanceActionType").REMOVE&&b("UFICommentVPVDState").cleanupUFIInstance(a.instanceID)});var a=b("UserActivityEmitter").factory(b("UFICommentVPVDLoggingConfig").idleTimeout);b("UFICommentVisibilityStore").addListener(function(){var a=b("UFICommentVPVDState").getState();b("UFICommentVPVDState").onCommentVisibilityChanged();a!==b("UFICommentVPVDState").getState()&&l()});b("Event").listen(document.documentElement,"click",function(){b("UFICommentVPVDState").onClickDocument(),b("UFICommentVPVDState").updateAllStates("document onClick"),l()});a.subscribe(function(a){b("UFICommentVPVDState").updateAllStates("user-active = "+a),a!="ACTIVE"&&l()});b("Arbiter").subscribe("reflow",function(){b("UFICommentVPVDState").updateAllStates("reflow"),l()});b("Arbiter").subscribe("PhotoSnowlift.OPEN",function(){b("UFICommentVPVDState").onSnowliftOpen(),b("UFICommentVPVDState").updateAllStates("PhotoSnowlift.OPEN"),l()});b("Arbiter").subscribe("PhotoSnowlift.CLOSE",function(){b("UFICommentVPVDState").onSnowliftClose(),b("UFICommentVPVDState").updateAllStates("PhotoSnowlift.CLOSE"),l()})}};e.exports=a}),null);
__d("UFICommentVPVDTracker.react",["cx","FBLogger","React","ReactDOM","SubscriptionsHandler","UFICommentAction","UFICommentVisibilityStore","UFICommentVPVD","UFICommentVPVDLoggingConfig","UFICommentVPVDState","UFISharedDispatcher","UFIVisibility","ViewportTrackingHelper","gkx","onCommentIsVisible"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("React").Children;c=b("React").PropTypes;function j(a){return b("UFICommentVisibilityStore").getVisibility(b("UFICommentVisibilityStore").getState(),a.contextArgs)===b("UFIVisibility").VISIBLE}d=babelHelpers.inherits(a,b("React").Component);h=d&&d.prototype;function a(a){h.constructor.call(this,a),this.$1=null,this.state={isVisible:!1,beforeFirstViewportChange:!0},this.$4=function(a){this.$1=a,b("UFICommentVPVDState").initComment(this.props.renderedComment,this.props.contextArgs,a)}.bind(this),this.isCommentVisible=function(a){if(!j(this.props)&&!this.state.beforeFirstViewportChange)return!1;a={height:a.bottom-a.top,width:0};return b("ViewportTrackingHelper").isVisibleInDimension(a,b("ReactDOM").findDOMNode(this),b("UFICommentVPVDLoggingConfig").minVisibleSize)}.bind(this),this.onCommentVisibilityChanged=function(a){this.setState({isVisible:a,beforeFirstViewportChange:!1}),this.$3(a)}.bind(this),b("UFICommentVPVD").init(),this.$2=new(b("SubscriptionsHandler"))()}a.prototype.componentDidMount=function(){if(this.$1==null){b("FBLogger")("ufi").mustfix("When intializing VPVd tracking for a comment, could not obtain a reference to the HTML element representing the comment.");return}this.$2.addSubscriptions(b("onCommentIsVisible")(this.$1,this.isCommentVisible,this.onCommentVisibilityChanged))};a.prototype.componentWillUnmount=function(){this.$3(!1),this.$2.release()};a.prototype.render=function(){var a=this.props,c=this.state;a=i.only(a.children);var d=b("gkx")("AT63Ugg4Nz64pGXntQSN7m4f8XguxCYVeW2rBCHjcqx3am9qvPm37-6PbLgjC7ykgMgPM1ll8uilxdCVgNhSn9Fj");return b("React").createElement("div",{"data-debugstate":d?c.isVisible?"fully visible":"not fully visible":null,className:"_3b-9"+(d?" _3b-a":"")+(d&&c.isVisible?" _3b-b":"")+(d&&!c.isVisible?" _3b-c":""),ref:this.$4},a)};a.prototype.$3=function(a){setTimeout(function(){return b("UFISharedDispatcher").dispatch(b("UFICommentAction").changeVisibility(this.props.contextArgs,this.props.renderedComment,a?b("UFIVisibility").VISIBLE:b("UFIVisibility").HIDDEN))}.bind(this),0)};a.propTypes={renderedComment:c.object.isRequired,contextArgs:c.object.isRequired};e.exports=a}),null);
__d("UFICommentFilters",["UFIConstants"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g={getAuthors:function(a){return a.reduce(function(a,b){b.author&&(a=a.concat(b.author));b.socialcontext&&(a=a.concat(b.socialcontext.topmutualid));b.replyauthors&&b.replyauthors.length&&(a=a.concat(b.replyauthors));b.parentcommentauthorid&&(a=a.concat(b.parentcommentauthorid));return a},[])},isDeleted:function(a){return a.status===b("UFIConstants").UFIStatus.DELETED},isSpam:function(a){return a.status===b("UFIConstants").UFIStatus.SPAM},collectSpamBuckets:function(a,c){a=a.reduce(function(a,d){g.isSpam(d)?a.spamBucket?(a.spamBucket.spamCommentIDs.push(d.id),a.collected.push(null)):(a.spamBucket={status:b("UFIConstants").UFIStatus.SPAM,id:d.id,spamCommentIDs:[d.id]},a.collected.push(a.spamBucket)):(d.isAnnouncement||c[d.author])&&(a.spamBucket=null,a.collected.push(d));return a},{spamBucket:null,collected:[]});return a.collected}};e.exports=g}),null);
__d("UFICommentListVisibilityTracker.react",["cx","Arbiter","DOMQuery","OnVisible.react","React","ReactDOM","SubscriptionsHandler","UFIInstanceAction","UFISharedDispatcher","UFIVisibility","gkx"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h,i=b("React").Children;c=b("React").Component;d=b("React").PropTypes;f=babelHelpers.inherits(a,c);h=f&&f.prototype;function a(a){h.constructor.call(this,a),this.state={isVisible:!1},this.onVisible=function(){this.setState({isVisible:!0}),b("UFISharedDispatcher").dispatch(b("UFIInstanceAction").changeCommentListVisibility(this.props.contextArgs,b("UFIVisibility").VISIBLE))}.bind(this),this.onHidden=function(){this.setState({isVisible:!1}),b("UFISharedDispatcher").dispatch(b("UFIInstanceAction").changeCommentListVisibility(this.props.contextArgs,b("UFIVisibility").HIDDEN))}.bind(this),this.$1=new(b("SubscriptionsHandler"))()}a.prototype.componentDidMount=function(){this.props.contextArgs.location==="conversation_nub"&&this.$1.addSubscriptions(b("Arbiter").subscribe("ConversationNubUtils/recheckTabVisibility",function(a,c){a=c||{};c=a.tab;a=c&&c.getRootDOM();c=this.refs.onVisibleRoot;var d=c&&b("ReactDOM").findDOMNode(c);a&&c&&d&&b("DOMQuery").contains(a,d)&&c.check()}.bind(this)))};a.prototype.componentWillUnmount=function(){this.$1.release()};a.prototype.shouldComponentUpdate=function(a,c){return!b("gkx")("AT63Ugg4Nz64pGXntQSN7m4f8XguxCYVeW2rBCHjcqx3am9qvPm37-6PbLgjC7ykgMgPM1ll8uilxdCVgNhSn9Fj")&&this.state.isVisible!==c.isVisible?!1:!0};a.prototype.render=function(){var a=i.only(this.props.children),c=b("gkx")("AT63Ugg4Nz64pGXntQSN7m4f8XguxCYVeW2rBCHjcqx3am9qvPm37-6PbLgjC7ykgMgPM1ll8uilxdCVgNhSn9Fj");return b("React").createElement("div",{"data-debugstate":c?this.state.isVisible?"partially visible":"hidden":null,className:"_3b-9"+(c?" _3b-a":"")+(c&&this.state.isVisible?" _3b-b":"")+(c&&!this.state.isVisible?" _3b-c":"")+" _j6a",onScroll:this.props.onScroll,ref:this.props.inputRef},b("React").createElement(b("OnVisible.react"),{ref:"onVisibleRoot",onVisible:this.onVisible,onHidden:this.onHidden},a))};a.propTypes={contextArgs:d.shape({instanceid:d.string.isRequired,location:d.string}).isRequired};e.exports=a}),null);
__d("CommentsTimeSpentTracker.react",["invariant","Banzai","CommentsTimeSpentTypedLogger","Event","OnVisible.react","React","SubscriptionsHandler","TimeSlice","UFIOrderingModeStore","UserActivity","pageID","setTimeout"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();a=b("React").PropTypes;c=b("React").createClass({displayName:"CommentsTimeSpentTracker",firstVisibleTime:0,listeners:new(b("SubscriptionsHandler"))(),propTypes:{contextArgs:a.object.isRequired,targetFBID:a.string.isRequired,viewerHasInteracted:a.bool.isRequired,timeToConsiderViewerInactiveMillis:a.number,pollViewerActivityIntervalMillis:a.number},getDefaultProps:function(){return{timeToConsiderViewerInactiveMillis:3e4,pollViewerActivityIntervalMillis:1e3}},render:function(){return b("React").createElement(b("OnVisible.react"),{ref:"onVisibleElement",onVisible:this.startInterval,onHidden:this.finishInterval},this.props.children)},startInterval:function(){this.firstVisibleTime===0&&(this.firstVisibleTime=this._getTimeInSeconds(),this._checkForIdleViewer())},finishInterval:function(){var a=b("UFIOrderingModeStore").getState().get(this.props.contextArgs.instanceid);if(this.firstVisibleTime&&this.isMounted()){var c=this._getTimeInSeconds();c>this.firstVisibleTime&&new(b("CommentsTimeSpentTypedLogger"))().setViewerHasInteracted(this.props.viewerHasInteracted).setOrderingMode(a).setPostFbid(this.props.targetFBID).setStartTime(this.firstVisibleTime).setEndTime(c).setTimeSpentID(b("pageID")).log();this.firstVisibleTime=0}},componentDidMount:function(){this.listeners.addSubscriptions(b("Banzai").subscribe(b("Banzai").SHUTDOWN,this.finishInterval),b("Event").listen(window,"blur",this.finishInterval),b("Event").listen(window,"focus",this._checkVisibility))},componentWillUnmount:function(){this.finishInterval(),this.listeners.release()},componentDidUpdate:function(){this.finishInterval(),this._checkVisibility()},_getTimeInSeconds:function(){return Math.floor(Date.now()/1e3)},_checkVisibility:function(){this.isMounted()&&(this.refs.onVisibleElement!==null||g(0,undefined),this.refs.onVisibleElement.reset())},_checkForIdleViewer:function(){if(this.firstVisibleTime===0)return;b("UserActivity").isActive(this.props.timeToConsiderViewerInactiveMillis)?b("setTimeout")(b("TimeSlice").guard(function(){this._checkForIdleViewer()}.bind(this),"CommentsTimeSpentTracker checkForIdleViewer",{propagationType:b("TimeSlice").PropagationType.EXECUTION}),this.props.pollViewerActivityIntervalMillis):(this.finishInterval(),b("UserActivity").subscribeOnce(function(){this.isMounted()&&this._checkVisibility()}.bind(this)))}});e.exports=c}),null);
__d("UFIComponents",["React","UFICommentFilters"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=function(a){if(!a)return!1;return a.props.comment&&b("UFICommentFilters").isDeleted(a.props.comment)?!1:!0},h=function(a,b,c){var d=c?a.length-1:0,e=c?-1:a.length;c=c?-1:1;for(d=d;d!=e;d+=c)if(g(a[d])){b(a,d);return a}return a};a={applyToUFIComponents:function(a,c,d){a=h(a,function(a,d){a[d]&&(a[d]=b("React").cloneElement(a[d],c))},!1);a=h(a,function(a,c){a[c]&&(a[c]=b("React").cloneElement(a[c],d))},!0);return a}};e.exports=a}),null);
__d("UFILiveTypingIndicatorContainer.react",["BootloadOnRender.react","FluxContainer","JSResource","LazyComponent.react","React","UFILiveTypingIndicator","UFILiveTypingStore"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=b("React").Component;d=babelHelpers.inherits(a,c);g=d&&d.prototype;function a(a){g.constructor.call(this,a),this.state={everHadTyping:!1,hasTyping:!1,friendTyping:!1}}a.getStores=function(){return[b("UFILiveTypingStore")]};a.calculateState=function(a,c){if(!b("UFILiveTypingIndicator").isEnabled())return{everHadTyping:!1,hasTyping:!1,friendTyping:!1};var d=!!b("UFILiveTypingStore").getState()[c.feedbackTargetID];return{everHadTyping:(a||{}).everHadTyping||d,hasTyping:d,friendTyping:b("UFILiveTypingStore").isFriendTyping(c.feedbackTargetID)}};a.prototype.shouldComponentUpdate=function(a,b){return a.feedbackTargetID!=this.props.feedbackTargetID||b.everHadTyping!=this.state.everHadTyping||b.hasTyping!=this.state.hasTyping};a.prototype.render=function(){return this.state.everHadTyping?b("React").createElement(b("BootloadOnRender.react"),{loader:b("JSResource")("UFILiveTypingIndicator.react").__setRef("UFILiveTypingIndicatorContainer.react"),placeholder:b("React").createElement("div",null),component:b("React").createElement(b("LazyComponent.react"),babelHelpers["extends"]({},this.props,this.state))}):null};e.exports=b("FluxContainer").create(a,{pure:!1,withProps:!0})}),null);
__d("StaticUFI.react",["csx","cx","invariant","Arbiter","BanzaiODS","BlueBar","BootloadedComponent.react","BootloadOnRender.react","CommentPrivacyUtils","CommentPrivacyValue","CommentSection","DOM","FbFeedCommentUFIScroller","FBFeedLocations","FluxContainer","JSLogger","JSResource","LazyComponent.react","LogHistory","Parent","PrivateCommentsConfig","PrivateConversationsTreatment","React","ReactDOM","SearchableEntry","SubscriptionsHandler","SutroBlingBarGatingConfig","TrackingNodes","UFIAddComment.react","UFIAddCommentLink.react","UFIComment.react","UFICommentDisabledNotice.react","UFICommentEditIDStore","UFICommentFilters","UFICommentHeader.react","UFICommentListVisibilityTracker.react","UFIComments","UFICommentScrollableArea.react","UFICommercialBreakStore","UFICommonInteractionEvents","UFICommonInteractionLogger","UFIComponentLogger.react","UFIComponents","UFIConfig","UFIConstants","UFIContainer.react","UFIInteractionStore","UFILikeSentence.react","UFILivePinnedCommentStore","UFILiveTypingIndicatorContainer.react","UFILocallyComposedCommentStore","UFINewCommentsPillUtils","UFIODSLogger","UFIOrderingModeStore","UFIPagerGenerator","UFIPaging","UFIPlayLiveVODHighlightsStore","UFIReplySocialSentence.react","UFIShareRow.react","UFISpamPlaceholderContainer.react","UFIStoryAction","UFIThreadedFacecastCommentsStore","UFIThreadedFacecastCommentsUtils","UFITranslateAllRow.react","UFITTLEndLoggerUtil","UFIUIEvents","UFIVersion","URI","WebCommentViewOption","XUISpinner.react","distinctArrayBy","emptyFunction","getElementPosition","getElementRect","getUnboundedScrollPosition","gkx","ifRequired","shallowEqual"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j,k=b("UFIConfig").UFICommentFilterFallbackWarning||null,l=b("UFIConstants").UFIFeedbackSourceType,m=b("UFIConstants").UFIPayloadSourceType,n=b("UFIConstants").UFIStatus;c=b("React").PropTypes;var o=b("JSLogger").create("StaticUFI"),p=b("React").createElement("div",{className:"UFICommentsLoadingSpinnerContainer _48pi UFIRow"},b("React").createElement(b("XUISpinner.react"),{size:"large"})),q=b("React").createElement("div",{className:"_xtv _32k4"},b("React").createElement("i",null));d=babelHelpers.inherits(a,b("React").Component);j=d&&d.prototype;function a(a){__p&&__p();j.constructor.call(this,a);this.$5=b("React").createRef();this.$43=function(a){b("UFINewCommentsPillUtils").handleScroll(this.props.contextArgs,a)}.bind(this);this.$39=function(a){a.preventDefault(),b("UFINewCommentsPillUtils").scrollToBottom(this.$5.current,this.props.contextArgs.liveVideoNewCommentsPillConfig)}.bind(this);this.loadMoreComments=function(){if(this.$1&&this.refs.topLevelBottomPager&&!(this.props.contextArgs.ftentidentifier in this.props.isActiveLoading)){var a=b("ReactDOM").findDOMNode(this.refs.topLevelBottomPager),c=b("getUnboundedScrollPosition")(window).y;c=c+(document.documentElement?document.documentElement.clientHeight:0)+b("UFIConstants").infiniteScrollRangeForQANDAPermalinks;a instanceof HTMLElement&&a.offsetHeight&&a.offsetTop<c&&this.refs.topLevelBottomPager.props.onPagerClick()}}.bind(this);this.onComment=function(){__p&&__p();var a=b("ReactDOM").findDOMNode(this),c=null,d=null,e=null;a instanceof Node&&(c=b("Parent").byTag(a,"form"),d=b("Parent").bySelector(a,"#fbPhotoSnowliftDetails"),e=b("Parent").bySelector(a,"._3g6d"));a=[function(){return this.refs.toplevelcomposer}.bind(this),function(){return this.$47(c)}.bind(this),function(){return this.$47(d)}.bind(this),function(){return this.$47(e)}.bind(this)];a=a.reduce(function(a,b){return a||b()},null);a&&(a.focus(),b("FbFeedCommentUFIScroller").reveal(b("ReactDOM").findDOMNode(a)))}.bind(this);a=this.props.focusReply;this.state={focusReply:a,viewerHasClickedCommentComposer:!1,viewerHasClickedSeeMore:!1,editcommentid:b("UFICommentEditIDStore").getForInstance(this.props.contextArgs.instanceid),localCommentIDs:b("UFILocallyComposedCommentStore").getStateForInstance(this.props.contextArgs.instanceid),inCommercialBreak:b("UFICommercialBreakStore").getValueFor(this.props.contextArgs.instanceid),isPlayingLiveVODHighlights:b("UFIPlayLiveVODHighlightsStore").getValueFor(this.props.contextArgs.instanceid),currentThreadedFacecastCommentID:null}}a.getStores=function(){return[b("UFIThreadedFacecastCommentsStore")]};a.calculateState=function(a,c){c=c.contextArgs;c=b("UFIThreadedFacecastCommentsStore").getCommentID(c.instanceid);return babelHelpers["extends"]({},a,{currentThreadedFacecastCommentID:c})};a.prototype.componentDidMount=function(){b("UFIODSLogger").bump("componentDidMount",b("UFIVersion").LEGACY),b("UFITTLEndLoggerUtil").endCommentTTLMarker(this.props.feedback,this.props.ranges),this.$1=!0,b("Arbiter").inform("UFI/displayDone-"+this.props.contextArgs.instanceid),this.$2=new(b("SubscriptionsHandler"))(),this.$6(),this.$2.addSubscriptions(b("UFICommentEditIDStore").addListener(function(){this.setState({editcommentid:b("UFICommentEditIDStore").getForInstance(this.props.contextArgs.instanceid)})}.bind(this)),b("UFILocallyComposedCommentStore").addListener(function(){this.setState({localCommentIDs:b("UFILocallyComposedCommentStore").getStateForInstance(this.props.contextArgs.instanceid)})}.bind(this)),b("UFICommercialBreakStore").addListener(function(){this.setState({inCommercialBreak:b("UFICommercialBreakStore").getValueFor(this.props.contextArgs.instanceid)})}.bind(this)),b("UFIPlayLiveVODHighlightsStore").addListener(function(){this.setState({isPlayingLiveVODHighlights:b("UFIPlayLiveVODHighlightsStore").getValueFor(this.props.contextArgs.instanceid)})}.bind(this)))};a.prototype.UNSAFE_componentWillReceiveProps=function(a){this.props.focusReply!==a.focusReply&&this.setState({focusReply:a.focusReply})};a.prototype.componentWillUnmount=function(){this.$1=!1,this.$2&&this.$2.release()};a.prototype.shouldComponentUpdate=function(a,c){var d=this.props,e=this.state;return!b("shallowEqual")(e,c)||!b("shallowEqual")(e.loadingSpamIDs,c.loadingSpamIDs)||!b("shallowEqual")(e.localCommentIDs,c.localCommentIDs)||!b("shallowEqual")(e.inCommercialBreak,c.inCommercialBreak)||!b("shallowEqual")(d,a)||!b("shallowEqual")(d.feedback,a.feedback)||!b("shallowEqual")(d.repliesMap,a.repliesMap)||!b("shallowEqual")(d.commentCounts,a.commentCounts)||!b("shallowEqual")(d.deletedCounts,a.deletedCounts)||!b("shallowEqual")(d.privateDeletedCounts,a.privateDeletedCounts)||!b("shallowEqual")(d.availableComments,a.availableComments)||!b("shallowEqual")(d.availablePrivateComments,a.availablePrivateComments)||!b("shallowEqual")(d.ranges,a.ranges)||!b("shallowEqual")(d.authorProfiles,a.authorProfiles)||!b("shallowEqual")(d.commentPermalinks,a.commentPermalinks)||!b("shallowEqual")(d.canAddCommentMap,a.canAddCommentMap)||!b("shallowEqual")(d.canReplyMap,a.canReplyMap)||!b("shallowEqual")(d.isActiveLoading,a.isActiveLoading)||!b("shallowEqual")(d.allSeenActiveLoadDirectionData,a.allSeenActiveLoadDirectionData)||!b("shallowEqual")(d.repliesExpandedMap,a.repliesExpandedMap)||!b("shallowEqual")(d.loadingTranslationsMap,a.loadingTranslationsMap)||!b("shallowEqual")(e.isPlayingLiveVODHighlights,c.isPlayingLiveVODHighlights)||!b("shallowEqual")(d.privateCommentsRange,a.privateCommentsRange)||d.privateCommentsCount!==a.privateCommentsCount||!b("shallowEqual")(d.loadingCommentsForSection,a.loadingCommentsForSection)};a.prototype.UNSAFE_componentWillUpdate=function(a,c){this.$3=this.$3||!this.$7(this.props.payloadSource)&&this.props.source===l.NEWS_FEED&&b("BlueBar").hasFixedBlueBar();if(this.$3&&!this.$4){a=b("ReactDOM").findDOMNode(this);a instanceof Element&&(this.$4=b("getElementRect")(a))}};a.prototype.componentDidUpdate=function(a,c){this.$6(a);if(this.$3&&this.$4){c=this.$8(this.$4);c!==null&&b("Arbiter").inform("ufi/didUpdate",{offsetY:c});this.$3=!1;this.$4=null}b("shallowEqual")(a.availableComments,this.props.availableComments)||this.$9(a.availableComments,this.props.availableComments)};a.prototype.$9=function(a,c){a=b("UFINewCommentsPillUtils").findNumNewComments(a,c);if(a>0){c=this.props.contextArgs;b("Arbiter").inform(b("UFIUIEvents").CommentChanged,{ftentidentifier:c.ftentidentifier});b("UFINewCommentsPillUtils").dispatchNewCommentAction(b("UFIStoryAction").handleNewComments(c,a),c)}};a.prototype.$7=function(a){return a===m.UNKNOWN||a===m.INITIAL_SERVER||a===m.USER_ACTION||a===m.COLLAPSE_ACTION};a.prototype.$8=function(a){var c=b("getElementPosition")(b("BlueBar").getMaybeFixedRoot());if(a.bottom<c.height){c=a.bottom-a.top;a=b("ReactDOM").findDOMNode(this);if(a instanceof HTMLElement)return a.offsetHeight-c}return null};a.prototype.$10=function(){var a=this.props,b=a.contextArgs,c=a.commentCounts,d=a.deletedCounts;a=a.feedback;a=a.commentcountreduced;b=b.ftentidentifier;var e=null;this.$11()&&(a&&isNaN(a)?e=a:e=c[b]-d[b]);return e};a.prototype.$6=function(a){__p&&__p();if(this.props.loadingComments)return;this.props.focusTopLevelComposer&&this.onComment();if(this.state.focusReply){a=this.state.focusReply;var c=a.replyID;a=a.initiatorComment;if(!(c in this.refs))return;c=this.refs[c]&&this.refs[c].refs&&this.refs[c].refs.mentionsinput;if(!c)return;c.focus();b("FbFeedCommentUFIScroller").reveal(b("ReactDOM").findDOMNode(c));this.setState({focusReply:null});if(!a)return;var d=c.hasEnteredText(),e=a.author===this.props.feedback.actorforpost,f=!!a.parentcommentid;!d&&!e&&f&&c.insertMention(this.$12(a.author))}};a.prototype.$12=function(a){a=this.props.authorProfiles[a];var c=a.type;return new(b("SearchableEntry"))({uniqueID:a.id,title:a.name,type:c==="friend"?"user":c})};a.prototype.$13=function(){return this.props.source===l.ADS};a.prototype.$14=function(){return this.props.source===l.LIVE_VIDEO};a.prototype.$15=function(){return this.props.source===l.GAMESHOW_DASH};a.prototype.$16=function(){var a=this.props.contextArgs;a=a.feedcontext&&JSON.parse(a.feedcontext);return!!(a&&a.is_narrow)};a.prototype.$17=function(){return this.props.source===l.COMPACT_SEARCH};a.prototype.$18=function(){var a=this.props,c=a.hideOrderingModeSelector,d=a.feedback,e=a.commentCounts;a=a.contextArgs;return!c&&d.orderingmodes&&!this.$15()&&!this.$17()&&e[a.ftentidentifier]>=b("UFIConstants").minCommentsForOrderingModeSelector};a.prototype.$19=function(){return!!this.props.contextArgs.hasReactions&&(this.props.contextArgs.feedbackMode==="none"||this.props.contextArgs.feedbackMode==="toggle")&&this.props.feedback.displayreactions&&!this.$20()&&!this.$21()&&this.props.feedback.orderingmodes&&!this.props.hideOrderingModeSelector};a.prototype.$21=function(){return b("CommentPrivacyUtils").getTreatment(this.props.contextArgs,this.props.feedback.viewerid)===b("PrivateConversationsTreatment").FRIEND_CONVERSATIONS&&!!this.props.availablePrivateComments&&!!this.props.privateCommentsRange&&!!this.props.privateDeletedCounts&&!this.$13()&&Number.isInteger(this.props.privateCommentsCount)};a.prototype.$22=function(){var a=this.props,b=a.contextArgs;a=a.ranges;b=b.ftentidentifier;a=a[b].getLength();return this.$23(b,a)};a.prototype.$23=function(a,b){var c=this.props.commentCounts;return c[a]==b};a.prototype.$24=function(){var a=this.props,b=a.contextArgs;a=a.feedback;return a.seencount>0&&!b.entstream};a.prototype.$25=function(){return b("UFILikeSentence.react").rendersSocialSentence(this.props)};a.prototype.$26=function(){var a=this.props;return Boolean(a.contextArgs.showCommentHeader)};a.prototype.$27=function(){var a=this.props,b=a.contextArgs;a=a.feedback;return this.$13()||this.$14()||this.$21()||b.search||this.hasReactions(a,b)};a.prototype.$20=function(){return this.$27()?!1:this.$25()||this.$24()||this.$18()||this.$26()};a.prototype.$28=function(){var a=this.props,b=a.contextArgs;a=a.feedback;return this.$13()?!1:Boolean(b.showshares&&a.sharecount&&!this.hasReactions(a,b))};a.prototype.$29=function(){var a=b("SutroBlingBarGatingConfig").enabled;return this.$28()&&!this.$21()&&!this.props.contextArgs.entstream&&!a};a.prototype.$11=function(){if(this.$13()||this.$17())return!1;if(this.props.contextArgs.shouldHideCommentsWhenCannotReply&&(this.props.feedback.arecommentsdisabled||!this.$30()||!this.props.feedback.cancomment))return!1;var a=this.props,b=a.availableComments;a=a.availablePrivateComments;return!!(b&&b.length||a&&a.length)};a.prototype.$30=function(){var a=this.props,c=a.canAddCommentMap,d=a.contextArgs;a=a.feedback;return this.props.contextArgs.feedLocationType!==b("FBFeedLocations").SURVEY_GALLERY&&a.cancomment&&Boolean(d.showaddcomment)&&Boolean(d.showInlineComposer)&&Boolean(a.actorforpost)&&c[d.ftentidentifier]};a.prototype.$31=function(){return this.$30()&&this.$32()&&this.props.hasPagedToplevel};a.prototype.$33=function(){var a=this.props.feedback;return a.arecommentsdisabled===!0&&a.cancomment===!1};a.prototype.$34=function(){var a=this.props.feedback;return a.isviewermuted===!0&&a.cancomment===!1};a.prototype.$35=function(){if(!this.$29())return!1;var a=this.props.contextArgs.isPermalink;a=a?this.$10():null;return Boolean(a)&&Number(a)!==0};a.prototype.$36=function(){if(!this.$29())return null;var a=this.props,c=a.contextArgs;a=a.feedback;var d=this.$35()?this.$10():null;return b("React").createElement(b("UFIShareRow.react"),{contextArgs:c,feedback:a,shownCommentCount:d})};a.prototype.$37=function(){var a=this.props,c=a.feedback,d=a.contextArgs;a=a.commentCounts;return this.$20()?b("React").createElement(b("UFILikeSentence.react"),{contextArgs:d,feedback:c,commentCounts:a,showOrderingModeSelector:this.$18(),hasCommentOrderInverted:this.$32(),key:"ufi_like_sentence"}):null};a.prototype.$38=function(){var a=this.props.authorPinnedComment;if(a&&a.status!==b("UFIConstants").UFIStatus.DELETED){var c=a.id===this.state.editcommentid?b("UFIAddComment.react").renderEditCommentBox(this.props.contextArgs,a,this.props.feedback):this.renderComment(a,0,!0,!1,!0,!1,!1,!!this.props.loadingTranslationsMap[a.id],!0);a=this.renderReplyContainer(a);return b("React").createElement(b("React").Fragment,null,c,a)}return null};a.prototype.render=function(){__p&&__p();var a=this.props,c=a.feedback,d=a.contextArgs,e=a.source;if(d.hideComments)return null;var f=this.$33(),g=this.$34(),h=this.$28(),i=this.$37(),j=!!i,k=this.$38();f=f||g?b("React").createElement(b("UFICommentDisabledNotice.react"),{feedback:a.feedback}):null;g=d.liveVideoNewCommentsPillConfig;var m=null;if(!d.isBroadcasterUFI&&g){var n=g.UFINewCommentsPill;m=b("React").createElement(n,{instanceID:d.instanceid,isLiveVideo:!0,onClick:this.$39})}n=this.$36();if(a.loadingComments)return b("React").createElement(b("UFIContainer.react"),{shouldHide:this.state.inCommercialBreak||this.state.isPlayingLiveVODHighlights},i,n,p);if(this.$21())return this.renderFriendConversationsTreatment();var o=this.$11(),r=a.ranges[d.ftentidentifier];r=Number(a.loggingOffset)-r.getOffset();var s=c.targetiscomment,t=null;o&&(t=this.renderCommentArray(a.availableComments,r,s,null));r=null;s=null;var u=c.cancomment;j=j||h||o||u;h=j?b("React").createElement(b("UFICommentHeader.react"),null):null;if(this.$30()||d.loggedOutLinkConfig&&d.loggedOutLinkConfig.showAddComment){u=this.$40();if(u){u=b("UFIOrderingModeStore").isLiveStreaming(d.instanceid);(!d.islivestreaming||!u)&&(r=b("React").createElement(b("UFILiveTypingIndicatorContainer.react"),{contextArgs:d,feedbackTargetID:c.targetfbid}));s=b("React").createElement(b("UFIAddComment.react"),{viewerActorID:c.actorforpost,targetID:c.ownerid,targetName:c.actorname,initialData:null,ref:"toplevelcomposer",isTopLevelComposer:!0,withoutSeparator:!1,editingComment:{},isEditing:!1,mentionsDataSource:c.mentionsdatasource,showSendOnEnterTip:c.showsendonentertip,peopleOutsideCommunityInCommentNotice:c.peopleoutsidecommunityincommentnotice,allowVideoAttachments:c.allowvideoattachments&&!u,allowPhotoAttachments:c.allowphotoattachments&&!u,allowFileAttachments:c.allowfileattachments&&!u,allowStickerAttachments:c.allowstickerattachments&&!u,allowGifAttachments:c.allowgifattachments&&!u,allowNativeTipJar:c.isnativetipjarenabled,allowFlexibleTipping:c.isflexibletippingenabled,allowTogglePrivateComments:(b("PrivateCommentsConfig").composer_lock_enabled||b("PrivateCommentsConfig").composer_unlocked_lock_enabled)&&c.canviewercommentinprivate,allowAudienceSelector:this.$21(),privateCommentTarget:c.actorname,contextArgs:d,subtitle:c.subtitle,markViewerHasInteracted:this.state.viewerHasClickedCommentComposer?b("emptyFunction"):function(){return this.setState({viewerHasClickedCommentComposer:!0})}.bind(this),groupID:c.grouporeventid,allowCommentMarkdown:c.iscommentmarkdowneligible,allowCommentFixSuggestions:b("gkx")("AT77Pq_-Y29smNkAy3FN8Tt6-lfCwdbVEynIhfH7q-5dT_94m4KSSIjNDkWsf_wWai_ELqttGZX5EJn_RG6Q15X2"),showConstituentBadgeV2OptIn:c.showconstituentbadgev2optin,constituentBanner:c.constituentbanneruri,isFirstComponent:!o||b("SutroBlingBarGatingConfig").enabled&&!this.$20()&&this.$32(),commentsTargetID:c.commentstargetfbid,showAddMentionButton:b("gkx")("AT6pq97eyrBBfowW85Fu0RWujtOKgmHdJdA72xfeSXvzp1FJoVRPxod6CnfWth0jXMdTKfDrjPgz2o9Ab5s80icFrNteJeCI1Z8rds_7sGJDjA")&&!u})}}u=d.ftentidentifier;var v=this.renderPagers(u,!1,a.ranges[u].getOffset(),a.ranges[u].getLength()),w=v.topPager;v=v.bottomPager;var x=this.$32()?r:null;r=this.$32()?null:r;u=this.$41(u,w,v);var y=u.topFilterWarning;u=u.bottomFilterWarning;var z=this.$19()?b("React").createElement("div",{className:"_11c1"+(this.$32()?"":" _4204")+(b("SutroBlingBarGatingConfig").enabled?" _4mtp":"")},b("React").createElement(b("BootloadedComponent.react"),{alignh:"left",bootloadPlaceholder:b("React").createElement("div",null),bootloadLoader:b("JSResource")("UFIOrderingModeSelectorContainer.react").__setRef("StaticUFI.react"),contextArgs:d,feedback:c})):null,A=b("UFIComponents").applyToUFIComponents([k,z,x,w,y].concat(t,[u,v,r]),{isFirstCommentComponent:!0},{isLastCommentComponent:!0}),B=A.slice(0,5);k=B[0];z=B[1];x=B[2];w=B[3];y=B[4];B=A.slice(-3);u=B[0];v=B[1];r=B[2];t=A.slice(5,-3);B=this.$32()?s:null;var C=this.$32()?null:s;k&&(B=null,C=s);s=this.$31()?b("React").createElement(b("UFIAddCommentLink.react"),{onClick:this.onComment}):null;var D=!0,E=null;d.showCommentNuxForGroupMallAds&&(E=b("React").createElement(b("BootloadOnRender.react"),{loader:b("JSResource")("UFICommentNuxForGroupMallAds.react").__setRef("StaticUFI.react"),placeholder:b("React").createElement("div",null),component:b("React").createElement(b("LazyComponent.react"),{commentNuxContent:d.groupMallAdsCommentNuxContent})}));A=b("UFIComponents").applyToUFIComponents([i,n,B,z,w,y].concat(t,[u,v,C,s]),{isFirstComponent:D},{isLastComponent:!0});D=A.slice(0,6);i=D[0];n=D[1];B=D[2];z=D[3];w=D[4];y=D[5];D=A.slice(-4);u=D[0];v=D[1];C=D[2];s=D[3];t=A.slice(6,-4);D=!!b("UFIInteractionStore").getValueFor(d.instanceid);A=b("ifRequired")("UFIThreadedFacecastCommentsContainer.react",function(a){return a});var F=A!=null&&(a.contextArgs.islivestreaming||a.contextArgs.isLiveVOD)&&this.state.currentThreadedFacecastCommentID!=null&&b("UFIThreadedFacecastCommentsUtils").isEnabled(d),G=this.$42();e=d.isBroadcasterUFI||e===l.LIVE_VIDEO_STORIES||d.isBottomUpCommentStreamingEnabled;return F&&A!=null?b("React").createElement(b("UFIContainer.react"),{shouldHide:this.state.inCommercialBreak||this.state.isPlayingLiveVODHighlights},b("React").createElement(A,{authorProfiles:a.authorProfiles,contextArgs:d})):b("React").createElement(b("UFIContainer.react"),{shouldHide:this.state.inCommercialBreak||this.state.isPlayingLiveVODHighlights},d.shownub&&j?q:null,i,n,k,h,E,B,b("React").createElement(b("UFICommentListVisibilityTracker.react"),{contextArgs:d,inputRef:this.$5,onScroll:g?this.$43:null},b("React").createElement(b("UFICommentScrollableArea.react"),{scrollcomments:!!d.scrollcomments,scrollwidth:d.scrollwidth||0},b("React").createElement(b("UFIComponentLogger.react"),{contextArgs:d,feedback:c,hasComments:o,isPermalink:d.isPermalink,viewerHasInteractedWithComments:D||this.state.viewerHasClickedCommentComposer||this.state.viewerHasClickedSeeMore},z,x,w,y,e?null:G,t,e?G:null,u,v,r))),C,s,f,m)};a.prototype.$42=function(){__p&&__p();var a=b("UFILivePinnedCommentStore").getPinnedCommentID(this.props.contextArgs.ftentidentifier);if(a==null)return null;a=b("UFIComments").getComment(a);if(a==null)return null;var c=a.parentcommentid;if(c!=null){c=b("UFIComments").getComment(c);if(c&&c.status===b("UFIConstants").UFIStatus.DELETED)return null}if(a&&!this.props.authorProfiles[a.author]){b("BanzaiODS").bumpEntityKey("unsampled_feedback","missing_pinned_comment_author");return null}return this.renderComment(a,0,!1,!1,!0,!1,!0,!!this.props.loadingTranslationsMap[a.id])};a.prototype.$40=function(){return this.state.editcommentid===null};a.prototype.renderFriendConversationsTreatment=function(){__p&&__p();var a=this.props,c=a.availableComments,d=a.availablePrivateComments,e=a.commentCounts,f=a.contextArgs,g=a.deletedCounts,h=a.feedback,j=a.loadingCommentsForSection,k=a.loggingOffset,l=a.orderingMode,m=a.privateCommentsCount,n=a.privateCommentsRange,o=a.privateDeletedCounts,q=a.ranges;a=a.source;if(j.has(b("CommentSection").FRIENDS)&&j.has(b("CommentSection").DEFAULT))return[p];!d&&i(0,undefined);Number.isInteger(m)||i(0,undefined);!n&&i(0,undefined);!o&&i(0,undefined);var r=f.ftentidentifier;q=q[r];k=Number(k)-q.getOffset();var s=this.$30()?b("React").createElement(b("UFIAddComment.react"),{key:"friend_conversations_add_comment",viewerActorID:h.actorforpost,targetID:h.ownerid,targetName:h.actorname,ref:"toplevelcomposer",isTopLevelComposer:!0,editingComment:{},mentionsDataSource:h.mentionsdatasource,showSendOnEnterTip:h.showsendonentertip,peopleOutsideCommunityInCommentNotice:h.peopleoutsidecommunityincommentnotice,allowAudienceSelector:!0,allowVideoAttachments:h.allowvideoattachments,allowPhotoAttachments:h.allowphotoattachments,allowFileAttachments:h.allowfileattachments,allowStickerAttachments:h.allowstickerattachments,allowGifAttachments:h.allowgifattachments,allowTipJar:!1,contextArgs:f,subtitle:h.subtitle,markViewerHasInteracted:this.state.viewerHasClickedCommentComposer?b("emptyFunction"):function(){return this.setState({viewerHasClickedCommentComposer:!0})}.bind(this),groupID:h.grouporeventid,allowCommentMarkdown:h.iscommentmarkdowneligible,showconstituentbadgev2optin:h.showconstituentbadgev2optin,constituentBanner:h.constituentbanneruri,isTargetPage:h.isownerpage,isFirstComponent:!0,showAddMentionButton:b("gkx")("AT6pq97eyrBBfowW85Fu0RWujtOKgmHdJdA72xfeSXvzp1FJoVRPxod6CnfWth0jXMdTKfDrjPgz2o9Ab5s80icFrNteJeCI1Z8rds_7sGJDjA")}):null;e=e[r]||0;g=g[r]||0;o=o[r]||0;return(m||0)<=o&&e<=g?[s]:b("React").createElement(b("UFIContainer.react"),null,s,b("React").createElement(b("UFICommentListVisibilityTracker.react"),{contextArgs:f},b("React").createElement(b("UFICommentScrollableArea.react"),{scrollcomments:!!f.scrollcomments,scrollwidth:f.scrollwidth||0},b("React").createElement(b("UFIComponentLogger.react"),{contextArgs:f,feedback:h,hasComments:this.$11(),isPermalink:!!f.isPermalink,viewerHasInteractedWithComments:!!b("UFIInteractionStore").getValueFor(f.instanceid)||this.state.viewerHasClickedCommentComposer||this.state.viewerHasClickedSeeMore},b("React").createElement(b("BootloadedComponent.react"),{key:"friend_conversations_section_friends",bootloadPlaceholder:p,bootloadLoader:b("JSResource")("UFIFriendConversationsSection.react").__setRef("StaticUFI.react"),comments:d,commentCount:m,contextArgs:f,deletedCount:o,feedback:h,isFirstSection:!0,isLoading:j.has(b("CommentSection").FRIENDS),onPagerClick:function(a,c){this.context.dispatch(b("UFIStoryAction").pageInComments(babelHelpers["extends"]({},f,{interactionRequestCorrelationID:b("UFICommonInteractionLogger").startInteraction(b("UFICommonInteractionEvents").UFI_TOP_LEVEL_COMMENTS_PAGINATION)}),r,a,c,b("CommentSection").FRIENDS))}.bind(this),orderingMode:b("WebCommentViewOption").TOPLEVEL,range:n,section:b("CommentSection").FRIENDS,source:a},this.renderCommentArray(d,0,!1,null)),b("React").createElement(b("BootloadedComponent.react"),{key:"friend_conversations_section_default",bootloadPlaceholder:b("React").createElement("div",null),bootloadLoader:b("JSResource")("UFIFriendConversationsSection.react").__setRef("StaticUFI.react"),comments:c,commentCount:e,contextArgs:f,deletedCount:g,feedback:h,isLoading:j.has(b("CommentSection").DEFAULT),onPagerClick:function(a,c){this.context.dispatch(b("UFIStoryAction").pageInComments(babelHelpers["extends"]({},f,{interactionRequestCorrelationID:b("UFICommonInteractionLogger").startInteraction(b("UFICommonInteractionEvents").UFI_TOP_LEVEL_COMMENTS_PAGINATION)}),r,a,c,b("CommentSection").DEFAULT))}.bind(this),orderingMode:l,range:q,section:b("CommentSection").DEFAULT,source:a},this.renderCommentArray(c,k,!1,null))))))};a.prototype.renderCommentArray=function(a,c,d,e){__p&&__p();var f=this.props,g=f.contextArgs,h=f.feedback,i=f.authorProfiles;f=f.authorPinnedComment;var j=f!==null;if(!a||!a.length)return[];a=b("distinctArrayBy")(a,function(a){return a.id});var k=b("UFICommentFilters").collectSpamBuckets(a,i);return k.reduce(function(a,f,i){__p&&__p();if(!f)return a;if(b("UFICommentFilters").isSpam(f))a.push(b("React").createElement(b("UFISpamPlaceholderContainer.react"),{key:"spam"+f.id,contextArgs:g,viewas:g.viewas,comment:f,parentCommentID:e}));else{if(f.id==this.state.editcommentid)a.push(b("UFIAddComment.react").renderEditCommentBox(g,f,h));else{var l=Math.max(c-i,0),m=i===0&&!j;i=i===k.length-1;var n=!d&&!h.arecommentsdisabled,o=d&&!m;a.push(this.renderComment(f,l,m,i,n,o,!1,!!this.props.loadingTranslationsMap[f.id]));f.id==this.props.translateAllCommentID&&!b("UFIOrderingModeStore").isLiveStreaming(g.instanceid)&&a.push(b("React").createElement(b("UFITranslateAllRow.react"),{key:"translateAll"+f.id,contextArgs:g}))}if(!d&&!b("UFICommentFilters").isDeleted(f)&&!b("UFIOrderingModeStore").isLiveStreaming(g.instanceid)){l=this.renderReplyContainer(f);l&&a.push(l)}}return a}.bind(this),[])};a.prototype.renderReplyContainer=function(a){__p&&__p();var c=this.props,d=c.commentCounts[a.id],e=c.repliesExpandedMap[a.id],f=!e&&a.interestingReplyId,g=c.ranges[a.id];g||o.error("renderReplyContainer range is undefined");var h,i;if(g&&(e||a.interestingReplyId)){h=c.repliesMap[a.id];i=g.getOffset();if(f){var j=h.filter(function(b){return b.id===a.interestingReplyId});j.length!==1?(b("LogHistory").getInstance("ufi").error("comment "+a.id+" claims to have an interesting reply, but there is not exactly 1 comment with that id in the reply list."),h=null):(h=j,i=a.interestingReplyOffset)}}var k;j=null;var l=null,m=null,p=null;if(g&&h){var q=g.getOffset(),r=g.getLength();f&&(q=i,r=1);f=this.renderPagers(a.id,!0,Number(q),r);j=f.topPager;l=f.bottomPager;q=Number(c.loggingOffset)-Number(i);k=this.renderCommentArray(h,q,!0,a.id);r=this.$44(a.id,j,l);m=r.topFilterWarning;p=r.bottomFilterWarning}f=Math.max(d-Number(a.spamreplycount),0);var s;if(g&&!b("UFIOrderingModeStore").isLiveStreaming(this.props.contextArgs.instanceid)&&f&&(e&&h&&h.length>c.replySocialSentenceMaxReplies||!e&&!h)){q=g.isLoadingPrev()||g.isLoadingNext();r=e&&!j&&q;d=null;a.replyauthors&&a.replyauthors.length&&(d=c.authorProfiles[a.replyauthors[0]]);g=h?h.length:0;s=b("React").createElement(b("UFIReplySocialSentence.react"),{contextArgs:c.contextArgs,author:d,replies:e?g:f,timestamp:a.recentreplytimestamp,onClick:function(){return this.context.dispatch(b("UFIStoryAction").toggleReplies(c.contextArgs,a.id))}.bind(this),isLoading:r,isExpanded:e,showVerified:c.feedback.showfeaturedreplies,orderingMode:c.orderingMode})}var t;if(e&&(a.cancomment&&c.canAddCommentMap[a.id]&&!(a.needsApproval||a.canAppeal||a.canSecure))){q=!1;if(k)for(var d=k.length-1;d>=0;d--)if(k[d]){q=k[d].props.isAuthorReply;break}t=this.renderReplyComposer(a,!q)}var u;if(s||j||m||k||p||l||t){g=b("UFIComponents").applyToUFIComponents([s,j,m].concat(k,[p,l,t]),{isFirstComponent:!0},{isLastComponent:!0});f=g.slice(0,3);s=f[0];j=f[1];m=f[2];r=g.slice(-3);p=r[0];l=r[1];t=r[2];k=g.slice(3,-3);e=a.status===n.LIVE_DELETED;u=b("React").createElement(b("UFIContainer.react"),{key:"replies"+a.id,isParentLiveDeleted:e,isPrivateComment:a.privacy_value===b("CommentPrivacyValue").OWNER_OR_COMMENTER,isReplyList:!0},s,j,m,k,p,l,t)}return u};a.prototype.renderReplyComposer=function(a,c){var d=this.props,e=d.contextArgs,f=d.feedback,g=this.state.editcommentid!==null;g=g&&!a.id;if(g)return null;g=b("UFIOrderingModeStore").isLiveStreaming(e.instanceid);var h=f.actorforpost===a.author;d=d.authorProfiles[a.author];h=a.privacy_value===b("CommentPrivacyValue").OWNER_OR_COMMENTER?h?f.actorname:d.name:null;return b("React").createElement(b("UFIAddComment.react"),{viewerActorID:f.actorforpost,replyCommentID:a.id,replyCommentPrivacy:a.privacy_value,groupID:f.grouporeventid,targetID:f.ownerid,initialData:null,ref:"replycomposer-"+a.id,withoutSeparator:c,editingComment:{},isEditing:!1,mentionsDataSource:f.mentionsdatasource,showSendOnEnterTip:!1,peopleOutsideCommunityInCommentNotice:f.peopleoutsidecommunityincommentnotice,allowVideoAttachments:f.allowvideoattachments&&!g,allowPhotoAttachments:f.allowphotoattachments&&!g,allowFileAttachments:f.allowfileattachments&&!g,allowStickerAttachments:f.allowstickerattachments&&!g,allowGifAttachments:f.allowgifattachments&&!g,allowCommentMarkdown:f.iscommentmarkdowneligible,allowTogglePrivateComments:!1,privateCommentTarget:h,contextArgs:e,subtitle:f.subtitle,showconstituentbadgev2optin:f.showconstituentbadgev2optin,constituentBanner:f.constituentbanneruri,showAddMentionButton:!1})};a.prototype.renderComment=function(a,c,d,e,f,g,h,i,j){j===void 0&&(j=!1);var k=this.props,m=k.feedback,n=m.actorforpost===a.author,o=a.__typename==="local",p=o||this.state.localCommentIDs[a.id],q=m.showremovemenu||m.viewerid===a.author,r=m.canremoveall&&m.isownerpage&&!n&&!m.grouporeventid,s=k.source!=l.INTERN,t=!!a.parentcommentid,u=a.parentcommentid,v=!0;t&&u&&u in this.props.canReplyMap&&this.props.canReplyMap[u]!==null&&(v=this.props.canReplyMap[u]);t=!!a.isfeatured;u=b("TrackingNodes").getTrackingInfo(b("TrackingNodes").types.COMMENT,c);c=new(b("URI"))(k.commentPermalinks[a.id]).addQueryData({comment_tracking:u}).toString();return b("React").createElement(b("UFIComment.react"),{key:b("UFIComments").getRenderKey(a.id),isFirst:d,isFirstCommentComponent:d,isLast:e,showReplyLink:f,hasPartialBorder:g,comment:a,authorProfiles:k.authorProfiles,viewerIsAuthor:n,feedback:m,"data-ft":u,contextArgs:k.contextArgs,hideAsSpamForPageAdmin:r,isLocallyComposed:p,isOptimisticallyRendered:o,isFeatured:t,parentCanComment:v,permalink:c,showPermalink:s,showRemoveReportMenu:q,focusOnMount:a.id===k.commentIDToFocusOnMount,orderingMode:k.orderingMode,featuredCommentIDs:k.featuredCommentIDs,markViewerHasInteracted:this.state.viewerHasClickedSeeMore?b("emptyFunction"):function(){return this.setState({viewerHasClickedSeeMore:!0})}.bind(this),isLivePinnedComment:h,isAuthorPinnedComment:j,showTranslation:i||!!a.translationdata})};a.prototype.$41=function(a,b,c){return this.$45(a,b,c,!1)};a.prototype.$44=function(a,b,c){return this.$45(a,b,c,!0)};a.prototype.$45=function(a,c,d,e){var f=null,g=null;c||(f=this.$46(a,b("UFIPaging").TOP,e));d||(g=this.$46(a,b("UFIPaging").BOTTOM,e));return{topFilterWarning:f,bottomFilterWarning:g}};a.prototype.$46=function(a,c,d){var e=this.props.allSeenActiveLoadDirectionData;if(!e)return null;e=e[a];if(!e||!(c in e))return null;e=this.props;return!k||!k.shouldRender(e,a,c,d)?null:b("React").createElement(k,{asReplyWarning:d,targetID:a,pagingDirection:c,ufiProps:e})};a.prototype.renderPagers=function(a,c,d,e){__p&&__p();var f=this.props;if(this.$23(a,e)||this.$13()||this.$17()||!c&&f.hideToplevelPager)return{topPager:null,bottomPager:null};c=f.commentCounts[a];var g=f.deletedCounts[a];Number.isInteger(c)||i(0,undefined,a);Number.isInteger(g)||i(0,undefined,a);Number.isInteger(e)||i(0,undefined);return b("UFIPagerGenerator").renderPagers({commentCount:c,contextArgs:f.contextArgs,currentLength:e,currentOffset:d,deletedCount:g,feedback:f.feedback,onPageCallback:function(c,d){var e=babelHelpers["extends"]({},f.contextArgs,{interactionRequestCorrelationID:b("UFICommonInteractionLogger").startInteraction(b("UFICommonInteractionEvents").UFI_TOP_LEVEL_COMMENTS_PAGINATION)});this.context.dispatch(b("UFIStoryAction").pageInComments(e,a,c,d))}.bind(this),orderingMode:f.orderingMode,range:f.ranges[a],targetID:a})};a.prototype.$47=function(a){return!a?null:b("DOM").scry(a,'[name="add_comment_text_text"]').concat(b("DOM").scry(a,'[name="add_comment_text"]')).find(function(a){return!b("Parent").byClass(a,"UFIReplyList")})};a.prototype.$32=function(){return Boolean(b("UFIOrderingModeStore").isInverted(this.props.orderingMode,this.props.contextArgs.ftentidentifier))};a.prototype.hasReactions=function(a,b){return Boolean(a.displayreactions&&b.hasReactions&&(b.feedbackMode==="none"||b.feedbackMode==="toggle"))};a.contextTypes={dispatch:c.func};a.defaultProps={commentIDToFocusOnMount:null,focusReply:null,canReplyMap:{},isActiveLoading:{},repliesExpandedMap:{},hasPagedToplevel:!1,loadingSpamIDs:{},loadingTranslationsMap:{}};e.exports=b("FluxContainer").create(a,{pure:!1,withProps:!0})}),null);
__d("UFIBlingItem.react",["cx","fbt","NumberFormat","React"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;i=babelHelpers.inherits(a,b("React").Component);i&&i.prototype;a.prototype.render=function(){__p&&__p();var a=b("NumberFormat").formatInteger(this.props.count);a=a;switch(this.props.itemKey){case"like":a=h._({"Like":"{count} Like","Likes":"{count} Likes"},[h._param("count",this.props.countreduced&&isNaN(this.props.countreduced)?this.props.countreduced:a),h._enum(this.props.count===1?"Like":"Likes",{Like:"Like",Likes:"Likes"})]);break;case"comment":a=h._({"Comment":"{count} Comment","Comments":"{count} Comments"},[h._param("count",this.props.countreduced&&isNaN(this.props.countreduced)?this.props.countreduced:a),h._enum(this.props.count===1?"Comment":"Comments",{Comment:"Comment",Comments:"Comments"})]);break;case"reaction":a=h._({"Reaction":"{count} Reaction","Reactions":"{count} Reactions"},[h._param("count",this.props.countreduced&&isNaN(this.props.countreduced)?this.props.countreduced:a),h._enum(this.props.count===1?"Reaction":"Reactions",{Reaction:"Reaction",Reactions:"Reactions"})]);break;case"reshare":a=h._({"Share":"{count} Share","Shares":"{count} Shares"},[h._param("count",this.props.countreduced&&isNaN(this.props.countreduced)?this.props.countreduced:a),h._enum(this.props.count===1?"Share":"Shares",{Share:"Share",Shares:"Shares"})]);break}return b("React").createElement("span",{className:"_2u_j"},a)};function a(){i.apply(this,arguments)}e.exports=a}),null);
__d("UFIBlingBox.react",["cx","fbt","NumberFormat","React","UFIBlingItem.react","UFIReactionTypes"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;i=babelHelpers.inherits(a,b("React").Component);i&&i.prototype;a.prototype.render=function(){__p&&__p();var a=[],c="",d=this.props,e=d.likes,f=d.likesreduced,g=d.reactionCount,i=d.reactionCountMap;d=d.reactionCountReduced;if(e||g){i=i&&i[b("UFIReactionTypes").LIKE]["default"]!==g;a.push(b("React").createElement(b("UFIBlingItem.react"),{className:a.length>0?"mls":"",count:i?g||0:e,countreduced:i?d||"":f,itemKey:i?"reaction":"like",key:"like"}));c+=this.props.likes==1?h._("1 like"):h._({"*":"{count} likes"},[h._param("count",this.props.likes,[0])]);c+=" "}if(this.props.comments){g=this.props.commentsreduced;this.props.contextArgs.islivestreaming&&(g=b("NumberFormat").formatInteger(this.props.comments));a.push(b("React").createElement(b("UFIBlingItem.react"),{className:a.length>0?"mls":"",contextArgs:this.props.contextArgs,count:this.props.comments,countreduced:g,itemKey:"comment",key:"comment"}));c+=this.props.comments==1?h._("1 comment"):h._({"*":"{count} comments"},[h._param("count",this.props.comments,[0])]);c+=" "}this.props.reshares&&(a.push(b("React").createElement(b("UFIBlingItem.react"),{className:a.length>0?"mls":"",count:this.props.reshares,countreduced:this.props.resharesreduced,itemKey:"reshare",key:"reshare"})),c+=this.props.reshares==1?h._("1 share"):h._({"*":"{count} shares"},[h._param("count",this.props.reshares,[0])]));if(this.props.readOnly)return b("React").createElement("span",{"aria-label":c},a);else{e=this.props.contextArgs.commentajaxify;return b("React").createElement("a",{ajaxify:e,href:this.props.permalink,"data-ft":this.props["data-ft"],"data-comment-prelude-ref":this.props["data-comment-prelude-ref"],"aria-label":c,onClick:this.props.onClick,rel:e?"dialog":"ignore"},a)}};function a(){i.apply(this,arguments)}a.propTypes={contextArgs:c.object.isRequired,"data-ft":c.string,"data-comment-prelude-ref":c.string,comments:c.number,commentsreduced:c.string,likes:c.number,likesreduced:c.string,nfb:c.number,onClick:c.func,permalink:c.string,reactionCount:c.number,reactionCountMap:c.object,reactionCountReduced:c.string,reshares:c.number,resharesreduced:c.string,readOnly:c.bool};e.exports=a}),null);
__d("UFIBling.react",["CommentPrelude","CommentPrivacyUtils","CommentSection","FeedbackSourceType","React","SutroBlingBarGatingConfig","TrackingNodes","UFIBlingBox.react","UFIReactionsBlingSocialSentence.react","UFISharedDispatcher","UFIStoryAction","UFIToplevelPagedCommentList","URI"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("React").Component);g&&g.prototype;a.prototype.render=function(){__p&&__p();var a=this.props.contextArgs,c=this.props.feedbackTarget,d=b("TrackingNodes").getTrackingInfo(b("TrackingNodes").types.BLINGBOX),e=c.permalink,f=new(b("URI"))(e).addQueryData({comment_tracking:d}).toString();e=b("UFIToplevelPagedCommentList").getCommentList(a.ftentidentifier,c.defaultcommentorderingmode,b("CommentSection").DEFAULT).getDisplayedCommentCount();var g=b("SutroBlingBarGatingConfig").enabled,h=(a.feedbackMode==="none"||a.feedbackMode==="toggle")&&a.hasReactions&&c.displayreactions,i=function(event){event.preventDefault();if(h&&a.feedbackMode==="expanded")this.$1();else if(a.source===b("FeedbackSourceType").COMPACT_SEARCH){var c=a.commentredirecturi!=null?new(b("URI"))(a.commentredirecturi):new(b("URI"))(f);c!=null&&c.go()}else b("CommentPrelude").onBlingboxClick(event.currentTarget),a.disableinlinetoggle||this.props.onCommentVisibilityChanged&&this.props.onCommentVisibilityChanged()}.bind(this),j=b("CommentPrivacyUtils").hasPrivateConversationsTreatment(a,c.viewerid);if(h||g||j||this.props.contextArgs.source===b("FeedbackSourceType").TAHOE){this.props.contextArgs.source===b("FeedbackSourceType").TAHOE&&(e=0);return b("React").createElement(b("UFIReactionsBlingSocialSentence.react"),{aboveUFI:g||j,commentCount:e,contextArgs:a,"data-comment-prelude-ref":"action_link_bling","data-ft":d,feedback:c,href:f,onCommentClick:i})}else{var k,l,m;a.hasReactions&&(k=c.reactioncount,l=c.reactioncountmap,m=c.reactioncountreduced);return b("React").createElement(b("UFIBlingBox.react"),{comments:e,commentsreduced:c.commentcountreduced,contextArgs:a,"data-comment-prelude-ref":"action_link_bling","data-ft":d,likes:c.likecount,likesreduced:c.likecountreduced,nfb:c.nfbcount,onClick:i,permalink:f,reactionCount:k,reactionCountMap:l,reactionCountReduced:m,reshares:c.sharecount,resharesreduced:c.sharecountreduced,readOnly:a.readonly})}};a.prototype.$1=function(){b("UFISharedDispatcher").dispatch(b("UFIStoryAction").showComments(this.props.contextArgs))};function a(){g.apply(this,arguments)}e.exports=a}),null);
__d("UFICommentActionLink.react",["cx","fbt","Arbiter","React","UFICommentLink.react","UFISharedDispatcher","UFIStoryAction"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;c=b("React").PropTypes;i=babelHelpers.inherits(a,b("React").Component);i&&i.prototype;a.prototype.componentDidMount=function(){this.$1=b("Arbiter").subscribe("UFIAction/"+this.props.contextArgs.ftentidentifier+"/showComments",function(a,c){if(!c)return;b("UFISharedDispatcher").dispatch(b("UFIStoryAction").showComments(this.props.contextArgs))}.bind(this))};a.prototype.componentWillUnmount=function(){this.$1&&b("Arbiter").unsubscribe(this.$1)};a.prototype.render=function(){__p&&__p();var a=this.props.contextArgs,c=a.commentredirecturi;a=a.loggedOutLinkConfig;var d=h._("Comment"),e;a&&a.showCommentLink&&(e=a.commentAjaxifyURI);if(e)return b("React").createElement("span",{className:"_6a _15-3 _3h-u _4k43"},b("React").createElement(b("UFICommentLink.react"),{ajaxify:e,rel:"dialog"},d));else if(c)return b("React").createElement("span",{className:"_6a _15-6 _3h-u _4k43"},b("React").createElement(b("UFICommentLink.react"),{href:c},d));return b("React").createElement("span",{className:"_6a _15-7 _3h-u _4k43"},b("React").createElement(b("UFICommentLink.react"),{hasFriendConversationsTreatment:!!this.props.contextArgs.friendConversationsParams,onClick:function(event){event.preventDefault(),b("UFISharedDispatcher").dispatch(b("UFIStoryAction").showComments(this.props.contextArgs))}.bind(this)},d))};function a(){i.apply(this,arguments)}a.propTypes={contextArgs:c.object.isRequired};e.exports=a}),null);
__d("UFILikeActionLink.react",["React","UFILikeLink.react","UFIReactionsLinkImpl.react","UFIReactionTypes","UFIStoryAction"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);g=d&&d.prototype;function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=g.constructor).call.apply(a,[this].concat(e)),this.onClick=function(event){event.preventDefault();var a=this.props.feedback.hasviewerliked;this.context.dispatch(b("UFIStoryAction").changeReaction(this.props.contextArgs,a?b("UFIReactionTypes").NONE:b("UFIReactionTypes").LIKE,event.target))}.bind(this),c}a.prototype.render=function(){var a=this.props,c=a.contextArgs;a=a.feedback;if(!c.showLikeNuxForGroupMallAds&&c.hasReactions&&a.canviewerreact&&b("UFIReactionsLinkImpl.react"))return b("React").createElement(b("UFIReactionsLinkImpl.react"),{contextArgs:c,nuxConfig:c.reactionsNuxConfig,reaction:a.viewerreaction,suggestedReaction:a.suggestedreaction,supportedReactions:a.supportedreactions});else{var d=c.loggedOutLinkConfig,e=null;d&&d.showLikeLink&&(e=d.likeAjaxifyURI);return b("React").createElement(b("UFILikeLink.react"),{ajaxify:e,likeAction:!a.hasviewerliked,onClick:this.onClick,rel:e?"dialog":null,forcelegacyrendering:c.forcelegacyrendering,showLikeNuxForGroupMallAds:c.showLikeNuxForGroupMallAds,likeNuxContent:c.groupMallAdsCommentNuxContent})}};a.contextTypes={dispatch:c.func};a.propTypes={feedback:c.object.isRequired,contextArgs:c.object.isRequired};e.exports=a}),null);
__d("UFISaveActionLink.react",["ix","cx","fbt","Bootloader","Image.react","React","SutroStoryHeaderUFIGatingConfig","fbglyph"],(function(a,b,c,d,e,f,g,h,i){"use strict";__p&&__p();var j;c=babelHelpers.inherits(a,b("React").Component);j=c&&c.prototype;function a(a){j.constructor.call(this,a),this.$1=function(){var a=this.state.showSave;b("Bootloader").loadModules(["AsyncRequest","CollectionCurationMechanisms","CollectionsDisplaySurface","SavedStateActions","XSaveController"],function(b,c,d,e,f){new b().setData({action:a?e.SAVE:e.UNSAVE,mechanism:c.SAVED_UFI,story_id:this.props.storyID,surface:d.CAMPFIRE_NOTE}).setHandler(function(b){b.error===0&&this.setState({showSave:!a})}.bind(this)).setURI(f.getURIBuilder().getURI()).send()}.bind(this),"UFISaveActionLink.react")}.bind(this),this.state={showSave:!a.isSaved}}a.prototype.render=function(){var a=this.state.showSave?i._("Save"):i._("Unsave"),c=null;if(!b("SutroStoryHeaderUFIGatingConfig").enabled_for_ufi){var d=this.state.showSave?g("122454"):g("138474");c=b("React").createElement(b("Image.react"),{src:d})}return b("React").createElement("span",{className:"_6a _38qe"+(b("SutroStoryHeaderUFIGatingConfig").enabled_for_ufi?" _38qf":"")},b("React").createElement("a",{className:(this.state.showSave?"":"_38qg")+(b("SutroStoryHeaderUFIGatingConfig").enabled_for_ufi?" _38qh":""),href:"#",onClick:this.$1},c,a))};e.exports=a}),null);
__d("UFIShareActionLink.react",["Promise","ActorURI","Arbiter","Bootloader","React","ReactShareButtonGatedModule","UFICommonInteractionEvents","UFICommonInteractionLogger","UFIShareLink.react","URI"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g,h=b("ReactShareButtonGatedModule").module,i=b("ReactShareButtonGatedModule").should_use_groups_dialog,j=b("ReactShareButtonGatedModule").store;c=b("React").PropTypes;d=babelHelpers.inherits(a,b("React").Component);g=d&&d.prototype;function a(){var a,c;for(var d=arguments.length,e=new Array(d),f=0;f<d;f++)e[f]=arguments[f];return c=(a=g.constructor).call.apply(a,[this].concat(e)),this.$2=!1,this.state={confirmed:!1,openOnInitOverride:!1,interceptedAndWantedToShareAnyways:!1},this.$3=function(){!this.$1&&!this.$2&&(this.$1=b("UFICommonInteractionLogger").startInteraction(b("UFICommonInteractionEvents").UFI_SHARE_DIALOG_OPENS))}.bind(this),this.$4=function(){this.$2=!1}.bind(this),this.$5=function(){this.$1&&(b("UFICommonInteractionLogger").endInteraction(this.$1),this.$1=null),this.$2=!0,this.$6()}.bind(this),c}a.prototype.render=function(){__p&&__p();var a=this.state,c=a.confirmed;a=a.openOnInitOverride;var d=this.props,e=d.shareURI,f=d.shareRel,g=d.shareNowMenuURI,k=d.feedbackReferrer,l=d.feedbackSource,m=d.feedbackTarget,n=d.misinformationConfirmDialogURI;d=d.interceptForPagePost;if(n&&!c)return b("React").createElement(b("UFIShareLink.react"),{href:"#",onClick:function(){this.$7(n),this.$6()}.bind(this)});if(d&&m&&m.ownerid&&!this.state.interceptedAndWantedToShareAnyways)return b("React").createElement(b("UFIShareLink.react"),{href:"#",onClick:function(){return this.$8(m.ownerid)}.bind(this)});c={feedback_referrer:k,feedback_source:l};d=m&&m.actorforpost;d&&(e=e&&b("ActorURI").create(e,d),g=g&&new(b("URI"))(g).addQueryData("actor_id",d).toString());if(i){d={default_audience:"silent_disco",feedback_referrer:k,feedback_source:l};j&&j.setShareNowURI(this.props.feedbackTarget?this.props.feedbackTarget.sharefbid:null,g);return b("React").createElement(b("UFIShareLink.react"),{href:new(b("URI"))(e).addQueryData(d),rel:f,openOnInit:a,onClick:function(){return this.$6()}.bind(this)})}return g?b("React").createElement(h,{endpoint:g,endpointData:c,openOnInitOverride:a||this.state.interceptedAndWantedToShareAnyways,onMouseUp:this.$3,onShow:this.$5,onHide:this.$4}):b("React").createElement(b("UFIShareLink.react"),{href:new(b("URI"))(e).addQueryData(c),rel:f,openOnInit:a,onClick:function(){this.$6()}.bind(this)})};a.prototype.$6=function(){this.props.feedbackTarget&&b("Arbiter").inform("share_initiated",{entidentifier:this.props.feedbackTarget.entidentifier})};a.prototype.$8=function(a){b("Bootloader").loadModules(["PagePostEngagementFrictionActions","promiseDone"],function(c,d){var e=new(b("Promise"))(function(b,d){c.showReshareEngagementFrictionDialog(a,function(){return b(!0)},function(){return b(!1)},function(){b(!1),c.goToPage(a)})}).then(function(a){a&&(this.setState({interceptedAndWantedToShareAnyways:!0}),this.$6())}.bind(this),function(a){throw a});d(e)}.bind(this),"UFIShareActionLink.react")};a.prototype.$7=function(a){var c="MISINFORMATION_RESHARE_ALERT_FUNNEL";b("Bootloader").loadModules(["AsyncDialog","AsyncRequest","FunnelLogger"],function(b,d,e){e.startFunnel(c),b.send(new d(a),function(a){a.subscribe("confirm",function(){this.setState({confirmed:!0,openOnInitOverride:!0}),e.appendAction(c,"continue"),e.endFunnel(c),a.hide()}.bind(this)),a.subscribe("cancel",function(){e.appendAction(c,"cancel"),e.endFunnel(c),a.hide()})}.bind(this))}.bind(this),"UFIShareActionLink.react")};a.propTypes={feedbackTarget:c.object,shareURI:c.string,shareRel:c.string,shareNowMenuURI:c.string,shareLinkHref:c.string,feedbackReferrer:c.string,feedbackSource:c.number,misinformationConfirmDialogURI:c.string,interceptForPagePost:c.bool};e.exports=a}),null);
__d("UFIActionLinks.react",["cx","fbt","BanzaiODS","BootloadedComponent.react","CommentPrivacyUtils","FBFeedLocations","FeedbackSourceType","JSResource","React","SutroBlingBarGatingConfig","SutroStoryHeaderUFIGatingConfig","UFIBling.react","UFICommentActionLink.react","UFIConfig","UFIInstanceAction","UFILikeActionLink.react","UFIPrivateReplyLink.react","UFISaveActionLink.react","UFIShareActionLink.react","UFISharedDispatcher","joinClasses"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i;i=babelHelpers.inherits(a,b("React").Component);i&&i.prototype;a.prototype.componentDidMount=function(){var a=this.$1();b("BanzaiODS").bumpEntityKey("feedback",a)};a.prototype.renderActorSelector=function(){if(this.props.hideActorSelector||this.props.contextArgs.disableCommentAndLikeForGroupAds)return null;var a=this.props.contextArgs,c=a.actorSelectorConfig;a=a.hasReactions;if(!c)return null;var d=b("SutroStoryHeaderUFIGatingConfig").enabled_for_ufi,e=c.module;return b("React").createElement("div",{className:"_40yk"+(d?" _610g":"")+(d?" _610h":"")+(a?" _pbn":"")},b("React").createElement(e,c.props))};a.prototype.renderActionList=function(){var a=[this.renderLikeLink(),this.renderCommentLink(),this.renderShareLink(),this.renderPrivateReplyLink(),this.renderEmbedLink(),this.renderSaveLink(),this.renderPostNowLink(),this.renderEditPostLink()];a=a.filter(function(a){return a}).map(function(a,c){return b("React").createElement("span",{className:"_1mto",key:c},a)});if(a.length)return b("React").createElement("div",{className:"_42nr _1mtp"},a);else return null};a.prototype.renderBling=function(){var a=this.shouldRenderBling();return!a?null:b("React").createElement(b("UFIBling.react"),{contextArgs:this.props.contextArgs,feedbackTarget:this.props.feedbacktarget,onCommentVisibilityChanged:function(){return b("UFISharedDispatcher").dispatch(b("UFIInstanceAction").toggleComments(this.props.contextArgs))}.bind(this)})};a.prototype.renderLikeLink=function(){var a=this.props,c=a.contextArgs;a=a.feedbacktarget;var d=c.loggedOutLinkConfig,e=c.disableCommentAndLikeForGroupAds;if(e)return null;return!a.hasviewerliked&&!a.viewercanlike&&!(d&&d.showLikeLink)?null:b("React").createElement(b("UFILikeActionLink.react"),{feedback:a,contextArgs:c})};a.prototype.renderCommentLink=function(){__p&&__p();var a=this.props.contextArgs.disableCommentAndLikeForGroupAds;if(a||this.props.contextArgs.hideComments)return null;a=this.props.contextArgs.loggedOutLinkConfig;if(!this.props.feedbacktarget.cancomment&&!(a&&a.showCommentLink)){a=this.props.contextArgs.disabledCommentTooltip;if(a){var c=h._("Comment");return b("React").createElement("span",null,b("React").createElement("span",{className:"_1ysv","data-hover":"tooltip","data-tooltip-content":a},c))}return null}return b("React").createElement(b("UFICommentActionLink.react"),{contextArgs:this.props.contextArgs})};a.prototype.$1=function(){var a=this.props.contextArgs.shareLinkConfig;if(!a)return"ufi-share-link.unavailable";a=this.props.contextArgs.loggedOutLinkConfig;return a&&a.showShareLink?"ufi-share-link.loggedout":"ufi-share-link.render"};a.prototype.renderShareLink=function(){var a=this.props.contextArgs.shareLinkConfig;if(!a)return null;var c=this.props.contextArgs.loggedOutLinkConfig;c&&c.showShareLink&&(a.shareURI=c.shareAjaxifyURI);return b("React").createElement(b("UFIShareActionLink.react"),babelHelpers["extends"]({feedbackTarget:this.props.feedbacktarget,feedbackReferrer:this.props.contextArgs.feedbackReferrer,feedbackSource:this.props.contextArgs.source},a))};a.prototype.renderPrivateReplyLink=function(){var a=this.props,c=a.contextArgs;a=a.feedbacktarget;var d=a.actorforpost;a=a.messagereplycontext;if(!b("UFIPrivateReplyLink.react").willRender(a,d))return null;return!a?null:b("React").createElement(b("UFIPrivateReplyLink.react"),{actorID:d,activityID:c.ftentidentifier,context:a,seeResponseLabel:!1,shouldShowNux:c.shouldShowCommentPrivateReplyNux})};a.prototype.renderEmbedLink=function(){var a=this.props.contextArgs.shareLinkConfig;if(!a||!a.embedURI)return null;var c=h._("Embed");return b("React").createElement("span",{className:"_4q8d _1mtq"},b("React").createElement("a",{href:a.embedURI,rel:"dialog",className:"_2g1w"},c))};a.prototype.renderSaveLink=function(){__p&&__p();var a=null;try{a=JSON.parse(this.props.contextArgs.feedcontext).location_type}catch(a){}if((a===b("FBFeedLocations").CAMPFIRE_NOTE||a===b("FBFeedLocations").WORKPLACE_HUB_PREVIEW)&&this.props.contextArgs.showsavelink){a=this.props.contextArgs;var c=a.isSaved;a=a.saveStoryID;return b("React").createElement(b("UFISaveActionLink.react"),{isSaved:c,storyID:a})}return null};a.prototype.renderPostNowLink=function(){try{var a=this.props.contextArgs,c=a.feedcontext;a=a.ftentidentifier;c=JSON.parse(c).location_type;return c===b("FBFeedLocations").GROUP_DRAFT_POSTS?b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("UFIPostNowActionLink.react").__setRef("UFIActionLinks.react"),bootloadPlaceholder:b("React").createElement("div",null),postID:a}):null}catch(a){return null}};a.prototype.renderEditPostLink=function(){try{var a=this.props.contextArgs,c=a.feedcontext;a=a.ftentidentifier;var d=JSON.parse(c).location_type;return d===b("FBFeedLocations").GROUP_DRAFT_POSTS?b("React").createElement(b("BootloadedComponent.react"),{bootloadLoader:b("JSResource")("UFIEditPostActionLink.react").__setRef("UFIActionLinks.react"),bootloadPlaceholder:b("React").createElement("div",null),feedContext:c,postID:a}):null}catch(a){return null}};a.prototype.renderSearchFeedback=function(){var a=this.props.contextArgs.inlineSearchFeedbackConfig;return!a?null:b("React").createElement(b("BootloadedComponent.react"),babelHelpers["extends"]({bootloadPlaceholder:b("React").createElement("div",null),bootloadLoader:b("JSResource")("InlineFeedback.react").__setRef("UFIActionLinks.react")},a))};a.prototype.renderCrowdsourceLabelingContainer=function(){return!b("UFIConfig").showUFICrowdsource?null:b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:b("React").createElement("div",null),bootloadLoader:b("JSResource")("UFICrowdsourceLabelingContainer.react").__setRef("UFIActionLinks.react"),feedback:this.props.feedbacktarget,contextArgs:this.props.contextArgs})};a.prototype.renderLayout=function(a,c,d){c=c.map(function(a,c){return a&&b("React").createElement("div",{className:"_3m9g",key:c},a)}).filter(function(a){return a});return!a&&c.length===0?null:b("React").createElement("div",{className:b("joinClasses")("_3399",d)},c,b("React").createElement("div",{className:"_524d"},a))};a.prototype.shouldRenderBling=function(){__p&&__p();var a=this.props.contextArgs,c=a.feedcontext,d=a.source;a=a.showBling;var e=null;if(c)try{e=JSON.parse(c).location_type}catch(a){}if(e===b("FBFeedLocations").GOODWILL_THROWBACK_PROMOTION||e===b("FBFeedLocations").GOODWILL_THROWBACK_SHARE)return!1;c=b("CommentPrivacyUtils").hasPrivateConversationsTreatment(this.props.contextArgs,this.props.feedbacktarget.viewerid);if(d===b("FeedbackSourceType").TAHOE)return!this.props.hideBling;e=b("SutroBlingBarGatingConfig").enabled;return a||e&&!this.props.hideBling||c&&!this.props.hideBling};a.prototype.shouldRenderActionButtons=function(){var a=null,c=this.props.contextArgs.source;if(this.props.contextArgs.feedcontext)try{a=JSON.parse(this.props.contextArgs.feedcontext).location_type}catch(a){}return a===b("FBFeedLocations").GOODWILL_THROWBACK_PERMALINK||a===b("FBFeedLocations").GOODWILL_THROWBACK_PROMOTION||a===b("FBFeedLocations").GOODWILL_THROWBACK_SHARE||a===b("FBFeedLocations").GROUP_SUGGESTIONS_WITH_STORY||c===b("FeedbackSourceType").LIVE_WWW_BROADCASTING||c===b("FeedbackSourceType").COMPACT_SEARCH||c===b("FeedbackSourceType").LIVE_VIDEO_STORIES?!1:!0};a.prototype.hasCounts=function(){return!!(this.props.feedbacktarget.commentcountreduced||this.props.feedbacktarget.sharecountreduced||this.props.feedbacktarget.seencount||this.props.contextArgs.viewCount)||this.props.feedbacktarget.reactioncount>0&&(b("SutroBlingBarGatingConfig").enabled||this.props.contextArgs.showBling||this.props.contextArgs.source===b("FeedbackSourceType").TAHOE||b("CommentPrivacyUtils").hasPrivateConversationsTreatment(this.props.contextArgs,this.props.feedbacktarget.viewerid))};a.prototype.render=function(){__p&&__p();var a=this.renderActorSelector(),c=this.renderSearchFeedback(),d=[],e=[],f=this.props.contextArgs.disableCommentAndLikeForGroupAds,g=null,h=b("SutroBlingBarGatingConfig").enabled,i=this.renderBling();this.props.contextArgs.showBling&&!h?(d.push(a),this.hasCounts()?g=this.renderLayout(null,[c],"_1f6t"):e.push(c)):(d.push(a),d.push(c));h=this.props.contextArgs.source===b("FeedbackSourceType").COMPACT_SEARCH;a=this.shouldRenderActionButtons();c=b("SutroStoryHeaderUFIGatingConfig").enabled_hide_ufi_border&&a;h="_1f6t"+(h?" _24vt":"")+(this.props.contextArgs.hasReactions?" _4_dr":"")+(c&&this.props.contextArgs.source!==b("FeedbackSourceType").PHOTOS_SNOWLIFT?" _20h5":"");var j=b("SutroStoryHeaderUFIGatingConfig").enabled_for_ufi,k=b("SutroStoryHeaderUFIGatingConfig").enabled_for_ufi_animation,l=b("SutroBlingBarGatingConfig").enabled;a=a?this.renderLayout(this.renderActionList(),d,"_a7s"+(c?" _20h6":"")+(j?" _610i":"")+(j?" _610j":"")+(j&&k?" _125r":"")+(l?" _2h27":"")+" clearfix _zw3"+(f?" _r9u":"")):null;d=this.renderCrowdsourceLabelingContainer();return b("React").createElement("div",{ref:"root",className:"_57w"},g,this.hasCounts()?this.renderLayout(i,e,h):null,a,d)};function a(){i.apply(this,arguments)}e.exports=a}),null);
__d("UFIActionHeader.react",["cx","FeedbackSourceType","FluxContainer","React","UFIActionLinks.react","UFICommercialBreakStore","UFIDispatcherContext.react","UFIPlayLiveVODHighlightsStore","ifRequired"],(function(a,b,c,d,e,f,g){"use strict";__p&&__p();var h;c=babelHelpers.inherits(a,b("React").Component);h=c&&c.prototype;function a(){var a,b;for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return b=(a=h.constructor).call.apply(a,[this].concat(d)),this.state={inCommercialBreak:!1,isPlayingLiveVODHighlights:!1},b}a.getStores=function(){return[b("UFICommercialBreakStore"),b("UFIPlayLiveVODHighlightsStore")]};a.calculateState=function(a,c){a=c.contextArgs.instanceid;return{inCommercialBreak:b("UFICommercialBreakStore").getValueFor(a),isPlayingLiveVODHighlights:b("UFIPlayLiveVODHighlightsStore").getValueFor(a)}};a.prototype.$1=function(){var a=b("ifRequired")("UFIVideoPlayerRegistry",function(a){return a.getAvailableVideoPlayerController(this.props.contextArgs.instanceid)}.bind(this));a=a&&a.getOption("VideoWithInstreamVideo","controller");a=a&&a.getConfig();return a};a.prototype.$2=function(){__p&&__p();var a=this.props.contextArgs.source;a=a===b("FeedbackSourceType").COMPACT_SEARCH;a=b("React").createElement(b("UFIDispatcherContext.react"),{dispatcher:this.props.dispatcher,stores:this.props.stores},b("React").createElement(b("UFIActionLinks.react"),{contextArgs:this.props.contextArgs,feedbacktarget:this.props.feedbacktarget,hideActorSelector:a}));if(this.state.isPlayingLiveVODHighlights)return b("React").createElement("div",{className:"_f_s"},a);if(!this.state.inCommercialBreak)return a;var c=this.$1();c=c&&c.vodTransitionVersion!==0;return!c?null:b("React").createElement("div",{className:"_4hqd"},a)};a.prototype.render=function(){return b("React").createElement("div",null,this.$2())};e.exports=b("FluxContainer").create(a,{withProps:!0,pure:!1})}),null);
__d("UFICallbackStore",["FluxStore"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("FluxStore"));g&&g.prototype;a.prototype.__onDispatch=function(a){var b=a.type;a=babelHelpers.objectWithoutProperties(a,["type"]);this.__emitter.emit(b,a)};a.prototype.on=function(a,b){return this.__emitter.addListener(a,b)};a.prototype.remove=function(){this.__emitter.removeAllListeners()};function a(){g.apply(this,arguments)}a.__moduleID=e.id;e.exports=a}),null);
__d("UFIFeaturedReplyCommentListImpl",["UFIReplyCommentListImpl","WebCommentViewOption"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=babelHelpers.inherits(a,b("UFIReplyCommentListImpl"));g=c&&c.prototype;function a(a,c,d,e){__p&&__p();g.constructor.call(this,a,c,b("WebCommentViewOption").FEATURED);a=0;c=d.length;this.updateCommentCount(c);this.addCommentIDs(a,c,d);var f={};e.forEach(function(a){a.id&&(f[a.id]=a)});d.forEach(function(a){this.addOrUpdateComment(f[a])}.bind(this))}a.prototype.fetchComments=function(a,b,c){};e.exports=a}),null);
__d("UFIFeaturedToplevelCommentListImpl",["UFIToplevelPagedCommentListImpl","WebCommentViewOption"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;c=babelHelpers.inherits(a,b("UFIToplevelPagedCommentListImpl"));g=c&&c.prototype;function a(a,c,d){__p&&__p();g.constructor.call(this,a,b("WebCommentViewOption").FEATURED);a=0;var e=c.length;this.updateCommentCount(e);this.addCommentIDs(a,e,c);var f={};d.forEach(function(a){a.id&&(f[a.id]=a)});c.forEach(function(a){this.addOrUpdateComment(f[a])}.bind(this))}a.prototype.fetchComments=function(a,b,c){};e.exports=a}),null);
__d("UFIFeedbackFilters",[],(function(a,b,c,d,e,f){"use strict";a={getRequestedIDs:function(a){var b=[];a.reactorids&&(b=b.concat(a.reactorids));a.actorforpost&&(b=b.concat(a.actorforpost));return b}};e.exports=a}),null);
__d("UFIFetcher",["Promise","ShortProfiles"],(function(a,b,c,d,e,f){"use strict";a={fetchShortProfiles:function(a){return new(b("Promise"))(function(c,d){return b("ShortProfiles").getMulti(a,c)})},fetchComments:function(a,c,d){return new(b("Promise"))(function(b,e){return a.getComments(c.getOffset(),c.getLength(),d,b)}).then(function(a){return Object.values(a)})},fetchCommentsOrThrow:function(a,b,c){return Object.values(a.getCommentsOrThrow(b,c))}};e.exports=a}),null);
__d("UFIReactionStore",["Arbiter","FluxStore","UFIReactionTypes","UFIStoryActionType","UFIUIEvents","UFIUserActions"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g;g=babelHelpers.inherits(a,b("FluxStore"));g&&g.prototype;a.prototype.__onDispatch=function(a){switch(a.type){case b("UFIStoryActionType").CHANGE_REACTION:b("UFIUserActions").changeReaction(a.contextArgs.ftentidentifier,a.reactionType,{rootid:a.contextArgs.rootid,source:a.contextArgs.source,feedbackReferrer:a.contextArgs.feedbackReferrer,fluentContentToken:a.contextArgs.fluentContentToken,isLiveVOD:a.contextArgs.isLiveVOD,islivestreaming:a.contextArgs.islivestreaming,instanceid:a.contextArgs.instanceid},a.target,a.sphericalYaw,a.sphericalPitch);b("Arbiter").inform(b("UFIUIEvents").ReactionButtonClicked,{ft_id:a.contextArgs.ftentidentifier,like_action:a.reactionType===b("UFIReactionTypes").LIKE,reaction_type:a.reactionType,target:a.target});break}};function a(){g.apply(this,arguments)}a.__moduleID=e.id;e.exports=a}),null);
__d("UFITypingSubscriptionController",["TimeSlice","UFITypingSubscription","clearTimeout","getByPath","setTimeout"],(function(a,b,c,d,e,f){"use strict";__p&&__p();var g=15*1e3;function h(a){var c=b("getByPath")(a,["feedback_typing_subscribe","feedback","feedback_typers","friend_count"]);a=b("getByPath")(a,["feedback_typing_subscribe","feedback","feedback_typers","other_count"]);return{friendCount:parseInt(c,10)||0,otherCount:parseInt(a,10)||0}}function i(a){return a.friendCount===0&&a.otherCount===0}function a(a,c){this.$1=null,this.$2=c,this.$3=b("UFITypingSubscription").subscribe(a,this.$4.bind(this))}a.prototype.unsubscribe=function(){this.$5(),this.$3&&this.$3.unsubscribe()};a.prototype.$4=function(a){this.$5();a=h(a);this.$2(a);i(a)||(this.$1=b("setTimeout")(b("TimeSlice").guard(function(){this.$5(),this.$2({friendCount:0,otherCount:0})}.bind(this),"UFITypingSubscriptionController freshnessTimer",{propagationType:b("TimeSlice").PropagationType.EXECUTION}),g))};a.prototype.$5=function(){this.$1&&(b("clearTimeout")(this.$1),this.$1=null)};e.exports=a}),null);
__d("UFITypingSubscriptionControllerFactory",["UFILiveTypingIndicator","UFISharedDispatcher","UFIStoryAction","UFITypingSubscriptionController","debounce"],(function(a,b,c,d,e,f){"use strict";var g=500;a={forUFIController:function(a,c){var d=b("debounce")(function(a){var d;a.friendCount?d=b("UFIStoryAction").friendTyping(c):a.otherCount&&b("UFILiveTypingIndicator").isEnabled()?d=b("UFIStoryAction").someoneTyping(c):d=b("UFIStoryAction").typingStopped(c);b("UFISharedDispatcher").dispatch(d)},g);return new(b("UFITypingSubscriptionController"))(a.targetfbid,d)}};e.exports=a}),null);
__d("UFIVODStreamingComments",["AsyncRequest","BanzaiODS","CommentSection","SubscriptionsHandler","UFICentralUpdates","UFIConstants","UFIInstanceAction","UFILivePinnedCommentStore","UFISharedDispatcher","UFIStoryAction","UFIToplevelPagedCommentList","UFIToplevelStreamedCommentList","WebCommentViewOption","XVODStreamingCommentsAsyncController","setInterval"],(function(a,b,c,d,e,f){"use strict";__p&&__p();b("BanzaiODS").setEntitySample("feedback",1e-4);function g(a,c){__p&&__p();this.ufiController=a;this.videoPlayerController=c;this.queue=[];this.queueEndTime=0;this.currentRequest=null;this.subscriptions=new(b("SubscriptionsHandler"))();this.commentsAutoplayState=this.ufiController.shouldAutoplayLiveVODComments()?"MayPlay":"MayNotPlay";this.pinQueue=[];this.resetToTime(c.getCurrentTimePosition());a=this.ufiController.getFtEntIdentifier();var d=this.ufiController.getInstanceID(),e=b("UFIToplevelPagedCommentList").getPagedCommentCountForFeedbackTargetID(a,b("CommentSection").DEFAULT);typeof e==="number"&&b("UFIToplevelStreamedCommentList").getCommentList(a,d).updateCommentCount(e);this.subscriptions.addSubscriptions(c.addListener("seekEnd",function(a){this.commentsAutoplayState==="MayNotPlay"&&(this.commentsAutoplayState="MayPlay"),this.resetToTime(a.position)}.bind(this)),c.addListener("unmute",function(a){this.commentsAutoplayState==="MayNotPlay"&&(this.commentsAutoplayState="MayPlay"),this.$1()}.bind(this)),c.addListener("updateStatus",function(a,b){b=null;while(this.pinQueue.length){if(this.pinQueue[0].timeoffset>a.position)break;b=this.pinQueue.shift()}b&&this.$2(b)}.bind(this)));b("setInterval")(this.renderNextComment.bind(this),2e3);b("BanzaiODS").bumpEntityKey("vod_comments","www_load")}g.prototype.renderNextComment=function(){__p&&__p();if(!this.videoPlayerController.isState("playing"))return;var a=this.videoPlayerController.getCurrentTimePosition();this.onTimeUpdated(a);while(this.queue.length&&this.queue[0].timeoffset<a){var c=this.queue.shift();if(c.timeoffset<a-5)continue;b("UFICentralUpdates").handleUpdate(b("UFIConstants").UFIPayloadSourceType.STREAMING,c.ufipayload);b("BanzaiODS").bumpEntityKey("feedback","facecast_vod_comment_rendered");break}this.$1()};g.prototype.fetchNewCommments=function(a,c,d,e){__p&&__p();var f=a+60;a=b("XVODStreamingCommentsAsyncController").getURIBuilder().setString("eft_id",this.ufiController.getFtEntIdentifier()).setString("target_ufi_instance_id",this.ufiController.getInstanceID()).setFloat("start_time",a).setFloat("end_time",f).setBool("should_backfill",c).getURI();this.currentRequest&&this.currentRequest.abandon();this.currentRequest=new(b("AsyncRequest"))().setURI(a).setHandler(function(a){a=a.getPayload();if(a.status==="error")return;a.backfillpayload&&b("UFICentralUpdates").handleUpdate(b("UFIConstants").UFIPayloadSourceType.STREAMING,a.backfillpayload);d(a.ufipayloads);e(a.pinnedcommentpayloads,a.backfillpinnedcommentpayload);this.queueEndTime=f}.bind(this)).setFinallyHandler(function(){c&&b("UFISharedDispatcher").dispatch(b("UFIInstanceAction").didReceiveVODComments(this.ufiController.getContextArgs())),this.currentRequest=null}.bind(this));this.currentRequest.send();c&&b("UFISharedDispatcher").dispatch(b("UFIInstanceAction").didRequestVODComments(this.ufiController.getContextArgs()))};g.prototype.onTimeUpdated=function(a){if(a<this.queueEndTime-15||this.currentRequest!==null)return;this.fetchNewCommments(this.queueEndTime,!1,function(a){this.queue=this.queue.concat(a)}.bind(this),function(a,b){this.pinQueue=this.pinQueue.concat(a)}.bind(this))};g.prototype.resetToTime=function(a){var c=this.ufiController.getFtEntIdentifier();b("UFIToplevelStreamedCommentList").resetCommentList(c,this.ufiController.getInstanceID());b("UFICentralUpdates").didUpdateFeedback(c);this.fetchNewCommments(a,!0,function(a){this.queue=a}.bind(this),function(a,b){this.pinQueue=a,this.$2(b)}.bind(this))};g.prototype.stop=function(){this.subscriptions.release()};g.prototype.$1=function(){var a=b("UFIToplevelStreamedCommentList").getExistingCommentList(this.ufiController.getFtEntIdentifier(),this.ufiController.getInstanceID());if(!a||a.getActualCommentCount()<5||this.commentsAutoplayState!=="MayPlay"||!this.videoPlayerController.isState("playing"))return;b("BanzaiODS").bumpEntityKey("vod_comments","www_autoplay");this.commentsAutoplayState="Played";b("UFISharedDispatcher").dispatch(b("UFIInstanceAction").changeOrderingMode(this.ufiController.getContextArgs(),b("WebCommentViewOption").LIVE_STREAMING))};g.prototype.$2=function(a){__p&&__p();var c,d=this.ufiController.getContextArgs(),e=b("UFILivePinnedCommentStore").getPinnedCommentID(d.ftentidentifier),f=a.ufipayload;c=(c=f)!=null?(c=c.pinnedcomments)!=null?c.length:c:c;if(!c){e!==null&&b("UFISharedDispatcher").dispatch(b("UFIStoryAction").unpinComment(d,a.pineventid));return}c=f.pinnedcomments[0].id;if(c===e)return;b("UFICentralUpdates").handleUpdate(b("UFIConstants").UFIPayloadSourceType.STREAMING,f);b("UFISharedDispatcher").dispatch(b("UFIStoryAction").pinComment(d,c,a.pineventid))};var h=new Map();e.exports={start:function(a,b){var c=a.getInstanceID();if(h.get(c))return;h.set(c,new g(a,b))},stop:function(a,b){a=h.get(b);if(!a)return;a.stop();h["delete"](b)}}}),null);
__d("UFIController",["csx","invariant","Promise","Arbiter","AsyncRequest","AuthorPinnedCommentLogger","BigPipe","BootloadedComponent.react","Bootloader","CommentPrelude","CommentSection","DOM","DOMContainer.react","DOMQuery","FBFeedLocations","FBLogger","FeedbackPayloadSourceType","FeedbackSourceType","ImmutableObject","IntersectionObserver","JSReliabilityFixesGatingConfig","JSResource","LivePinnedCommentEventCreateSubscription","LiveTimer","React","ReactDOM","Run","ShortProfiles","StaticUFI.react","SubscriptionsHandler","TranslationTrigger","UFIActionHeader.react","UFIActionLinks.react","UFIAddCommentActionType","UFIAsyncWrapper","UFICallbackStore","UFICentralUpdates","UFICommentAction","UFICommentActionType","UFICommentFilters","UFICommentLikeSubscription","UFICommentLogger","UFIComments","UFICommentSubscription","UFICommentUtils","UFICommentVisibilityStore","UFICommercialBreakAdapter","UFICommonInteractionLogger","UFIConfig","UFIConstants","UFIDispatcher","UFIDispatcherContext.react","UFIDomRootAdapter","UFIFeaturedReplyCommentListImpl","UFIFeaturedToplevelCommentListImpl","UFIFeedbackFilters","UFIFeedbackMode","UFIFeedbackStore","UFIFeedbackTargets","UFIFetcher","UFIInstanceAction","UFIInstanceActionType","UFILikeSubscription","UFILivePinnedCommentStore","UFILiveTypingIndicator","UFINewCommentNotifier","UFIOrderingModeStore","UFIPageCommentSubscription","UFIPaging","UFIPlayLiveVODHighlightsAdapter","UFIRange","UFIReactionStore","UFIReplyCommentList","UFIRootRegistry","UFISharedDispatcher","UFIStoryAction","UFIStoryActionType","UFIThreadedFacecastCommentsStore","UFIToplevelPagedCommentList","UFIToplevelStreamedCommentList","UFITypingSubscriptionControllerFactory","UFIUIEvents","UFIVideoPlayerRegistry","UFIVisibility","UFIVODStreamingComments","URI","WebCommentViewOption","XCommentEmbedPluginEmbedAsyncDialogController","createArrayFromMixed","flattenArray","forEachObject","gkx","intersectionObserverEntryIsIntersecting","isEmpty","onEnclosingPageletDestroy","promiseDone","requireWeak"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();var i=Object.freeze({NEWSSTAND:"newsstand"}),j=function(a,c,d,e){var f=a.getRequestedOffset();a=a.getRequestedLength();c=f+a===c;c=c&&k(e)?d-f:a;return new(b("UFIRange"))(f,c)},k=function(a){return a==b("FeedbackPayloadSourceType").USER_ACTION||a==b("FeedbackPayloadSourceType").LIVE_SEND||a==b("FeedbackPayloadSourceType").STREAMING},l,m=!1;n.factory=function(a,c,d){__p&&__p();if(!l||c.feedLocationType!==b("FBFeedLocations").NEWSFEED||m||c.substream_index!==1){n.$14(a,c,d);return}var e=new(b("IntersectionObserver"))(function(f,e){f.forEach(function(f){b("intersectionObserverEntryIsIntersecting")(f)&&(e.disconnect(),n.$14(a,c,d))})},{});e.observe(a);l.subscribeOnce(b("BigPipe").Events.displayed,function(){m=!0,e.disconnect(),n.$14(a,c,d),b("Bootloader").loadModules(["UFISubscriptionUpdates","UFIUserActions","UFIRetryActions"],function(){},"UFIController")})};n.prepare=function(){b("Arbiter").subscribeOnce(b("BigPipe").Events.init,function(a,b){l=b.arbiter})};n.$14=function(a,b,c){if(b.rootid)return null;b.rootid=a.id;return new n(a,Object.freeze(b),c)};n.prototype.getRootNode=function(){return this.root};n.prototype.getContextArgs=function(){return this.$2};n.prototype.getFtEntIdentifier=function(){return this.$2.ftentidentifier};n.prototype.getInstanceID=function(){return this.$2.instanceid};n.prototype.getFluentContentToken=function(){return this.$2.fluentContentToken};n.prototype.shouldAutoplayLiveVODComments=function(){return!!this.$2.autoplayLiveVODComments};n.prototype.getIsCurrentCommentEmpty=function(){return this.$13};n.prototype.getOrderingMode=function(a){return a===b("CommentSection").FRIENDS?b("WebCommentViewOption").TOPLEVEL:b("UFIOrderingModeStore").getOrderingMode(this.$2.instanceid)};function n(a,c,d){__p&&__p();this.$6=!1;this.$19=[];this.componentDidRender=function(){this.$19.length&&(this.$19.forEach(b("UFICommonInteractionLogger").endInteraction),this.$19.length=0)}.bind(this);this.$15();this.$16();this.root=a;this.$2=c;this.$7=null;b("UFISharedDispatcher").dispatch(b("UFIInstanceAction").init(c,d));b("UFIRootRegistry").registerController(c.rootid,c.instanceid,c.ftentidentifier,function(){this.$17()}.bind(this));this.$4=new(b("UFIDomRootAdapter"))(this.root,this.$2);if(b("UFIConfig").feedfocusWrapperModule&&c.location==i.NEWSSTAND){var e=b("UFIConfig").feedfocusWrapperModule,f=b("DOMQuery").scry(this.root,"^._5pat");f=f[0];if(f){var g=b("createArrayFromMixed")(f.children),h=document.createDocumentFragment();g.forEach(function(a){h.appendChild(a)});b("ReactDOM").render(b("React").createElement(b("UFIAsyncWrapper"),null,b("React").createElement(e,{instanceID:c.instanceid},b("React").createElement(b("DOMContainer.react"),null,h))),f)}}g=c.feedbackMode===b("UFIFeedbackMode").NEVER||c.feedbackMode===b("UFIFeedbackMode").NONE;this.$10={payloadSource:null,feedback:null,oldRange:{},commentIDToFocusOnMount:null,showLoadingUFI:!1,isActiveLoading:{},allSeenActiveLoadDirectionData:{},requestedInitialComments:!1,isHidden:g,commentPermalinks:{},deletedCounts:{},canAddCommentMap:{},canReplyMap:{},defaultRepliesExpandedMap:{},repliesExpandedMap:{},hasPagedToplevel:!1,focusTopLevelComposer:!1,featuredCommentLists:{},featuredCommentIDs:[],translateAllCommentID:null,toplevelPagerClickCounts:{},replyPagerClickCounts:{},loadingVODComments:!1,shouldTranslateAllVisibleComments:!1,commentsLoadingTranslations:{},loadingCommentsForSection:new Set(),authorPinnedCommentID:null};this.$10.oldRange[b("CommentSection").DEFAULT]={offset:0,length:0};this.$10.deletedCounts[b("CommentSection").DEFAULT]={};this.authorProfiles={};this.comments={};this.comments[b("CommentSection").DEFAULT]=[];this.commentsToSection={};this.repliesMap={};this.$13=!0;d.authorpinnedcomments&&(this.authorPinnedComment=d.authorpinnedcomments[0],this.$10.authorPinnedCommentID=d.authorpinnedcomments[0].id);Object.assign(this.authorProfiles,d.profiles);var j=d.feedbacktarget?d.feedbacktarget:d.feedbacktargets&&d.feedbacktargets[0];this.canRenderHeader()||b("Bootloader").loadModules(["UFIActionLinkController"],function(b){return new b(a,c,j)},"UFIController");j&&this.$18(j,c);e=this.getOrderingMode(b("CommentSection").DEFAULT);f=null;var k=null;if(d.featuredcommentlists&&d.featuredcommentlists.comments&&d.featuredcommentlists.comments[c.ftentidentifier])f=d.featuredcommentlists.comments[c.ftentidentifier],this.$10.featuredCommentLists[c.ftentidentifier]=new(b("UFIFeaturedToplevelCommentListImpl"))(c.ftentidentifier,f.values,d.comments);else{g=d.commentlists&&d.commentlists.comments;g=g[c.ftentidentifier];f=g[e]}d.privatecommentlists&&d.privatecommentlists.comments&&d.privatecommentlists.comments[c.ftentidentifier]&&(k=d.privatecommentlists.comments[c.ftentidentifier][b("WebCommentViewOption").TOPLEVEL],this.$10.oldRange[b("CommentSection").FRIENDS]={offset:0,length:0});d.featuredcommentids&&(this.$10.featuredCommentIDs=d.featuredcommentids);this.ranges={};this.replyRanges={};this.commentCounts={};this.commentCounts[c.ftentidentifier]=0;this.privateCommentsCount=0;this.ranges[b("CommentSection").DEFAULT]={};this.ranges[b("CommentSection").DEFAULT][e]=new(b("UFIRange"))(f.range.offset,f.range.length);this.$10.oldRange[b("CommentSection").DEFAULT]={offset:f.range.offset,length:this.comments[b("CommentSection").DEFAULT]&&this.comments[b("CommentSection").DEFAULT].length||0};k&&(this.$10.deletedCounts[b("CommentSection").FRIENDS]={},this.comments[b("CommentSection").FRIENDS]=[],this.ranges[b("CommentSection").FRIENDS]={},this.ranges[b("CommentSection").FRIENDS][b("WebCommentViewOption").TOPLEVEL]=new(b("UFIRange"))(k.range.offset,k.range.length),this.$10.oldRange[b("CommentSection").FRIENDS]={offset:k.range.offset,length:this.comments[b("CommentSection").FRIENDS]&&this.comments[b("CommentSection").FRIENDS].length||0});d.commentlists.replies&&f.values.concat((k||{}).values||[]).concat(this.authorPinnedComment?this.authorPinnedComment.id:[]).forEach(function(a){var c=d.commentlists.replies[a];c&&(this.commentCounts[a]=this.getReplyCommentList(a).getCommentCount(),this.replaceReplyRange(a,new(b("UFIRange"))(c.range.offset,c.range.length)))}.bind(this));d.featuredcommentlists&&d.featuredcommentlists.replies&&f.values.forEach(function(a){var e=d.featuredcommentlists.replies[a];e&&(this.$10.featuredCommentLists[a]=new(b("UFIFeaturedReplyCommentListImpl"))(c.ftentidentifier,a,e.values,d.comments),this.commentCounts[a]=this.getReplyCommentList(a).getCommentCount(),this.replaceReplyRange(a,b("UFIRange").combine(new(b("UFIRange"))(e.range.offset,e.range.length),this.replyRanges[a])))}.bind(this));this.$8=null;this.ufiCentralUpdatesSubscriptions=[b("UFICentralUpdates").subscribe("feedback-updated",function(a,d){a=d.updates;c.ftentidentifier in a&&(this.$10.payloadSource=d.payloadSource,this.fetchAndUpdate(d.payloadSource,b("CommentSection").DEFAULT),k&&this.fetchAndUpdate(d.payloadSource,b("CommentSection").FRIENDS))}.bind(this)),b("UFICentralUpdates").subscribe("update-ranges",function(d,a){d=a.adjustedRanges&&a.adjustedRanges[c.ftentidentifier];d&&b("forEachObject")(d,function(a,b){b=this.getRange(b);b.updateRequestedRange(a.offset,b.length+a.length)}.bind(this))}.bind(this)),b("UFICentralUpdates").subscribe("update-feedback",function(b,a){a.ircid&&this.$19.push(a.ircid)}.bind(this))];this.$20(c);this.onUnloadSubscription=b("Run").onUnload(function(){return this.$21()}.bind(this));this.getToplevelCommentList(b("CommentSection").DEFAULT);k&&this.getToplevelCommentList(b("CommentSection").FRIENDS);b("UFICentralUpdates").handleUpdate(b("FeedbackPayloadSourceType").INITIAL_SERVER,d);if(c.islivestreaming&&c.fluentContentToken){var l=Date.now();b("LivePinnedCommentEventCreateSubscription").subscribe(c.fluentContentToken,function(a){b("Bootloader").loadModules(["UFISubscriptionUpdates"],function(b){b.handleLivePinnedComment(c,a,Date.now()-l)},"UFIController")})}(c.islivestreaming||c.isLivingRoom)&&b("requireWeak")("UFILiveStreamingComments",function(a){var e=null;d.comments&&d.comments.length>0&&(e=d.comments[d.comments.length-1].fbid);a.start(c.ftentidentifier,j.commentcount,e,c.showLiveVideoAnnoucements,c.showLiveVideoBroadcastingJoinEvents,c.isViewerTheOwner,c.isLiveAudio,c);b("Run").onLeave(function(){return a.stop(c.ftentidentifier)})});!c.lazyFetch&&!this.canRenderHeader()&&this.$22(j);this.$2.fluentContentToken&&b("UFIVideoPlayerRegistry").registerUFIController(this,function(a){c.enableVODStreamingComments&&!this.$10.featuredCommentLists[c.ftentidentifier]&&b("UFIVODStreamingComments").start(this,a),b("UFICommercialBreakAdapter").start(c,a),b("UFIPlayLiveVODHighlightsAdapter").start(c,a),c.islivestreaming&&this.$12&&this.$12.addSubscriptions(a.addListener("stateChange",function(){a.isState("playing")&&this.render()}.bind(this))),b("UFISharedDispatcher").dispatch(b("UFIInstanceAction").foundVideoPlayerController(c,a))}.bind(this),function(){c.enableVODStreamingComments&&b("UFIVODStreamingComments").stop(this.$2.ftentidentifier,c.instanceid),b("UFICommercialBreakAdapter").stop(c.instanceid),b("UFIPlayLiveVODHighlightsAdapter").stop(c.instanceid)}.bind(this))}n.prototype.$20=function(a){this.$1=new(b("SubscriptionsHandler"))(),this.$1.addSubscriptions(b("onEnclosingPageletDestroy")(this.root,function(){this.$17()}.bind(this)),b("Arbiter").subscribe(b("UFIUIEvents").PageCleared,function(){this.$17()}.bind(this)),b("Arbiter").subscribe("ConversationNub/destroy",function(a,c){c.root&&b("DOMQuery").contains(c.root,this.root)&&this.$17()}.bind(this)),b("Arbiter").subscribe("WorkHub/destroy",function(a,c){c.root&&b("DOMQuery").contains(c.root,this.root)&&this.$17()}.bind(this)),b("Arbiter").subscribe("TahoeController/exitTahoe",function(){return b("UFISharedDispatcher").dispatch(b("UFIStoryAction").hideFacecastReplies(a,!0))})),a.viewas&&this.$1.addSubscriptions(b("Arbiter").subscribe("pre_page_transition",function(c,d){a.viewas!==new(b("URI"))(d.to).getQueryData("viewas")&&(b("UFIToplevelPagedCommentList").resetCommentListsForFeedbackTargetID(a.ftentidentifier),b("UFIToplevelStreamedCommentList").resetAllCommentLists(a.ftentidentifier))}))};n.prototype.$18=function(a,c){__p&&__p();this.$23();var d=Date.now(),e=[];(a.ll||this.$2.source===b("FeedbackSourceType").TAHOE)&&e.push(b("UFILikeSubscription").subscribe(a.targetfbid,function(a){b("Bootloader").loadModules(["UFISubscriptionUpdates"],function(b){b.handleLiveLike(c.ftentidentifier,a,Date.now()-d)},"UFIController")}));a.pagelc&&e.push(b("UFIPageCommentSubscription").subscribe(a.targetfbid,function(a){b("Bootloader").loadModules(["UFISubscriptionUpdates"],function(b){b.handleLiveComment(c.ftentidentifier,a.page_comment_create_subscribe,Date.now()-d)},"UFIController")}));a.lc&&e.push(b("UFICommentSubscription").subscribe(a.targetfbid,function(a){b("Bootloader").loadModules(["UFISubscriptionUpdates"],function(b){b.handleLiveComment(c.ftentidentifier,a.comment_create_subscribe,Date.now()-d)},"UFIController")}));a.lcl&&e.push(b("UFICommentLikeSubscription").subscribe(a.targetfbid,function(a){b("Bootloader").loadModules(["UFISubscriptionUpdates"],function(b){b.handleLiveCommentLike(c.ftentidentifier,a,Date.now()-d)},"UFIController")}));a.lti&&b("UFILiveTypingIndicator").isEnabled()&&e.push(b("UFITypingSubscriptionControllerFactory").forUFIController(a,c));a=new(b("SubscriptionsHandler"))();a.addSubscriptions.apply(a,e.filter(function(a){return!!a}));this.$7=a};n.prototype.$24=function(){var a=b("UFIFeedbackStore").getState()[this.$2.ftentidentifier];a&&this.$18(a,this.$2)};n.prototype.$25=function(){__p&&__p();var a=b("DOMQuery").scry(this.root,"^._5pat");a&&a[0]&&b("ReactDOM").unmountComponentAtNode(a[0]);b("DOM").scry(this.root,"^form ._3csb").forEach(function(a){b("ReactDOM").unmountComponentAtNode(a)});a=this.$4.getHeadRoot();a&&b("ReactDOM").unmountComponentAtNode(a);if(b("UFIRootRegistry").isSnowliftNode(this.$2.rootid)){a=this.$4.getSnowliftActionRoot();a&&b("ReactDOM").unmountComponentAtNode(a)}this.reactRoot&&this.reactRoot.unmount();b("ReactDOM").unmountComponentAtNode(this.root)};n.prototype.unitTestOnlySetFeedbackIntoState=function(a){this.$10.feedback=a};n.prototype.$15=function(){__p&&__p();this.$12||(this.$3=new(b("UFIDispatcher"))(),this.$11={UFICallbackStore:new(b("UFICallbackStore"))(this.$3),UFIReactionStore:new(b("UFIReactionStore"))(this.$3)},this.$12=new(b("SubscriptionsHandler"))(),this.$12.addSubscriptions(this.$11.UFICallbackStore.on(b("UFICommentActionType").TOGGLE_LIKE,function(a){b("Bootloader").loadModules(["UFIUserActions"],function(b){b.changeCommentLike(a.comment.id,a.like,{source:this.$2.source,target:a.target})}.bind(this),"UFIController")}.bind(this)),this.$11.UFICallbackStore.on(b("UFICommentActionType").CHANGE_REACTION,function(a){b("Bootloader").loadModules(["UFIUserActions"],function(b){b.changeCommentReaction(a.comment.id,a.reactionType,{source:this.$2.source,instanceid:this.$2.instanceid},a.target)}.bind(this),"UFIController")}.bind(this)),this.$11.UFICallbackStore.on(b("UFIStoryActionType").CHANGE_REACTION,function(a){b("Bootloader").loadModules(["UFILiveVideoCommentUtil"],function(b){return b.handleScheduledLiveSubscriberNuxLogic(a)},"UFIController")}),this.$11.UFICallbackStore.on(b("UFICommentActionType").CHANGE_VOTE,function(a){b("Bootloader").loadModules(["UFIUserActions"],function(b){b.changeCommentVote(a.comment.id,a.comment.fbid,a.arrowType,a.currentVoteState,{source:this.$2.source,instanceid:this.$2.instanceid},a.target)}.bind(this),"UFIController")}.bind(this)),this.$11.UFICallbackStore.on(b("UFICommentActionType").REMOVE,function(a){if(a.comment.candeletewithrule){b("Bootloader").loadModules(["UFICommentRemoveWithRule"],function(b){return b.show(a,this.$2)}.bind(this),"UFIController");return}else b("Bootloader").loadModules(["UFICommentRemoveDialog","UFIUserActions"],function(b,c){return b.show(function(b){c.removeComment(a.comment.id,{source:this.$2.source,oneclick:!1,target:a.target},b),a.onConfirm()}.bind(this),a.comment.canblockcommenterafterdelete)}.bind(this),"UFIController")}.bind(this)),this.$11.UFICallbackStore.on(b("UFICommentActionType").REMOVE_AND_BLOCK,function(a){b("Bootloader").loadModules(["UFICommentRemoveDialog","UFIUserActions"],function(b,c){return b.show(function(){c.removeComment(a.comment.id,{source:this.$2.source,oneclick:!1,target:a.target},!0),a.onConfirm()}.bind(this),!1,!0)}.bind(this),"UFIController")}.bind(this)),this.$11.UFICallbackStore.on(b("UFICommentActionType").DELETE_COMMENT_AND_REMOVE_COMMENTER,function(a){b("Bootloader").loadModules(["UFICommentDeleteAndMemberRemoveDialog","UFIUserActions"],function(b,c){b.showEx({authorName:a.comment.author_name,commentId:a.comment.id,showRemoveContentOptions:a.comment.canseeremovecontentoptions},function(b){c.deleteCommentAndRemoveCommenter(a.comment.id,{source:this.$2.source,oneclick:!1,target:a.target},b.selectedDeletePosts,b.selectedDeleteComments,b.selectedDeclinePendingMembers,b.selectedBlockPermanently,b.selectedApplyToOtherGroups)}.bind(this))}.bind(this),"UFIController")}.bind(this)),this.$11.UFICallbackStore.on(b("UFICommentActionType").MUTE_MEMBER,function(a){__p&&__p();if(!a.comment.ismuted)b("Bootloader").loadModules(["UFIMemberMuteDialog","UFIUserActions"],function(b,c){return b.show(function(b,d){c.muteMember(a.comment.id,{source:this.$2.source,oneclick:!1,target:a.target},b,d)}.bind(this),a.comment.author_name)}.bind(this),"UFIController");else{var c;b("Bootloader").loadModules(["GroupsMemberMuteDurationDefaults"],function(a){c=a.UNMUTE},"UFIController");b("Bootloader").loadModules(["UFIUserActions"],function(b){b.muteMember(a.comment.id,{source:this.$2.source,oneclick:!1,target:a.target},c,null)}.bind(this),"UFIController")}}.bind(this)),this.$11.UFICallbackStore.on("bulk_review",function(a){b("Bootloader").loadModules(["UFIUserActions"],function(b){b.showBulkReview(a.comment.id,{source:this.$2.source,target:a.target})}.bind(this),"UFIController")}.bind(this)),this.$11.UFICallbackStore.on(b("UFICommentActionType").TOGGLE_TEXT_DELIGHTS,function(a){b("Bootloader").loadModules(["UFIUserActions"],function(b){b.toggleTextDelights(a.comment,{source:this.$2.source,target:a.target},!a.comment.text_delights_are_hidden)}.bind(this),"UFIController")}.bind(this)),this.$11.UFICallbackStore.on(b("UFICommentActionType").TRANSLATE,function(a){this.$10.commentsLoadingTranslations[a.comment.id]||(this.$10.commentsLoadingTranslations[a.comment.id]=!0,b("Bootloader").loadModules(["UFIUserActions"],function(b){b.translateComments(a.comment.ftentidentifier,[a.comment.id],a.trigger,{source:this.$2.source,target:a.target})}.bind(this),"UFIController"),b("UFICommentUtils").shouldShowTranslateAll(this.comments[b("CommentSection").DEFAULT],this.repliesMap,babelHelpers["extends"]({},this.$10.defaultRepliesExpandedMap,this.$10.repliesExpandedMap),this.$10.commentsLoadingTranslations)&&(this.$10.translateAllCommentID=a.comment.id),this.render())}.bind(this)),this.$11.UFICallbackStore.on(b("UFICommentActionType").TOGGLE_MARK_AS_SPAM,function(a){b("Bootloader").loadModules(["UFIUserActions"],function(b){b.setHideAsSpam(a.comment.id,a.is_spam,{source:this.$2.source,target:a.target})}.bind(this),"UFIController")}.bind(this)),this.$11.UFICallbackStore.on(b("UFICommentActionType").TOGGLE_KEEP_SPAM,function(a){b("Bootloader").loadModules(["UFIUserActions"],function(b){b.keepSpam(a.comment.id,{source:this.$2.source,target:a.target})}.bind(this),"UFIController")}.bind(this)),this.$11.UFICallbackStore.on(b("UFICommentActionType").CHANGE_PIN_BY_AUTHOR,function(a){__p&&__p();var c=a.comment;b("Bootloader").loadModules(["UFIReplacePinnedCommentDialog","UFIUserActions"],function(d,e){__p&&__p();if(a.pinnedByAuthor){var f=this.$10.authorPinnedCommentID;f&&f!==c.id?d.show(function(){b("AuthorPinnedCommentLogger").logReplacingPinnedCommentAttempt(c.fbid);var d=b("UFIComments").getComment(f);b("UFIComments").setComment(f,b("ImmutableObject").set(d,{ispinnedbyauthor:!1}));e.authorPinComment(c,a.pinnedByAuthor);this.$10.authorPinnedCommentID=c.id}.bind(this)):(b("AuthorPinnedCommentLogger").logPinningCommentAttempt(c.fbid),e.authorPinComment(c,a.pinnedByAuthor),this.$10.authorPinnedCommentID=c.id)}else b("AuthorPinnedCommentLogger").logUnpinningCommentAttempt(c.fbid),this.$10.authorPinnedCommentID=null,e.authorPinComment(c,a.pinnedByAuthor)}.bind(this),"UFIController")}.bind(this)),this.$11.UFICallbackStore.on(b("UFICommentActionType").TOGGLE_APPEAL_SPAM,function(a){b("Bootloader").loadModules(["UFIUserActions"],function(b){b.appealSpam(a.comment.id,a.feedback.actorname,{source:this.$2.source,target:a.target})}.bind(this),"UFIController")}.bind(this)),this.$11.UFICallbackStore.on(b("UFICommentActionType").TOGGLE_SECURE_ACCOUNT,function(a){b("Bootloader").loadModules(["UFICommentSecureAccountDialog","UFIUserActions"],function(b,c){return b.show(function(){c.secureAccount(a.comment.id,{source:this.$2.source,target:a.target})}.bind(this),a.feedback.actorname)}.bind(this),"UFIController")}.bind(this)),this.$11.UFICallbackStore.on(b("UFIStoryActionType").CHANGE_ACCEPTED_ANSWER,function(a){b("Bootloader").loadModules(["UFIUserActions"],function(b){b.changeAcceptedAnswer(a.comment,a.doAccept)},"UFIController")}),this.$11.UFICallbackStore.on(b("UFICommentActionType").TOGGLE_INLINE_BAN,function(a){b("Bootloader").loadModules(["UFIUserActions"],function(b){b.banUser(a.comment,a.ownerid,a.is_banned,{source:this.$2.source,target:a.target})}.bind(this),"UFIController")}.bind(this)),this.$11.UFICallbackStore.on(b("UFICommentActionType").TOGGLE_INLINE_STREAM_BAN,function(a){b("Bootloader").loadModules(["UFIUserActions"],function(b){b.streamBanUser(a.comment,a.ownerid,a.is_banned,{source:this.$2.source,target:a.target})}.bind(this),"UFIController")}.bind(this)),this.$11.UFICallbackStore.on(b("UFICommentActionType").EMBED,function(a){a=b("XCommentEmbedPluginEmbedAsyncDialogController").getURIBuilder().setString("comment_id",a.comment.id).getURI();new(b("AsyncRequest"))(a).send()}),this.$11.UFICallbackStore.on(b("UFICommentActionType").MANAGE_CONSTITUENT_BADGE,function(a){b("Bootloader").loadModules(["UFIUserActions"],function(b){b.manageConstituentBadge(a.comment)},"UFIController")}),this.$11.UFICallbackStore.on(b("UFIAddCommentActionType").SUBMIT_NEW,function(a){var c=this.$4.getParentForm();c&&b("UFINewCommentNotifier").onNewComment(c,this.$2,a.comment,a.target,a.replyCommentID,a.timestamp)}.bind(this)),this.$11.UFICallbackStore.on(b("UFIAddCommentActionType").SUBMIT_EDIT,function(a){var c=a.comment,d=a.commentData,e=a.target;!d.visibleValue&&!d.attachedPhoto&&!d.attachedVideo&&!d.attachedFile&&!d.attachedSticker&&!d.attachedShareURL?b("Bootloader").loadModules(["UFICommentRemoveDialog","UFIUserActions"],function(a,b){return a.show(function(){return b.removeComment(c.id,{source:this.$2.source,oneclick:!1,target:e},!1)}.bind(this),!1)}.bind(this),"UFIController"):b("Bootloader").loadModules(["UFIUserActions"],function(a){a.editComment(c.id,d.visibleValue,d.encodedValue,{source:this.$2.source,target:e,attachedPhoto:d.attachedPhoto,attachedVideo:d.attachedVideo,attachedFile:d.attachedFile,attachedSticker:d.attachedSticker,attachedShareURL:d.attachedShareURL,isMarkdown:d.isMarkdown,delightRanges:d.delightRanges})}.bind(this),"UFIController")}.bind(this)),this.$11.UFICallbackStore.on(b("UFICommentActionType").REMOVE_PREVIEW,function(a){b("Bootloader").loadModules(["UFIUserActions"],function(b){b.removePreview(a.comment,{source:this.$2.source,target:a.target})}.bind(this),"UFIController")}.bind(this)),this.$11.UFICallbackStore.on(b("UFIAddCommentActionType").RETRY_SUBMIT,function(a){b("Bootloader").loadModules(["UFIRetryActions"],function(b){b.retrySubmit(a.comment,this.$2.source)}.bind(this),"UFIController")}.bind(this)),this.$11.UFICallbackStore.on(b("UFIStoryActionType").PAGE_IN_COMMENTS,function(a){this.$10.payloadSource=b("FeedbackPayloadSourceType").USER_ACTION,this.$26(a.commentID,a.direction,a.nextRange,a.section),this.fetchAndUpdateWithLogs(b("FeedbackPayloadSourceType").USER_ACTION,a.section||b("CommentSection").DEFAULT,a.direction,a.interactionRequestCorrelationID)}.bind(this)),this.$11.UFICallbackStore.on(b("UFIStoryActionType").TOGGLE_REPLIES,function(a){this.$10.payloadSource=b("FeedbackPayloadSourceType").USER_ACTION;a=a.commentID;var c=this.$10.repliesExpandedMap[a];c?(delete this.$10.isActiveLoading[a],this.$10.repliesExpandedMap[a]=!1,this.render()):(this.$10.focusedReplyComposer={replyID:"replycomposer-"+a,initiatorComment:null},this.$26(a,b("UFIPaging").BOTTOM,this.$27(a)),this.fetchAndUpdateWithLogs(b("FeedbackPayloadSourceType").USER_ACTION,this.commentsToSection[a]||b("CommentSection").DEFAULT))}.bind(this)),this.$11.UFICallbackStore.on(b("UFIStoryActionType").SHOW_REPLIES,function(a){this.$10.payloadSource=b("FeedbackPayloadSourceType").USER_ACTION,this.$10.focusedReplyComposer={replyID:"replycomposer-"+a.commentID,initiatorComment:a.initiatorComment},this.$26(a.commentID,b("UFIPaging").BOTTOM,this.$27(a.commentID)),this.fetchAndUpdateWithLogs(b("FeedbackPayloadSourceType").USER_ACTION,this.commentsToSection[a.commentID]||b("CommentSection").DEFAULT)}.bind(this)),this.$11.UFICallbackStore.on(b("UFIStoryActionType").COMMENTS_ARRIVED,function(a){this.$10.loadingCommentsForSection["delete"](a.section),this.$10.payloadSource=a.source,this.$10.showLoadingUFI=!1,this.$10.isActiveLoading={},this.$10.commentIDToFocusOnMount=a.source===b("FeedbackPayloadSourceType").USER_ACTION&&!this.$2.isBroadcasterUFI&&!this.$2.isLivingRoom?this.$28(a.newOffset,a.newLength,a.section):null,this.$10.oldRange[a.section]={offset:a.newOffset,length:a.newLength},this.$29(),this.$10.shouldTranslateAllVisibleComments&&!b("UFIOrderingModeStore").isLiveStreaming(this.$2.instanceid)&&this.$30(),a.interactionRequestCorrelationID&&this.$19.push(a.interactionRequestCorrelationID),this.render(),a.source==b("FeedbackPayloadSourceType").ENDPOINT_COMMENT_FETCH&&(b("Arbiter").inform(b("UFIUIEvents").CommentPager),b("UFIConfig").logCommentLoad&&b("UFICommentLogger").logCommentFetchReceived(this.$2.ftentidentifier,Date.now()))}.bind(this))))};n.prototype.$16=function(){__p&&__p();this.$9=[b("UFISharedDispatcher").register(function(a){__p&&__p();switch(a.type){case b("UFIInstanceActionType").REMOVE:if(a.instanceID!==this.$2.instanceid){a.ftentidentifier===this.$2.ftentidentifier&&this.$24();return}b("UFIRootRegistry").cleanupInstance(a.instanceID);break;case b("UFIInstanceActionType").TOGGLE_COMMENTS:if(a.instanceID!==this.$2.instanceid)return;this.$10.payloadSource=b("FeedbackPayloadSourceType").COLLAPSE_ACTION;this.$10.isHidden=!this.$10.isHidden;this.render();break;case b("UFIInstanceActionType").CHANGE_ORDER_MODE:if(a.instanceID!==this.$2.instanceid)return;this.$10.payloadSource=b("FeedbackPayloadSourceType").USER_ACTION;this.comments[b("CommentSection").FRIENDS]?this.$10.loadingCommentsForSection.add(b("CommentSection").DEFAULT):this.$10.showLoadingUFI=!0;this.render();this.fetchAndUpdate(b("FeedbackPayloadSourceType").USER_ACTION,b("CommentSection").DEFAULT);break;case b("UFIInstanceActionType").REQUESTED_VOD_COMMENTS:if(a.instanceID!==this.$2.instanceid)return;this.$10.loadingVODComments=!0;this.render();break;case b("UFIInstanceActionType").RECEIVED_VOD_COMMENTS:if(a.instanceID!==this.$2.instanceid)return;this.$10.loadingVODComments=!1;this.render();break;case b("UFIStoryActionType").LIVE_PIN_COMMENT:if(a.ftentidentifier!==this.$2.ftentidentifier)return;var c=b("UFIComments").getComment(a.commentID),d=c?c.author:null;d&&b("ShortProfiles").get(d,function(a){this.authorProfiles[d]=a,this.$6||this.render()}.bind(this));break;case b("UFIStoryActionType").LIVE_UNPIN_COMMENT:if(a.ftentidentifier!==this.$2.ftentidentifier)return;this.render();break;case b("UFIStoryActionType").SHOW_COMMENTS:if(a.instanceID!==this.$2.instanceid)return;this.$10.isHidden=!1;this.$10.focusTopLevelComposer=!0;b("CommentPrelude").expand(this.root,!1,"ufi_controller");this.staticUFI&&b("CommentPrelude").expand(this.staticUFI,!1,"ufi.react");this.render();break;case b("UFIInstanceActionType").TRANSLATE_ALL:if(a.instanceID!==this.$2.instanceid)return;if(this.$2.islivestreaming)break;this.$10.shouldTranslateAllVisibleComments=!0;this.$10.translateAllCommentID=null;this.$30();this.render();break;case b("UFIAddCommentActionType").CHANGE_CONTENT:if(a.instanceID!==this.$2.instanceid)return;this.$13=a.text.length===0;break;case b("UFIAddCommentActionType").SUBMIT_NEW:if(a.instanceID!==this.$2.instanceid)return;this.$13=!0;break}}.bind(this))]};n.prototype.getStores=function(){return this.$11};n.prototype.$27=function(a){a=this.commentCounts[a];var c=Math.min(a,this.$2.pagesize);return new(b("UFIRange"))(a-c,c)};n.prototype.$26=function(a,c,d,e){__p&&__p();e=e||this.commentsToSection[a]||b("CommentSection").DEFAULT;var f=this.$10,g=f.isActiveLoading,h=f.allSeenActiveLoadDirectionData,i=f.repliesExpandedMap,j=f.toplevelPagerClickCounts;f=f.replyPagerClickCounts;var k=this.$2.ftentidentifier,l=a!==k;g[a]=c;g=h[a]||{};g[c]=!0;h[a]=g;l?i[a]=!0:this.$10.hasPagedToplevel=!0;if(a==k){c=this.getOrderingMode(e);j[e]=j[e]||{};h=j[e][c]||0;j[e][c]=h+1;this.getRange(e).updateRequestedRange(d.offset,d.length)}else{g=f[a]||0;f[a]=g+1;this.replyRanges[a].updateRequestedRange(d.offset,d.length)}};n.prototype.$31=function(){this.$10.payloadSource=b("FeedbackPayloadSourceType").USER_ACTION,this.$10.showLoadingUFI=!0,this.$10.requestedInitialComments=!0,this.$10.loadingCommentsForSection.add(b("CommentSection").DEFAULT),this.comments[b("CommentSection").FRIENDS]&&this.$10.loadingCommentsForSection.add(b("CommentSection").FRIENDS),this.$10.loadingCommentsForSection.forEach(function(a){var c=this.getToplevelCommentList(a).getCommentCount(),d=Math.min(c,this.$2.numLazyComments||0);b("forEachObject")(this.ranges[a],function(a){a.updateRequestedRange(c-d,d)});this.fetchAndUpdate(b("FeedbackPayloadSourceType").USER_ACTION,a)}.bind(this)),b("UFIFeedbackTargets").getFeedbackTarget(this.$2.ftentidentifier,function(a){this.canRenderHeader()?this.renderHeader(a):this.$22(a)}.bind(this))};n.prototype.$22=function(a){this.shouldShowCommentOrderingModeSelector(a)&&b("DOM").scry(this.root,"^form ._3csb").slice(0,1).forEach(function(c){b("ReactDOM").render(b("React").createElement(b("UFIAsyncWrapper"),null,b("React").createElement(b("BootloadedComponent.react"),{bootloadPlaceholder:b("React").createElement("div",null),bootloadLoader:b("JSResource")("UFIOrderingModeSelectorContainer.react").__setRef("UFIController"),contextArgs:this.$2,feedback:a})),c)}.bind(this))};n.prototype.$29=function(){if(Object.keys(this.$10.commentsLoadingTranslations).length==0)return;this.comments[b("CommentSection").DEFAULT].concat(this.comments[b("CommentSection").FRIENDS]||[]).forEach(function(a){this.$10.commentsLoadingTranslations[a.id]&&!!a.translationdata&&delete this.$10.commentsLoadingTranslations[a.id]}.bind(this));Object.keys(this.repliesMap).forEach(function(a){a=this.repliesMap[a];a.forEach(function(a){this.$10.commentsLoadingTranslations[a.id]&&!!a.translationdata&&delete this.$10.commentsLoadingTranslations[a.id]}.bind(this))}.bind(this))};n.prototype.$30=function(){__p&&__p();var a=this.comments[b("CommentSection").DEFAULT].concat(this.comments[b("CommentSection").FRIENDS]||[]).filter(function(a){return this.$32(a)}.bind(this)).map(function(a){return a.id}),c=babelHelpers["extends"]({},this.$10.defaultRepliesExpandedMap,this.$10.repliesExpandedMap),d=[];Object.keys(this.repliesMap).filter(function(a){return c[a]}).forEach(function(a){d=d.concat(this.repliesMap[a])}.bind(this));a=a.concat(d.filter(function(a){return this.$32(a)}.bind(this)).map(function(a){return a.id}));a.length>0&&(a.forEach(function(a){return this.$10.commentsLoadingTranslations[a]=!0}.bind(this)),b("Bootloader").loadModules(["UFIUserActions"],function(c){c.translateComments(this.$2.ftentidentifier,a,b("TranslationTrigger").TRANSLATE_ALL,{source:this.$2.source})}.bind(this),"UFIController"))};n.prototype.$32=function(a){return a.istranslatable&&!a.translationdata&&!this.$10.commentsLoadingTranslations[a.id]};n.prototype.canRenderHeader=function(){return!!this.$4.getHeadRoot()};n.prototype.renderHeader=function(a){if(!this.canRenderHeader())return;b("ReactDOM").render(b("React").createElement(b("UFIAsyncWrapper"),null,b("React").createElement(b("UFIActionHeader.react"),{contextArgs:this.$2,dispatcher:this.$3,feedbacktarget:a,stores:this.$11})),this.$4.getHeadRoot());var c=b("UFIRootRegistry").isSnowliftNode(this.$2.rootid);c&&this.$4.getSnowliftActionRoot()&&b("ReactDOM").render(b("React").createElement(b("UFIAsyncWrapper"),null,b("React").createElement(b("UFIDispatcherContext.react"),{dispatcher:this.$3,stores:this.$11},b("React").createElement(b("UFIActionLinks.react"),{contextArgs:this.$2,feedbacktarget:a,hideActorSelector:!0,hideBling:!0}))),this.$4.getSnowliftActionRoot())};n.prototype.shouldComponentUpdate=function(){if(this.$2.islivestreaming&&(this.$10.payloadSource===b("FeedbackPayloadSourceType").STREAMING||this.$10.payloadSource===b("FeedbackPayloadSourceType").LIVE_SEND)){var a=b("UFIVideoPlayerRegistry").getAvailableVideoPlayerController(this.$2.instanceid);a=a?a.isState("playing")&&!a.getOption("WatchAndScroll","isActive"):!1;var c=b("UFICommentVisibilityStore").getVisibility(b("UFICommentVisibilityStore").getState(),this.$2)===b("UFIVisibility").VISIBLE;return a||c}return!0};n.prototype.render=function(){__p&&__p();if(!this.shouldComponentUpdate())return;if(this.$10.showLoadingUFI||b("UFIOrderingModeStore").isLiveStreaming(this.$2.instanceid)&&b("UFIThreadedFacecastCommentsStore").getCommentID(this.$2.instanceid)==null&&this.$10.loadingVODComments){b("ReactDOM").render(b("React").createElement(b("UFIAsyncWrapper"),null,this.$33()),this.root);return}this.$10.feedback||h(0,undefined);var a=this.$10.feedback,c=a.reactionsentences,d=a.likesentences;a=a.replysocialsentencemaxreplies;c=this.comments[b("CommentSection").DEFAULT].length||this.comments[b("CommentSection").FRIENDS]&&this.comments[b("CommentSection").FRIENDS].length||!b("isEmpty")((c||d).current);d=this.$10.payloadSource;c&&k(d)&&this.$2.feedbackMode!==b("UFIFeedbackMode").NEVER&&(this.$10.isHidden=!1,b("CommentPrelude").expand(this.root,!1,"ufi_controller"));if(this.$2.disableCSSHiding&&this.$10.isHidden){b("ReactDOM").unmountComponentAtNode(this.root);return}if(this.$2.lazyFetch&&!this.$10.requestedInitialComments){b("ReactDOM").render(b("React").createElement(b("UFIAsyncWrapper"),null,this.$33()),this.root);this.$31();return}c=this.getRange(b("CommentSection").DEFAULT);this.$8===null&&(this.$8=c.getOffset()+c.getLength()-1);a=a||-1;var e={};e[this.$2.ftentidentifier]=new(b("UFIRange"))(c.offset,c.length).updateRequestedRange(c.requestedOffset,c.requestedLength);for(var f in this.replyRanges)e[f]=new(b("UFIRange"))(this.replyRanges[f].offset,this.replyRanges[f].length).updateRequestedRange(this.replyRanges[f].requestedOffset,this.replyRanges[f].requestedLength);var g=babelHelpers["extends"]({},this.$10.defaultRepliesExpandedMap,this.$10.repliesExpandedMap),i=!!this.$10.featuredCommentLists[this.$2.ftentidentifier];c=b("UFIOrderingModeStore").isLiveStreaming(this.$2.instanceid)?!0:this.getToplevelCommentList(b("CommentSection").DEFAULT).getClientHasAll()&&c.offset===0&&c.length===this.getToplevelCommentList(b("CommentSection").DEFAULT).getCommentCount();var j=this.$10.focusTopLevelComposer,l=this.$34(d),m=this.getOrderingMode(b("CommentSection").DEFAULT),n=this.comments[b("CommentSection").DEFAULT].concat(this.authorPinnedComment?this.authorPinnedComment:[]).filter(function(a){return a.id!==this.$10.authorPinnedCommentID}.bind(this)),o=this.comments[b("CommentSection").DEFAULT].concat(this.authorPinnedComment?this.authorPinnedComment:[]).filter(function(a){return a.id===this.$10.authorPinnedCommentID}.bind(this));o=o.length&&o[0];var p=this.comments[b("CommentSection").FRIENDS],q=(this.ranges[b("CommentSection").FRIENDS]||{})[b("WebCommentViewOption").TOPLEVEL],r=b("React").createElement(b("UFIDispatcherContext.react"),{dispatcher:this.$3,stores:this.$11},b("React").createElement(b("StaticUFI.react"),{ref:function(a){this.staticUFI=a}.bind(this),feedback:this.$10.feedback,contextArgs:this.$2,repliesMap:this.repliesMap,commentCounts:this.commentCounts,deletedCounts:this.$10.deletedCounts[b("CommentSection").DEFAULT],privateDeletedCounts:this.$10.deletedCounts[b("CommentSection").FRIENDS],availableComments:n,availablePrivateComments:p,source:this.$2.source,payloadSource:d,ranges:e,authorProfiles:this.authorProfiles,loggingOffset:this.$8,replySocialSentenceMaxReplies:a,orderingMode:m,hideOrderingModeSelector:i,commentPermalinks:this.$10.commentPermalinks,canAddCommentMap:this.$10.canAddCommentMap,canReplyMap:this.$10.canReplyMap,focusTopLevelComposer:j,focusReply:l,isActiveLoading:this.$10.isActiveLoading,allSeenActiveLoadDirectionData:this.$10.allSeenActiveLoadDirectionData,repliesExpandedMap:g,hasPagedToplevel:this.$10.hasPagedToplevel,commentIDToFocusOnMount:this.$10.commentIDToFocusOnMount,hideToplevelPager:c,featuredCommentIDs:this.$10.featuredCommentIDs,loadingTranslationsMap:this.$10.commentsLoadingTranslations,translateAllCommentID:this.$10.translateAllCommentID,privateCommentsCount:this.privateCommentsCount,privateCommentsRange:q,loadingCommentsForSection:this.$10.loadingCommentsForSection,authorPinnedComment:o}));if(this.$2.enableAsyncFacecastUFI){var s=this.reactRoot?this.reactRoot:this.reactRoot=b("ReactDOM").unstable_createRoot(this.root);d===b("FeedbackPayloadSourceType").INITIAL_SERVER?b("ReactDOM").flushSync(function(){s.render(r,this.componentDidRender)}.bind(this)):s.render(r,this.componentDidRender)}else b("ReactDOM").render(b("React").createElement(b("UFIAsyncWrapper"),null,r),this.root,this.componentDidRender);b("LiveTimer").updateTimeStamps();n=this.$4.getParentForm();n&&b("Arbiter").inform(b("UFIUIEvents").Changed,{form:n});d!=b("FeedbackPayloadSourceType").INITIAL_SERVER&&b("Arbiter").inform("reflow");this.$10.focusedReplyComposer=null;this.$10.focusTopLevelComposer=!1};n.prototype.$35=function(a){return this.commentsToSection[a]||b("CommentSection").DEFAULT};n.prototype.$34=function(a){if(a===b("FeedbackPayloadSourceType").INITIAL_SERVER&&this.$10.feedback&&this.$10.feedback.permalinkcommentid)return{replyID:"replycomposer-"+this.$10.feedback.permalinkcommentid};else if(this.$10.focusedReplyComposer)return this.$10.focusedReplyComposer;return null};n.prototype.$28=function(a,c,d){var e=(this.$10.oldRange||{})[b("CommentSection").DEFAULT];if(e&&(e.offset!=a||e.length!=c)){a=a<e.offset?e.length:0;if(a<c)return this.comments[d][a].id}return this.$10.commentIDToFocusOnMount};n.prototype.$36=function(a,b,c){if(a&&b.id===a.permalinkcommentid)return!0;if(c>1)return!0;if(c>0&&b.interestingReplyOffset===undefined)return!0;b=a&&b.author===a.viewerid;return b&&c==1?!0:!1};n.prototype.getNewRange=function(a,c,d,e){if(b("UFIOrderingModeStore").isLiveStreaming(this.$2.instanceid))return new(b("UFIRange"))(0,c.feedcarded?4:50);else{c=e===b("CommentSection").FRIENDS?this.privateCommentsCount:this.commentCounts[c.ftentidentifier];return j(this.getRange(e),c,d,a)}};n.prototype.getNewReplyRange=function(a,c,d){var e=c.id;if(this.replyRanges[e])return j(this.getReplyRange(e),this.commentCounts[e],d,a);else if(c.interestingReplyOffset!==undefined)return new(b("UFIRange"))(c.interestingReplyOffset,1);else{e=this.$10.feedback&&this.$10.feedback.isranked;a=e?0:Math.min(d,2);return new(b("UFIRange"))(0,a)}};n.prototype.fetchAndUpdateWithLogs=function(a,b,c,d){a===this.$10.payloadSource||h(0,undefined),this.$37(a,!0,b,c,d)};n.prototype.fetchAndUpdate=function(a,b,c,d){a===this.$10.payloadSource||h(0,undefined),this.$37(a,!1,b,c,d)};n.prototype.$38=function(a,b,c,d){var e=this.getOrderingMode(b);b=(this.$10.toplevelPagerClickCounts[b]||{})[e]||0;return{numPagerClicks:a?b:null,viewAs:this.$2.viewas,feedContext:this.$2.feedcontext,feedbackSource:this.$2.source,streamingOrderReversed:this.$2.streamingCommentOrderReversed,direction:c,interactionRequestCorrelationID:d}};n.prototype.$39=function(a,b){return{numPagerClicks:b?this.$10.replyPagerClickCounts[a]||0:null,viewAs:this.$2.viewas,feedContext:this.$2.feedcontext}};n.prototype.$40=function(a,c){__p&&__p();var d=this.$10.feedback,e=this.getToplevelCommentList(c),f=this.getNewRange(a,this.$2,e.getCommentCount(),c);e=b("UFIFetcher").fetchCommentsOrThrow(e,f,this.$38(!1,c));this.$41(f,e,c);var g=b("UFICommentFilters").getAuthors(e);c===b("CommentSection").DEFAULT&&this.authorPinnedComment&&(e=[].concat(e,[this.authorPinnedComment]));e.forEach(function(d){var e=d.id,f=this.getReplyCommentList(e),c=this.getNewReplyRange(a,d,f.getCommentCount());f=b("UFIFetcher").fetchCommentsOrThrow(f,c,this.$39(e,!1));g.push.apply(g,b("UFICommentFilters").getAuthors(f));this.$42(c,d,f)}.bind(this));d&&g.push.apply(g,b("UFIFeedbackFilters").getRequestedIDs(d));f=b("UFILivePinnedCommentStore").getPinnedCommentAuthorID(this.$2.ftentidentifier);f&&g.push(f);if(d&&d.acceptedanswer){c=b("UFIComments").getComment(d.acceptedanswer);c&&c.author&&g.push(c.author)}Object.assign(this.authorProfiles,b("ShortProfiles").getMultiNow(g))};n.prototype.$37=function(a,c,d,e,f){__p&&__p();var g=b("UFIFeedbackTargets").getFeedbackTargetIfExists(this.$2.ftentidentifier);if(!g){b("FBLogger")("ufi").warn("Feedback target %s not present while rendering UFI with source %s",this.$2.ftentidentifier,a);return}this.$10.feedback=g;k(a)&&this.render();this.canRenderHeader()&&this.renderHeader(g);this.$10.isHidden||(a===b("FeedbackPayloadSourceType").INITIAL_SERVER?(this.$40(a,d),this.$3.dispatch(b("UFIStoryAction").commentsArrived(this.$2,this.getRange(d).getOffset(),this.comments[d].length,a,d,f,this.$43()))):b("promiseDone")(this.fetchAllComments(a,c,d,e,f),function(){return this.$3.dispatch(b("UFIStoryAction").commentsArrived(this.$2,this.getRange(d).getOffset(),this.comments[d].length,a,d,f))}.bind(this)))};n.prototype.fetchAllComments=function(a,c,d,e,f){__p&&__p();return b("Promise").resolve().then(function(){return this.fetchCommentsForFeedbackTarget(a,c,d,e,f).then(function(e){d===b("CommentSection").DEFAULT&&this.authorPinnedComment&&(e=[].concat(e,[this.authorPinnedComment]));var f=b("UFICommentFilters").getAuthors(e);return!this.$10.feedback||!this.$10.feedback.isthreaded||!e.length?f:this.fetchAllReplyIDsForComments(e,a,c).then(function(a){return f.concat(a)})}.bind(this)).then(function(a){return!this.$10.feedback?[]:b("UFIFeedbackFilters").getRequestedIDs(this.$10.feedback).concat(a)}.bind(this))}.bind(this)).then(function(a){var c=this.$10.feedback,d=b("UFILivePinnedCommentStore").getPinnedCommentAuthorID(this.$2.ftentidentifier);d&&a.push(d);if(c&&c.acceptedanswer){d=b("UFIComments").getComment(c.acceptedanswer);d&&d.author&&a.push(d.author)}return b("UFIFetcher").fetchShortProfiles(a)}.bind(this)).then(function(a){return Object.assign(this.authorProfiles,a)}.bind(this))};n.prototype.fetchCommentsForFeedbackTarget=function(a,c,d,e,f){var g=this.getToplevelCommentList(d).getCommentCount(),h=this.getNewRange(a,this.$2,g,d);return b("UFIFetcher").fetchComments(this.getToplevelCommentList(d),h,this.$38(c,d,e,f)).then(function(a){this.$41(h,a,d);return a}.bind(this))};n.prototype.$41=function(a,c,d){__p&&__p();var e=this.getToplevelCommentList(d),f=this.$2.ftentidentifier,g=b("gkx")("AT5ldFc5v5GGkr2Zzs_R8Q_QyiR0b4FwHpvACvcQdH2iAHS32O5Wm9G0pb957V8k6SXQTyRrFqU2AXpZbRy1-rij")||b("gkx")("AT4KnEHLf7QpqHhDGNJ0C0nw8HSso1dUK19KBz-LkLuw5mY1Ntx6TeJcl9V_z3QbtiYInXSqrLUyDr8znV8wDus1"),h=this.$10,i=h.deletedCounts,j=h.canAddCommentMap,k=h.canReplyMap,l=h.commentPermalinks;this.replaceRange(a,d);this.comments[d]=c;d===b("CommentSection").DEFAULT?this.commentCounts[f]=e.getCommentCount():this.privateCommentsCount=e.getCommentCount();c.forEach(function(a){var c=a.id,f=a.cancomment,h=a.fbid,i=a.voteEnabled,j=a.voteCount;a=a.voteState;k[c]=f;l[c]=e.getPermalinkForComment(c);this.commentsToSection[c]=d;g&&i&&h&&this.$3.dispatch(b("UFICommentAction").updateVoteCountAndState(this.$2,h,j?j:0,a?a:b("UFIConstants").UFICommentVoteType.NONE))}.bind(this));i[d]||(i[d]={});i[d][f]=e.getDeletedCount();j[f]=!this.$10.featuredCommentLists[f]};n.prototype.fetchRepliesForComment=function(a,c,d){var e=a.id,f=this.getReplyCommentList(e).getCommentCount(),g=this.getNewReplyRange(c,a,f);return b("UFIFetcher").fetchComments(this.getReplyCommentList(e),g,this.$39(e,d)).then(function(b){this.$42(g,a,b);return b}.bind(this))};n.prototype.$42=function(a,c,d){__p&&__p();var e=c.id,f=this.getReplyCommentList(e),g=this.$10,h=g.deletedCounts,i=g.canAddCommentMap,j=g.featuredCommentLists,k=g.defaultRepliesExpandedMap,l=g.feedback,m=g.canReplyMap,n=g.commentPermalinks;this.replaceReplyRange(e,a);this.repliesMap[e]=d;this.commentCounts[e]=f.getCommentCount();h[b("CommentSection").DEFAULT][e]=f.getDeletedCount();i[e]=!j[e];k[e]=this.$36(l,c,d.length);d.forEach(function(a){var b=a.id;a=a.cancomment;m[b]=a;n[b]=f.getPermalinkForComment(b)})};n.prototype.$43=function(){var a;return this.$2.islivestreaming&&((a=this.$2)!=null?(a=a.liveVideoThreadedCommentsConfig)!=null?a.enable_replies:a:a)?(a=this.$10)!=null?(a=a.feedback)!=null?a.permalinkcommentid:a:a:null};n.prototype.fetchAllReplyIDsForComments=function(a,c,d){a=new(b("Promise").all)(a.map(function(a){return this.fetchRepliesForComment(a,c,d).then(function(a){return b("UFICommentFilters").getAuthors(a)})}.bind(this)));return a.then(b("flattenArray"))};n.prototype.getToplevelCommentList=function(a){var c=this.$2;if(this.$10.featuredCommentLists[c.ftentidentifier])return this.$10.featuredCommentLists[c.ftentidentifier];if(b("UFIOrderingModeStore").isLiveStreaming(this.$2.instanceid))return b("UFIToplevelStreamedCommentList").getCommentList(c.ftentidentifier,c.islivestreaming?b("UFIToplevelStreamedCommentList").GLOBAL_ID:c.instanceid);var d=this.getOrderingMode(a);return b("UFIToplevelPagedCommentList").getCommentList(c.ftentidentifier,d,a)};n.prototype.getReplyCommentList=function(a){if(a in this.$10.featuredCommentLists)return this.$10.featuredCommentLists[a];var c=this.commentsToSection[a]||b("CommentSection").DEFAULT;c=this.getOrderingMode(c);return b("UFIReplyCommentList").getCommentList(this.$2.ftentidentifier,a,c)};n.prototype.getRange=function(a){var c=this.getOrderingMode(a);this.ranges[a]=this.ranges[a]||{};if(!(c in this.ranges[a])){var d=this.getToplevelCommentList(a).getCommentCount(),e=Math.min(d,this.$2.defaultNumCommentsToExpand);this.ranges[a][c]=new(b("UFIRange"))(d-e,e)}return this.ranges[a][c]};n.prototype.replaceRange=function(a,b){var c=this.getOrderingMode(b);this.ranges[b]=this.ranges[b]||{};this.ranges[b][c]=a};n.prototype.getReplyRange=function(a){a in this.replyRanges||(this.replyRanges[a]=new(b("UFIRange"))());return this.replyRanges[a]};n.prototype.replaceReplyRange=function(a,b){this.replyRanges[a]=b};n.prototype.$17=function(){this.$6=!0,this.$25(),this.$44()};n.prototype.$44=function(){this.$45(),this.$46(),this.$23(),this.$47(),this.$48(),this.$49(),this.$50(),this.onUnloadSubscription&&this.onUnloadSubscription.remove(),b("UFISharedDispatcher").dispatch(b("UFIInstanceAction").remove(this.$2))};n.prototype.$21=function(){this.$23()};n.prototype.$50=function(){var a=this.$2;b("UFIPlayLiveVODHighlightsAdapter").stop(a.instanceid)};n.prototype.$49=function(){var a=this.$2;b("UFICommercialBreakAdapter").stop(a.instanceid)};n.prototype.$48=function(){var a=this.$2;b("UFIVODStreamingComments").stop(a.ftentidentifier,a.instanceid)};n.prototype.$45=function(){this.ufiCentralUpdatesSubscriptions.forEach(function(a){return a&&b("UFICentralUpdates").unsubscribe(a)})};n.prototype.$46=function(){this.$1&&this.$1.release()};n.prototype.$23=function(){this.$7&&this.$7.release()};n.prototype.$47=function(){this.$12&&(this.$12.release(),this.$12=null),this.$9.forEach(function(a){return b("UFISharedDispatcher").unregister(a)})};n.prototype.$33=function(){var a=this.$2;return b("React").createElement(b("UFIDispatcherContext.react"),{dispatcher:this.$3,stores:this.$11},b("React").createElement(b("StaticUFI.react"),{feedback:this.$10.feedback,id:this.$2.ftentidentifier,contextArgs:a,commentCounts:this.commentCounts,loadingComments:!0}))};n.prototype.shouldShowCommentOrderingModeSelector=function(a){var c=this.getToplevelCommentList(b("CommentSection").DEFAULT).getCommentCount()||a.commentcount||0;return a.orderingmodes&&c>=b("UFIConstants").minCommentsForOrderingModeSelector&&!this.$10.featuredCommentLists[this.$2.ftentidentifier]};e.exports=n}),null);