if (self.CavalryLogger) { CavalryLogger.start_js(["MbWHf"]); }

__d("FlipDirectionOnKeypress",["Event","FlipDirection"],(function(a,b,c,d,e,f){a=function(event){var a=event.getTarget();b("FlipDirection").setDirection(a)};b("Event").listen(document.documentElement,{keyup:a,input:a})}),null);
__d("ChatInputBasic.react",["cx","fbt","FocusListener","FlipDirectionOnKeypress","MercuryIDs","MercuryThreadIDMap","MessengerUploadFilesUtil.bs","React","ReactDOM","TextAreaControl","TypingDetectorController","setImmediate"],(function(a,b,c,d,e,f,g,h){"use strict";__p&&__p();b("FocusListener");b("FlipDirectionOnKeypress");var i=b("MercuryThreadIDMap").get();a=b("React").PropTypes;c=b("React").createClass({displayName:"ChatInputBasic",_oldHeight:undefined,_textAreaControl:undefined,_typingDetector:undefined,propTypes:{fileUploader:a.object,inputKeyDown:a.func.isRequired,onFocus:a.func,placeholder:a.string,threadID:a.string.isRequired,uploadPhotoFn:a.func},getInitialState:function(){return{value:""}},componentDidMount:function(){this._oldHeight=b("ReactDOM").findDOMNode(this).getBoundingClientRect().height;this._textAreaControl=b("TextAreaControl").getInstance(this.refs.input);var a=this.props.threadID,c=b("ReactDOM").findDOMNode(this.refs.input);c&&i.getServerIDFromClientID(a,function(d){this._typingDetector=new(b("TypingDetectorController"))(b("MercuryIDs").getUserIDFromThreadID(a),c,"mercury-chat",null,d,this.getValue)}.bind(this))},componentDidUpdate:function(){b("setImmediate")(function(){var a=b("ReactDOM").findDOMNode(this).getBoundingClientRect().height;this._oldHeight=a}.bind(this))},componentWillUnmount:function(){this._typingDetector&&this._typingDetector.destroy()},onChange:function(a){this._textAreaControl&&this._textAreaControl.onupdate(),this.setState({value:a.target.value||""})},focus:function(){this.refs.input.focus()},getValue:function(){return this.state.value},onSend:function(){b("MessengerUploadFilesUtil.bs").sendAttchments(this.props.fileUploader,this.props.uploadPhotoFn),this.resetState()},resetState:function(){this.setState(this.getInitialState())},appendText:function(a){this.setState({value:this.state.value+a})},handleInputKeyDown:function(a){this.props.inputKeyDown&&this.props.inputKeyDown(a,this.state.value)},render:function(){return b("React").createElement("textarea",babelHelpers["extends"]({ref:"input"},this.props,{placeholder:h._("Type a message..."),value:this.state.value,onChange:this.onChange,onKeyDown:this.handleInputKeyDown,autogrow:"true",className:"_552m uiTextareaNoResize uiTextareaAutogrow","data-jsid":"input"}))}});e.exports=c}),null);