if (self.CavalryLogger) { CavalryLogger.start_js(["KT97C"]); }

__d("DoublyLinkedListMap",[],(function(a,b,c,d,e,f){__p&&__p();function a(){"use strict";this._head=null,this._tail=null,this._nodes={},this._nodeCount=0}a.prototype.get=function(a){a=(a=this._nodes[a])!=null?a.data:a;return a?a:null};a.prototype.getIndex=function(a){"use strict";var b=this._head;for(var c=0;b;b=b.next,c++)if(b.key===a)return c;return null};a.prototype._insert=function(a,b,c,d){"use strict";__p&&__p();c&&!this._nodes[c]&&(c=null);c&&this._nodes[c]?c=this._nodes[c]:c=d?this._head:this._tail;b={data:b,key:a,next:null,prev:null};c&&(this.remove(a),d?(b.prev=c.prev,c.prev&&(c.prev.next=b),c.prev=b,b.next=c):(b.next=c.next,c.next&&(c.next.prev=b),c.next=b,b.prev=c));b.prev===null&&(this._head=b);b.next===null&&(this._tail=b);this._nodes[a]=b;this._nodeCount++;return this};a.prototype.insertBefore=function(a,b,c){"use strict";return this._insert(a,b,c,!0)};a.prototype.insertAfter=function(a,b,c){"use strict";return this._insert(a,b,c,!1)};a.prototype.prepend=function(a,b){"use strict";return this.insertBefore(a,b,this._head&&this._head.key)};a.prototype.append=function(a,b){"use strict";return this.insertAfter(a,b,this._tail&&this._tail.key)};a.prototype.remove=function(a){"use strict";__p&&__p();var b=this._nodes[a];if(b){var c=b.next,d=b.prev;c&&(c.prev=d);d&&(d.next=c);this._head===b&&(this._head=c);this._tail===b&&(this._tail=d);delete this._nodes[a];this._nodeCount--}return this};a.prototype.find=function(a){"use strict";for(var b=this._head;b;b=b.next)if(a(b.data))return b.key;return null};a.prototype.reduce=function(a,b){"use strict";for(var c=this._head;c;c=c.next)b=a(c.data,b);return b};a.prototype.exists=function(a){"use strict";return!!this._nodes[a]};a.prototype.isEmpty=function(){"use strict";return!this._head};a.prototype.reset=function(){"use strict";this._head=null,this._tail=null,this._nodes={},this._nodeCount=0};a.prototype.map=function(a){"use strict";for(var b=this._head;b;b=b.next)a(b.data)};a.prototype.getCount=function(){"use strict";return this._nodeCount};a.prototype.getHead=function(){var a;return(a=this._head)!=null?a.data:a};a.prototype.getTail=function(){var a;return(a=this._tail)!=null?a.data:a};a.prototype.getNext=function(a){return(a=this._nodes[a])!=null?(a=a.next)!=null?a.data:a:a};a.prototype.getPrev=function(a){return(a=this._nodes[a])!=null?(a=a.prev)!=null?a.data:a:a};a.prototype.getHeadKey=function(){var a;return(a=this._head)!=null?a.key:a};a.prototype.getTailKey=function(){var a;return(a=this._tail)!=null?a.key:a};e.exports=a}),null);
__d("ProfileOverviewSection",["CallbackDependencyManager","DOMScroll","DoublyLinkedListMap","TidyArbiterMixin","ge"],(function(a,b,c,d,e,f){__p&&__p();var g=null,h=new(b("CallbackDependencyManager"))(),i={};function a(a,c,d){"use strict";this.id=a,this.label=d,this.nodeID=c,this._isLoaded=!1,this._parentSection=null,this.childSections=new(b("DoublyLinkedListMap"))(),i[a]=this,setTimeout(function(){return h.satisfyPersistentDependency(a)},0)}a.prototype.reset=function(){"use strict";this.childSections.map(function(a){return a.reset()})};a.prototype.appendSection=function(a){"use strict";this.childSections.append(a.id,a),a._parentSection=this};a.prototype.freeze=function(){"use strict";this.freezeChildren()};a.prototype.freezeChildren=function(){"use strict";var a=this.childSections.getHead();while(a)a.isActive()||a.freeze(),a=a.getNext()};a.prototype.getParent=function(){"use strict";return this._parentSection};a.prototype.getChildren=function(){"use strict";return this.childSections};a.prototype.getNext=function(){"use strict";return this._parentSection&&this._parentSection.childSections.getNext(this.id)};a.prototype.getPrev=function(){"use strict";return this._parentSection&&this._parentSection.childSections.getPrev(this.id)};a.prototype.isActive=function(){"use strict";var a=this;while(a){if(a.id===g)return!0;a=a._parentSection}return!1};a.prototype.isLoaded=function(){"use strict";return this._isLoaded};a.prototype.setIsLoaded=function(a){"use strict";this._isLoaded=a;return this};a.prototype.scrollTo=function(){"use strict";if(!b("ge")(this.nodeID))return;b("DOMScroll").scrollTo(this.getNode(),!0,!1,0,0,b("DOMScroll").scrollTo.bind(this).bind(null,this.getNode(),0))};a.prototype.thaw=function(){"use strict";this.thawChildren()};a.prototype.thawChildren=function(){"use strict";var a=this.childSections.getHead();while(a)a.thaw(),a=a.getNext()};a.prototype.getNode=function(){"use strict";throw new Error("This function needs to be implemented in children.")};a.callWithSection=function(a,b){"use strict";h.registerCallback(function(){b(i[a])},[a])};a.setActiveSectionID=function(a){"use strict";g=a};a.resetGlobalState=function(){"use strict";g=null,h=new(b("CallbackDependencyManager"))(),i={}};Object.assign(a,b("TidyArbiterMixin"));e.exports=a}),null);
__d("ProfileNavigation",["Arbiter","CSS","DOMScroll","PageTransitions","ProfileDOMID","ProfileScriptPath","ProfileTabConst","ProfileTabUtils","ScriptPath","TimelineController","TimelineURI","UIPagelet","URI","$","ge"],(function(a,b,c,d,e,f){__p&&__p();var g=7,h=null,i=null;function j(a){__p&&__p();var c=b("URI").getMostRecentURI(),d=b("TimelineURI").getSectionKeyFromURI(c),e=b("TimelineURI").getTabKeyFromURI(c),f=c.getQueryData();f=f.subkey;var g=b("TimelineURI").getSectionKeyFromURI(a),i=b("TimelineURI").getTabKeyFromURI(a),j=a.getQueryData(),l=j.subkey;if(q(c,a)||r(i)||r(e)||!!j.and||b("TimelineURI").isVideoPermalink(a))return!1;if(j.hc_location==="profile_browser")return!1;if(Object.prototype.hasOwnProperty.call(j,"theater")){b("Arbiter").subscribeOnce("PhotoSnowlift.CLOSE",s);return!1}if(Object.prototype.hasOwnProperty.call(j,"force-refresh"))return!1;if(b("ProfileTabUtils").normalizeTabKey(e)===b("ProfileTabUtils").normalizeTabKey(i)&&b("ProfileTabUtils").normalizeTabKey(d)===b("ProfileTabUtils").normalizeTabKey(g)&&f===l)return!1;if(!b("ProfileTabUtils").isMedleyTab(e)&&b("ProfileTabUtils").isMedleyTab(i)&&p(g)){h=g;k(g,b("ProfileTabUtils").getPageletForTabKey(i),b("ProfileTabUtils").getIDForTabKey(e),b("ProfileTabUtils").getIDForTabKey(i),j);return!0}if(!b("ProfileTabUtils").isMedleyTab(i)){b("ProfileTabUtils").isMedleyTab(e)&&(h=d);k(b("ProfileTabUtils").normalizeTabKey(i),b("ProfileTabUtils").getPageletForTabKey(i),b("ProfileTabUtils").getIDForTabKey(e),b("ProfileTabUtils").getIDForTabKey(i),j);return!0}return!1}function k(a,c,d,e,f){__p&&__p();var g=b("ge")("fbTimelineHeadline");g&&!b("DOMScroll").isCurrentlyVisible(g)&&window.scrollTo(0,0);b("CSS").hide(b("$")(d));b("Arbiter").inform("save_facebar_query",!0);g=b("ge")(e);g?(b("CSS").show(g),o(a)):l(c,a,f);d=b("ge")("pageFooter");d&&b("CSS").conditionShow(d,!b("ProfileTabUtils").isTimelineTab(a));e=f&&f.subkey?String(f.subkey):null;b("TimelineController").registerCurrentKey(a,e)}function l(a,c,d){m();var e=babelHelpers["extends"]({},i,{tab_key:c});d&&(e=babelHelpers["extends"]({},e,d));d=function(a){n(),a()};d={append:!0,displayCallback:d,finallyHandler:o.bind(null,c),usePipe:!0};b("UIPagelet").loadFromEndpoint(a,b("ProfileDOMID").MAIN_COLUMN_PERSONAL,e,d)}function m(){b("CSS").show(b("$")(b("ProfileDOMID").TAB_LOAD_INDICATOR))}function n(){b("CSS").hide(b("$")(b("ProfileDOMID").TAB_LOAD_INDICATOR))}function o(a){b("ScriptPath").set(t.getScriptPath(a),null,{entity_id:b("TimelineController").getProfileID(),profile_session_id:b("TimelineController").getSessionToken()}),b("PageTransitions").transitionComplete()}function p(a){return h===null||a===h}function q(a,c){var d=b("TimelineURI").getVanityFromURI(a);a=a.getQueryData().id;var e=b("TimelineURI").getVanityFromURI(c);c=c.getQueryData().id;if(d&&e)return d!==e;return a&&c?a!==c:!0}function r(a){return b("ProfileTabUtils").isActivityLogTab(a)||a===b("ProfileTabConst").MEMORIAL_CONTACT||a===b("ProfileTabConst").POSTS}function s(){b("PageTransitions").registerHandler(j,g)}var t={init:function(a){i=a.profileContextData,s()},reset:function(){i=null,h=null,b("PageTransitions").removeHandler(j)},getScriptPath:function(a){var c=b("ProfileScriptPath").path;a&&!b("ProfileTabUtils").isTimelineTab(a)&&(c+=":"+a);return c}};e.exports=t}),null);
__d("TimelineDrag",["ArbiterMixin","Event","Locale","Style","Vector","mixin"],(function(a,b,c,d,e,f){__p&&__p();var g;c=babelHelpers.inherits(a,b("mixin")(b("ArbiterMixin")));g=c&&c.prototype;function a(a,b,c){"use strict";g.constructor.call(this),c=c||{},this._listenOn=c.listenOn,this._offsetInput=b,this._defaultOffset=c.default_offset,this._killClicks=c.killClicks,this._vertical=!0,this._RTLXSwitch=!1,this.setPicture(a,c)}a.prototype.setPicture=function(a,c){"use strict";__p&&__p();if(!a)return!1;c=c||{};this._picture=a;this._defaultOffset=c.default_offset;c.offsetInput&&(this._offsetInput=c.offsetInput);c.vertical!==undefined&&(this._vertical=c.vertical);c.height&&(this._containerHeight=c.height);c.width&&(this._containerWidth=c.width);this._vertical?(this._offsetType="top",this._eventCoord="y"):(this._RTLXSwitch=b("Locale").isRTL(),this._offsetType="left",this._eventCoord="x");this._picture.complete?this._initialLoad():this._loadListener=b("Event").listen(this._picture,"load",function(){this._loadListener.remove(),this._loadListener=null,this._initialLoad()}.bind(this))};a.prototype.destroy=function(){"use strict";this._stopDrag(),this._saveOffset(),this._mousedown&&this._mousedown.remove(),this._mousedown=null,this._touch&&this._touch.remove(),this._touch=null,this._onclick&&this._onclick.remove(),this._onclick=null,this._loadListener&&this._loadListener.remove(),this._loadListener=null};a.prototype._initialLoad=function(){"use strict";__p&&__p();var a=this._listenOn?this._listenOn:this._picture;this._mousedown&&this._mousedown.remove();this._mousedown=b("Event").listen(a,"mousedown",this._onMouseDown.bind(this));this._touch&&this._touch.remove();this._touch=b("Event").listen(a,"touchstart",this._onTouchStart.bind(this));this._vertical?this._maxOffset=this._containerHeight-this._picture.offsetHeight:this._maxOffset=this._containerWidth-this._picture.offsetWidth;this._defaultOffset!==undefined&&this._setOffset(this._defaultOffset);this._onclick&&this._onclick.remove();this._onclick=null;this._killClicks&&(this._onclick=b("Event").listen(a,"click",this._onClick.bind(this)));this._saveOffset()};a.prototype._onClick=function(event){"use strict";event.kill()};a.prototype._onDragStart=function(a){"use strict";var c=parseInt(b("Style").get(this._picture,this._offsetType),10)||0;this._pictureStartDragOffset=c-a[this._eventCoord];this._startDrag();event.kill()};a.prototype._onMouseDown=function(event){"use strict";this._onDragStart(b("Vector").getEventPosition(event))};a.prototype._onTouchStart=function(event){"use strict";this._onDragStart(b("Vector").getTouchEventPosition(event))};a.prototype._startDrag=function(){"use strict";this._dragStarted||(this.inform("startdrag",this),this._dragTokens=[b("Event").listen(document.documentElement,"mouseup",this._onDragEnd.bind(this)),b("Event").listen(document.documentElement,"touchend",this._onDragEnd.bind(this)),b("Event").listen(document.documentElement,"mousemove",this._onMouseMove.bind(this)),b("Event").listen(document.documentElement,"touchmove",this._onTouchMove.bind(this))],this._dragStarted=!0)};a.prototype._saveOffset=function(){"use strict";var a=parseInt(b("Style").get(this._picture,this._offsetType),10);this._RTLXSwitch?this._offsetInput.value=a+this._containerWidth-this._picture.offsetWidth:this._offsetInput.value=a};a.prototype._stopDrag=function(){"use strict";this._dragStarted&&(this.inform("stopdrag",this),this._dragStarted=!1,this._dragTokens.forEach(function(a){a.remove()}),this._saveOffset())};a.prototype._onDragEnd=function(event){"use strict";this._stopDrag(),event.kill()};a.prototype._setOffset=function(a){"use strict";this._RTLXSwitch?a=Math.max(0,Math.min(a,-this._maxOffset)):a=Math.min(0,Math.max(a,this._maxOffset)),b("Style").set(this._picture,this._offsetType,a+"px")};a.prototype._onHandleMove=function(a){"use strict";this._setOffset(this._pictureStartDragOffset+a[this._eventCoord]),event.kill()};a.prototype._onMouseMove=function(event){"use strict";this._onHandleMove(b("Vector").getEventPosition(event))};a.prototype._onTouchMove=function(event){"use strict";this._onHandleMove(b("Vector").getTouchEventPosition(event))};e.exports=a}),null);
__d("TimelineCover",["csx","cx","fbt","Arbiter","Button","CSS","Dialog","DOM","DOMScroll","FileInputUploader","Focus","HTML","PageTransitions","Parent","ReloadPage","Run","Style","TimelineDrag","ge","setImmediate","tidyEvent"],(function(a,b,c,d,e,f,g,h,i){__p&&__p();function j(a,c,d){"use strict";this.root=b("Parent").bySelector(a,"#fbProfileCover"),typeof c==="object"?(this._coverHeight=c.cover_height,this._coverWidth=c.cover_width,this.previewing=c.previewing,this._isLegacy=!1):(this._isLegacy=!0,this._coverHeight=c,this.previewing=d),this._parentSection=b("Parent").byClass(this.root,"fbTimelineSection"),this.cover=b("DOM").find(this.root,".cover"),j.instance=this,this.editing=!1,b("Run").onBeforeUnload(this.onBeforeUnload.bind(this)),this._parentSection||(this._parentSection=b("Parent").byClass(this.root,"fbEventHeader")),this.previewing&&b("setImmediate")(function(){this.editMode(),this.updateCoverImage(this.previewing)}.bind(this))}j.prototype.showLoadingIndicator=function(){"use strict";var a=b("ge")("fbCoverImageContainer");a&&b("CSS").addClass(a,"opaquedLoading")};j.prototype.hideLoadingIndicator=function(){"use strict";var a=b("ge")("fbCoverImageContainer");a&&b("CSS").removeClass(a,"opaquedLoading")};j.prototype.onBeforeUnload=function(){"use strict";if(this.isInEditMode())return i._("If you leave this page, your cover photo will not be saved. To save, press the \"save\" button below your cover photo.")};j.prototype.isCoverImageVerticalFlow=function(a){"use strict";return a===null||a===undefined?!0:!a.style.height};j.prototype.editMode=function(){"use strict";__p&&__p();var a=b("DOM").find(this.root,"button.saveButton");b("Button").setEnabled(b("DOM").find(this.root,"button.cancelButton"),!0);b("Button").setEnabled(a,!0);this.hideLoadingIndicator();this._coverImage=b("DOM").scry(this.root,".coverImage")[0];if(this._coverImage){var c=b("DOM").scry(this._coverImage,".coverWrap")[0];if(c){c=b("DOM").scry(c,".coverPhotoImg")[0];this._originalIsVertical=this.isCoverImageVerticalFlow(c);this._originalOffset=b("Style").get(c,this._originalIsVertical?"top":"left")}}this._parentSection!==null&&b("CSS").addClass(this._parentSection,"fbEditCover");b("DOMScroll").scrollTo(this.root);this.previewing&&(b("DOM").remove(this._coverImage),b("CSS").show(this._coverImage));if(this._coverImage){c=b("DOM").scry(this._coverImage,".coverPhotoImg")[0];c&&this._createDragger()}this.editing=!0;b("Focus").set(a);b("Arbiter").inform("CoverPhotoEdit",{sender:this,state:"open"})};j.prototype._exitEditMode=function(){"use strict";this._timelineDrag&&(this._timelineDrag.destroy(),this._timelineDrag=null),b("DOM").find(this.root,"input.hiddenPhotoID").value=null,b("Button").setEnabled(b("DOM").find(this.root,"button.cancelButton"),!1),b("Button").setEnabled(b("DOM").find(this.root,"button.saveButton"),!1),this._parentSection!==null&&b("CSS").removeClass(this._parentSection,"fbEditCover"),this.hideLoadingIndicator(),this.previewing=!1,b("Arbiter").inform("CoverPhotoEdit",{sender:this,state:"closed"}),this.editing=!1};j.prototype._createDragger=function(a){"use strict";var c,d;this._isLegacy?(c=b("DOM").find(this.root,"input.photoOffsetInput"),this._originalIsVertical=!0):(d=a===undefined?this._originalIsVertical:a,c=d?b("DOM").find(this.root,"input.photoOffsetYInput"):b("DOM").find(this.root,"input.photoOffsetXInput"));this._timelineDrag=new(b("TimelineDrag"))(b("DOM").scry(this.root,".coverImage .coverPhotoImg")[0],c,{height:this._coverHeight,width:this._coverWidth,listenOn:this.cover,vertical:d,killClicks:!0})};j.prototype.updateCoverImage=function(a,c){"use strict";__p&&__p();this._reloadAfterNextUpdate=!0;c&&this.editMode();b("DOM").find(this.root,"input.hiddenPhotoID").value=a;b("Button").setEnabled(b("DOM").find(this.root,"button.saveButton"),!0);c&&b("DOM").replace(b("DOM").scry(this.root,".coverImage")[0],typeof c==="string"?b("HTML")(c):c);a=b("DOM").scry(b("DOM").find(this.root,".coverImage"),".coverPhotoImg")[0];c=this.isCoverImageVerticalFlow(a);var d;this._isLegacy?d=b("DOM").find(this.root,"input.photoOffsetInput"):d=c?b("DOM").find(this.root,"input.photoOffsetYInput"):b("DOM").find(this.root,"input.photoOffsetXInput");this._timelineDrag?this._timelineDrag.setPicture(a,{offsetInput:d,vertical:c}):this._createDragger(c);this._updateHeader()};j.prototype.saveUpdate=function(){"use strict";var a=b("ge")("fbCoverImageContainer");b("CSS").addClass(a,"opaquedLoading");this._timelineDrag&&(this._timelineDrag.destroy(),this._timelineDrag=null)};j.prototype.cancelUpdate=function(){"use strict";this._reloadAfterNextUpdate=!1,b("DOM").remove(b("DOM").scry(this.root,".coverImage")[0]),b("DOM").prependContent(this.cover,this._coverImage),this._originalOffset!==undefined&&b("Style").set(b("DOM").scry(this._coverImage,".coverPhotoImg")[0],this._originalIsVertical?"top":"left",this._originalOffset),this._exitEditMode(),this._updateHeader()};j.staticSaveComplete=function(){"use strict";var a=j.getInstance();a!==null&&a.saveComplete()};j.prototype.saveComplete=function(){"use strict";this._reloadAfterNextUpdate&&b("ReloadPage").now();this._coverImage=b("DOM").scry(this.root,".coverImage")[0];var a=b("DOM").scry(this.root,"._3x7_")[0];a&&b("CSS").removeClass(a,"_3x7_");this._exitEditMode();this._updateHeader();b("PageTransitions").rewriteCurrentURI(b("PageTransitions").getCurrentURI().getUnqualifiedURI(),b("PageTransitions").getCurrentURI().removeQueryData("preview_cover"))};j.prototype.isInEditMode=function(){"use strict";return this.editing};j.prototype._updateHeader=function(){"use strict";var a=b("DOM").scry(this.root,".coverImage")[0];if(!a)return;a=b("CSS").hasClass(a,"coverNoImage");var c=null;this._parentSection!==null&&(c=b("CSS").hasClass(this._parentSection,"noCoverImage"));a!==c&&(this._parentSection!==null&&b("CSS").conditionClass(this._parentSection,"noCoverImage",a))};j.getInstance=function(){"use strict";return j.instance};j.staticUpdateCoverImage=function(a){"use strict";var b=j.getInstance();b!==null&&b.updateCoverImage(null,a)};j.prototype.setupFileUpload=function(a,c,d){"use strict";__p&&__p();a.subscribe("change",function(){__p&&__p();var e=new(b("FileInputUploader"))(a.getInput()).setURI(c).setAllowCrossOrigin(!0);e.subscribe("failure",function(){j.showErrorDialog(i._("Cover Upload Failed"),i._("Uploading the new cover picture failed. Please try again."))});e.subscribe(["success","failure"],function(){this.hideLoadingIndicator(),a.clear(),b("CSS").removeClass(a.getControl(),d),a.getInput().disabled=!1}.bind(this));this.showLoadingIndicator();this._reloadAfterNextUpdate=!0;e.send();b("CSS").addClass(a.getControl(),d);a.getInput().disabled=!0}.bind(this))};j.setupFileUpload=function(a,b,c){"use strict";var d=j.getInstance();d!==null&&d.setupFileUpload(a,b,c)};j.imageUploadDone=function(a,b){"use strict";var c=j.getInstance();c!==null&&c.updateCoverImage(a,b)};j.showErrorDialog=function(a,c){"use strict";new(b("Dialog"))().setTitle(a).setButtons(b("Dialog").OK).setBody(c).setSemiModal(!0).show();a=j.getInstance();a!==null&&a.hideLoadingIndicator()};j.initFileUploadMenu=function(a){"use strict";j.showLoadingAfterFileUpload(a.getForm())};j.showLoadingAfterFileUpload=function(a){"use strict";b("tidyEvent")(a.subscribe("submit",function(){var a=j.getInstance();a!==null&&a.showLoadingIndicator()}))};j.instance=null;e.exports=j}),null);
__d("TimelineSmartInsert",["Run","UserAgent_DEPRECATED","Vector"],(function(a,b,c,d,e,f){__p&&__p();var g=100;function h(a){return a==="viewport"?b("Vector").getViewportDimensions().y:a}var i=!1,j=!1;function k(){if(j)return;b("Run").onLeave(l);j=!0}function l(){i=!1,j=!1}a={run:function(a,c,d){__p&&__p();k();if(!i||b("UserAgent_DEPRECATED").ie()<=8){c();return}var e=a.offsetHeight;c();c=a.offsetHeight;var f=b("Vector").getScrollPosition().y;a=b("Vector").getElementPosition(a).y;c!==e&&a<f&&a+e<f+h(d||g)&&window.scrollBy(0,c-e)},enable:function(){i=!0}};e.exports=a}),null);
__d("TimelinePlacesSection",["TimelineAppSection","TimelinePlacesCollection"],(function(a,b,c,d,e,f){__p&&__p();var g;c=babelHelpers.inherits(a,b("TimelineAppSection"));g=c&&c.prototype;function a(a,b,c,d){"use strict";g.constructor.call(this,a,b,c,d)}a.prototype.hideCollection=function(a){"use strict";g.hideCollection.call(this,a),a instanceof b("TimelinePlacesCollection")&&a.hide()};a.prototype.showCollection=function(a){"use strict";g.showCollection.call(this,a),a instanceof b("TimelinePlacesCollection")&&a.show()};e.exports=a}),null);
__d("TimelineMedley",["csx","cx","regeneratorRuntime","Arbiter","CSS","DOM","DOMQuery","MedleyPageletRequestData","PageTransitions","ProfileNavigation","ProfileOverviewDOMID","ProfileOverviewSection","ProfileTabUtils","ScriptPath","TimelineAppSection","TimelineController","TimelineMonitor","TimelinePlacesSection","TimelineURI","TriggerablePageletLoader","URI","ViewportBounds","$","ge","getElementPosition","nullthrows","promiseDone"],(function(a,b,c,d,e,f,g,h){__p&&__p();var i,j=6,k=2,l=!1;function m(a){return a.map(function(a){var c=a.controller,d=a.sk,e=a.label;a=a.title;return b("ProfileTabUtils").isMapTab(d)?new(b("TimelinePlacesSection"))(c,d,e,a):new(b("TimelineAppSection"))(c,d,e,a)})}function n(a){b("ScriptPath").set(b("ProfileNavigation").getScriptPath(a),null,{entity_id:b("TimelineController").getProfileID(),profile_session_id:b("TimelineController").getSessionToken()})}c=babelHelpers.inherits(a,b("ProfileOverviewSection"));i=c&&c.prototype;function a(a,c,d){"use strict";__p&&__p();i.constructor.call(this,b("ProfileOverviewDOMID").MEDLEY_ROOT);this._transitionHandler=function(a){var c=a.getQueryData();if(Object.prototype.hasOwnProperty.call(c,"theater")){b("Arbiter").subscribeOnce("PhotoSnowlift.CLOSE",function(){return b("PageTransitions").registerHandler(this._transitionHandler,j)}.bind(this));return!1}c=this._transitionHandlerImpl(a);c||this.reset();return c}.bind(this);this._sectionBreaker=d.breaker;m(a).forEach(this.appendSection,this);b("TimelineMonitor").monitorSection(this);d=b("nullthrows")(this.childSections.get(b("ProfileTabUtils").getIDForSectionKey(c)));this._lastLoadedSection=d.setIsLoaded(!0);b("ProfileOverviewSection").setActiveSectionID(this._lastLoadedSection.id);l&&this.isOverviewProfileTab()&&this.addSectionPlaceholders();a=b("URI").getNextURI();this._vanity=b("TimelineURI").getVanityFromURI(a);this._sk=b("TimelineURI").getTabKeyFromURI(a);b("PageTransitions").registerHandler(this._transitionHandler,j);this._monitorListener=b("Arbiter").subscribe(b("TimelineMonitor").SECTION_CHANGE,function(a,c){c.section instanceof b("TimelineAppSection")&&n(c.section._sk)})}a.prototype.reset=function(){"use strict";i.reset.call(this),b("MedleyPageletRequestData").reset(),b("PageTransitions").removeHandler(this._transitionHandler,j),b("ProfileOverviewSection").resetGlobalState(),this._monitorListener&&this._monitorListener.unsubscribe(),l=!1};a.prototype.addSectionTeasers=function(){"use strict";this.isOverviewProfileTab()||(b("CSS").removeClass(this.getNode(),"_c4f"),this.thawChildren(),this.addSectionPlaceholders(),this.addSectionBreak())};a.prototype.addUpcomingSectionPlaceholders=function(a,b){"use strict";b=b||k;while(a=a.getNext())if(!this.addSectionPlaceholder(a,a.getPrev())&&--b<=0)break};a.prototype.addSectionPlaceholder=function(a,c,d){"use strict";if(!a.isLoaded()&&b("ge")(a.nodeID))return!1;if(!b("ge")(a.nodeID)){b("DOM").insertAfter(c.getNode(),a.getNode());a.createTriggerLoader(d);return!1}return!0};a.prototype.addSectionBreak=function(){"use strict";var a=this.childSections.getHead();this._lastLoadedSection.getNext()&&a?b("DOM").insertAfter(a.getNode(),this._sectionBreaker):b("DOM").remove(this._sectionBreaker)};a.prototype.removeChildSection=function(a){"use strict";this.childSections.remove(a),this.childSections.getCount()==1&&b("DOM").remove(this._sectionBreaker)};a.prototype.addSectionPlaceholders=function(){"use strict";this.addUpcomingSectionPlaceholders(this._lastLoadedSection)};a.prototype.getNode=function(){"use strict";return b("$")(this.id)};a.prototype.isOverviewProfileTab=function(){"use strict";return b("ProfileTabUtils").isOverviewTab(this._sk)};a.prototype.toggleScrollLoad=function(a){"use strict";l=a,a?(this.thawChildren(),this.addSectionPlaceholders()):this.freezeChildren()};a.prototype._transitionHandlerImpl=function(a){__p&&__p();var c=this;if(b("TimelineURI").getVanityFromURI(a)!==this._vanity)return!1;var d=b("TimelineURI").getTabKeyFromURI(a);if(b("ProfileTabUtils").isTimelineTab(d)||b("ProfileTabUtils").isTimelineOverviewTab(d))return!1;if(b("ProfileTabUtils").isOverviewTab(d))return!1;else{var e=function(){__p&&__p();var e=a.getQueryData();if(!e.next_cursor)return{v:!1};var f=c.childSections.getHead();while(f){if(f._sk===d){if(!f._activeCollection||!b("DOMQuery").scry(f._activeCollection.getNode(),"._3t3")[0])return{v:!1};b("Arbiter").inform("save_facebar_query",!0);setTimeout(function(){__p&&__p();b("promiseDone")(function(){__p&&__p();return b("regeneratorRuntime").async(function(a){while(1)switch(a.prev=a.next){case 0:if(!f){a.next=3;break}a.next=3;return b("regeneratorRuntime").awrap(this._transitionToSection(f,e));case 3:case"end":return a.stop()}},null,this)}.bind(this)())}.bind(c),0);return{v:!0}}f=f.getNext()}}();if(typeof e==="object")return e.v}return!1};a.prototype._transitionToSection=function(a,c){"use strict";__p&&__p();var d,e,f,g;return b("regeneratorRuntime").async(function(h){__p&&__p();while(1)switch(h.prev=h.next){case 0:d=b("getElementPosition")(a.getNode()).y-b("ViewportBounds").getTop();b("DOM").scry(a.getNode(),"._51k9").forEach(function(a){b("CSS").removeClass(a,"_51k9")});this._sk=a._sk;e=b("nullthrows")(a._activeCollection);b("ProfileOverviewSection").setActiveSectionID(a.id);a.thaw();b("CSS").addClass(this.getNode(),"_c4f");this.freezeChildren();f=b("DOMQuery").find(e.getNode(),"._3t3");h.next=11;return b("regeneratorRuntime").awrap(e.addContentLoader(f,c.next_cursor));case 11:e._contentLoader&&e._contentLoader.load({node:f,type:b("TriggerablePageletLoader").TRIGGER_NOW});g=this.childSections.getHead();while(g&&g.id!==a.id)g.remove(),g=this.childSections.getHead();b("ProfileOverviewSection").inform("Medley/transitionToSection",a.id);a.scrollTo(d<0?d:0);this._sk&&n(this._sk);b("PageTransitions").transitionComplete();case 18:case"end":return h.stop()}},null,this)};a.scrollToSection=function(a,c,d){"use strict";b("ProfileOverviewSection").callWithSection(a,function(a){a.scrollTo(c,d)})};a.toggleScrollLoad=function(a){"use strict";l=a,b("ProfileOverviewSection").callWithSection(b("ProfileOverviewDOMID").MEDLEY_ROOT,function(b){b.toggleScrollLoad(a)})};e.exports=a}),null);